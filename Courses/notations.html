<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="fr" xml:lang="fr"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.429">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>HAX603X: Mod√©lisation stochastique - Notations et rappels</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../Courses/th_asymptotique.html" rel="next">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<meta name="shinylive:serviceworker_dir" content="..">
<script src="../site_libs/quarto-contrib/shinylive-0.2.1/shinylive/load-shinylive-sw.js" type="module"></script>
<script src="../site_libs/quarto-contrib/shinylive-0.2.1/shinylive/run-python-blocks.js" type="module"></script>
<link href="../site_libs/quarto-contrib/shinylive-0.2.1/shinylive/shinylive.css" rel="stylesheet">
<link href="../site_libs/quarto-contrib/shinylive-quarto-css/shinylive-quarto.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Pas de r√©sultats",
    "search-matching-documents-text": "documents trouv√©s",
    "search-copy-link-title": "Copier le lien vers la recherche",
    "search-hide-matches-text": "Cacher les correspondances additionnelles",
    "search-more-match-text": "correspondance de plus dans ce document",
    "search-more-matches-text": "correspondances de plus dans ce document",
    "search-clear-button-title": "Effacer",
    "search-detached-cancel-button-title": "Annuler",
    "search-submit-button-title": "Envoyer",
    "search-label": "Recherche"
  }
}</script>
<script type="module" src="../site_libs/quarto-ojs/quarto-ojs-runtime.js"></script>
<link href="../site_libs/quarto-ojs/quarto-ojs.css" rel="stylesheet">

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css">

<link rel="stylesheet" href="../custom.css">
<link rel="stylesheet" href="../custom.scss">
</head>

<body class="nav-sidebar floating nav-fixed slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">HAX603X</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Recherche"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Basculer la navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Pr√©sentation</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="../Courses/notations.html" aria-current="page"> 
<span class="menu-text">Cours</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../TD/TD1.html"> 
<span class="menu-text">TD</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../TP/TP1.html"> 
<span class="menu-text">TP</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
    <a href="https://github.com/josephsalmon/HAX603X" title="GitHub" class="quarto-navigation-tool px-1" aria-label="GitHub"><i class="bi bi-github"></i></a>
    <a href="https://moodle.umontpellier.fr/course/view.php?id=25763" title="Moodle" class="quarto-navigation-tool px-1" aria-label="Moodle"><i class="bi bi-bicycle"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Basculer la barre lat√©rale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../Courses/notations.html">Cours</a></li><li class="breadcrumb-item"><a href="../Courses/notations.html">Notations et rappels</a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Basculer la barre lat√©rale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Cours</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Basculer la section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Courses/notations.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Notations et rappels</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Courses/th_asymptotique.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Th√©or√®mes asymptotiques</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Courses/simulation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Simulation</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Sur cette page</h2>
   
  <ul>
  <li><a href="#loi-discr√®tes" id="toc-loi-discr√®tes" class="nav-link active" data-scroll-target="#loi-discr√®tes">Loi discr√®tes</a></li>
  <li><a href="#lois-continues" id="toc-lois-continues" class="nav-link" data-scroll-target="#lois-continues">Lois continues</a></li>
  <li><a href="#fonction-de-r√©partition" id="toc-fonction-de-r√©partition" class="nav-link" data-scroll-target="#fonction-de-r√©partition">Fonction de r√©partition</a></li>
  <li><a href="#fonction-quantile-inverse-g√©n√©ralis√©e-√†-gauche" id="toc-fonction-quantile-inverse-g√©n√©ralis√©e-√†-gauche" class="nav-link" data-scroll-target="#fonction-quantile-inverse-g√©n√©ralis√©e-√†-gauche">Fonction quantile, inverse g√©n√©ralis√©e √† gauche</a></li>
  <li><a href="#visualisation-densit√©-fonction-de-r√©partition-quantiles-etc." id="toc-visualisation-densit√©-fonction-de-r√©partition-quantiles-etc." class="nav-link" data-scroll-target="#visualisation-densit√©-fonction-de-r√©partition-quantiles-etc.">Visualisation: densit√©, fonction de r√©partition, quantiles, etc.</a>
  <ul class="collapse">
  <li><a href="#cas-des-variables-continues" id="toc-cas-des-variables-continues" class="nav-link" data-scroll-target="#cas-des-variables-continues">Cas des variables continues</a></li>
  <li><a href="#cas-des-variables-discr√®tes" id="toc-cas-des-variables-discr√®tes" class="nav-link" data-scroll-target="#cas-des-variables-discr√®tes">Cas des variables discr√®tes</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/josephsalmon/HAX603X/blob/main/Courses/notations.qmd" class="toc-action"><i class="bi bi-github"></i>Voir la source</a></li><li><a href="https://github.com/josephsalmon/HAX603X/issues/new" class="toc-action"><i class="bi empty"></i>Faire part d'un probl√®me</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../Courses/notations.html">Cours</a></li><li class="breadcrumb-item"><a href="../Courses/notations.html">Notations et rappels</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Notations et rappels</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>On consid√®re un espace probabilis√© <span class="math inline">(\Omega, {\mathcal{F}}, \mathbb{P})</span>, compos√© d‚Äôun ensemble <span class="math inline">\Omega</span>, d‚Äôune tribu <span class="math inline">\mathcal{F}</span>, et d‚Äôune mesure de probabilit√© <span class="math inline">\mathbb{P}</span>.</p>
<div id="def-va" class="theorem definition">
<p><span class="theorem-title"><strong>D√©finition 1 (Variable al√©atoire) </strong></span><br></p>
<p>Soit <span class="math inline">(E, \mathcal{E})</span> un espace mesurable. Une <em>variable al√©atoire</em> (ou v.a.) est une application mesurable <span class="math display">
    \begin{array}{ccccc}
        X &amp; : &amp; \Omega &amp; \to     &amp; E            \\
            &amp;   &amp; \omega &amp; \mapsto &amp; X(\omega)\,.
    \end{array}
</span> C‚Äôest-√†-dire que pour tout <span class="math inline">B \in \mathcal{E}, \{\omega \in \Omega : X(\omega) \in B\} \in \mathcal{F}.</span> Cet ensemble se r√©√©crit souvent sous la forme <span class="math display">
\begin{align*}
    \{\omega \in \Omega : X(\omega) \in B\}
    &amp; =  X^{-1}(B) \\
    &amp; = \{X \in B\} \, .
\end{align*}
</span></p>
</div>
<p>Cette d√©finition permet de transposer l‚Äôal√©a qui provient de <span class="math inline">\Omega</span> dans l‚Äôespace <span class="math inline">E</span>. L‚Äôhypoth√®se <span class="math inline">\{X \in B\} \in \mathcal{F}</span> assure que cet ensemble est bien un √©v√®nement et donc que l‚Äôon peut calculer sa probabilit√©.</p>
<ul>
<li>Si <span class="math inline">E = \mathbb{R}</span>, on prendra alors la tribu bor√©lienne <span class="math inline">\mathcal{F} = \mathcal{B}(\mathbb{R})</span> et on parlera alors de v.a. r√©elle.</li>
<li>Si <span class="math inline">E = \mathbb{R}^d</span>, on parlera de <em>vecteurs al√©atoires</em>.</li>
</ul>
<p>Une fois que l‚Äôal√©a a √©t√© transpos√© de <span class="math inline">\Omega</span> vers <span class="math inline">E</span>, on souhaite √©galement transposer la probabilit√© <span class="math inline">\mathbb{P}</span> sur <span class="math inline">E</span>. Ceci motive l‚Äôintroduction de la notion de loi.</p>
<div id="def-loi" class="theorem definition">
<p><span class="theorem-title"><strong>D√©finition 2 (Loi d‚Äôune variable al√©atoire) </strong></span><br></p>
<p>Soit <span class="math inline">X : (\Omega, \mathcal{F}, \mathbb{P}) \to (E, \mathcal{E})</span> une variable al√©atoire. On appelle <em>loi de <span class="math inline">X</span></em> la mesure de probabilit√© <span class="math display">
        \begin{array}{ccccc}
            \mathbb{P}_X &amp; : &amp; \mathcal{E} &amp; \to     &amp; [0,1]          \\
                 &amp;   &amp; B           &amp; \mapsto &amp; \mathbb{P}(X \in B) \enspace.
        \end{array}
</span></p>
</div>
<p>Les propri√©t√©s de <span class="math inline">\mathbb{P}</span> assurent que <span class="math inline">\mathbb{P}_X</span> est bien une loi de probabilit√© sur l‚Äôespace mesurable <span class="math inline">(E, \mathcal{E})</span>.</p>
<section id="loi-discr√®tes" class="level2">
<h2 class="anchored" data-anchor-id="loi-discr√®tes">Loi discr√®tes</h2>
<p>Les variables al√©atoires discr√®tes sont celles √† valeurs dans un ensemble <span class="math inline">E</span> discret, le plus souvent <span class="math inline">\mathbb{N}</span>, muni de la tribu pleine <span class="math inline">\mathcal{F} = \mathcal{P}(E)</span>.</p>
<div id="exm-bernoulli" class="theorem example">
<p><span class="theorem-title"><strong>Exemple 1 (Loi de Bernoulli) </strong></span>La loi la plus simple est la <em>loi de Bernoulli</em> de param√®tre <span class="math inline">p \in [0,1]</span>, d√©finie sur <span class="math inline">\{0,1\}</span> par <span class="math inline">\mathbb{P}(X=1) = 1-\mathbb{P}(X=0) = p</span> qui mod√©lise une exp√©rience al√©atoire √† deux issues (succ√®s = <span class="math inline">1</span> et √©chec = <span class="math inline">0</span>).</p>
</div>
<div id="exm-binomiale" class="theorem example">
<p><span class="theorem-title"><strong>Exemple 2 (Loi binomiale) </strong></span>En sommant des variables al√©atoires ind√©pendantes de <em>loi de Bernoulli</em> on obtient une loi binomiale : <span class="math inline">\mathbb{P}(X=k) = \binom{n}{k} p^k (1-p)^{n-k}</span>, pour <span class="math inline">k \in \{0,\ldots,n\}</span>, qui mod√©lise le nombre de succ√®s parmi <span class="math inline">n</span> lancers.</p>
</div>
<div id="exm-g√©om√©trique" class="theorem example">
<p><span class="theorem-title"><strong>Exemple 3 (Loi g√©om√©trique) </strong></span>En observant le nombre d‚Äôexp√©riences n√©cessaires avant d‚Äôobtenir un succ√®s, on obtient une <em>loi g√©om√©trique</em> : <span class="math inline">\mathbb{P}(X=k) = p (1-p)^{k-1}</span>, pour <span class="math inline">k \geq 1</span>.</p>
</div>
<div id="exm-Poisson" class="theorem example">
<p><span class="theorem-title"><strong>Exemple 4 (Loi de Poisson) </strong></span>La loi de Poisson de param√®tre <span class="math inline">\lambda &gt; 0</span> est d√©finie par <span class="math inline">\mathbb{P}(X=k) = e^{-\lambda} \lambda^k / k!</span>, pour <span class="math inline">k \in \mathbb{N}</span>, et mod√©lise les √©v√©nements rares.</p>
</div>
</section>
<section id="lois-continues" class="level2">
<h2 class="anchored" data-anchor-id="lois-continues">Lois continues</h2>
<p>Parmi les variables al√©atoires r√©elles non discr√®tes, beaucoup peuvent se repr√©senter avec une densit√©, c‚Äôest-√†-dire qu‚Äôil existe une fonction mesurable <span class="math inline">f : \mathbb{R} \to [0, \infty[</span> d‚Äôint√©grale <span class="math inline">1</span>. La loi d‚Äôune telle variable al√©atoire <span class="math inline">X</span> est alors donn√©e pour tout <span class="math inline">A \in \mathcal{B}(\mathbb{R})</span> par <span class="math display">
    \mathbb{P}(X \in A) = \int_A f(x) \, \mathrm d x \enspace.
</span> Les propri√©t√©s de l‚Äôint√©grale de Lebesgue assure que cette formule d√©finit bien une loi de probabilit√©.</p>
<div id="exm-uniforme" class="theorem example">
<p><span class="theorem-title"><strong>Exemple 5 (Loi uniforme) </strong></span>La loi uniforme sur un ensemble <span class="math inline">B \in \mathcal{B}(\mathbb{R})</span>, s‚Äôobtient avec la densit√© d√©finie par <span class="math display">
f(x) = {1\hspace{-3.8pt} 1}_B(x) / \lambda (B) \enspace,
</span> o√π <span class="math inline">\lambda (B)</span> repr√©sente la mesure de Lebesgue de l‚Äôensemble <span class="math inline">B</span>. En particulier pour la loi uniforme sur le segment <span class="math inline">[0,1]</span> on obtient la fonction suivante: <span class="math display">
f(x) = {1\hspace{-3.8pt} 1}_{[0,1]}(x)\enspace.
</span> Si une variable al√©atoire <span class="math inline">U</span> suit une telle loi on note <span class="math inline">U \sim \mathcal{U}([0,1])</span>.</p>
</div>
<div id="exm-exponentielle" class="theorem example">
<p><span class="theorem-title"><strong>Exemple 6 (Loi exponentielle) </strong></span>La loi exponentielle de param√®tre <span class="math inline">\gamma &gt; 0</span> est obtenue avec la densit√© donn√©e par <span class="math display">
f(x) = \gamma e^{-\gamma x} {1\hspace{-3.8pt} 1}_{\mathbb{R}_+}(x)\enspace.
</span> Si une variable al√©atoire <span class="math inline">X</span> suit cette loi on note <span class="math inline">X \sim \mathcal{Exp}(\gamma)</span>.</p>
</div>
<div id="exm-gaussienne" class="theorem example">
<p><span class="theorem-title"><strong>Exemple 7 (Loi normale/gaussienne univari√©e) </strong></span>On obtient la loi normale de param√®tre <span class="math inline">\mu \in \mathbb{R}</span> et <span class="math inline">\sigma^2 &gt; 0</span> correspond √† loi dont la densit√© est donn√©e par la fonction r√©elle: <span class="math display">
f(x) = \frac{1}{\sqrt{2 \pi} \sigma}e^{-\frac{1}{2 \sigma^2}(x-\mu)^2} \enspace.
</span> Si une variable al√©atoire <span class="math inline">X</span> suit une telle loi on note <span class="math inline">X \sim \mathcal{N}(\mu,\sigma^2)</span>, <span class="math inline">\mu</span> correspondant √† l‚Äôesp√©rance de la loi, et <span class="math inline">\sigma^2</span> √† sa variance. On nomme loi <em>normale centr√©e r√©duite</em> le cas correspondant √† <span class="math inline">\mu = 0</span> et <span class="math inline">\sigma^2 = 1</span>.</p>
</div>
<div id="exm-gaussienne-multi" class="theorem example">
<p><span class="theorem-title"><strong>Exemple 8 (Loi normale multivari√©e) </strong></span>On peut √©tendre les lois normales au cas multi-dimensionnel. Fixons <span class="math inline">d\in\mathbb{N}^*</span> un entier non nul. Pour un vecteur <span class="math inline">\mu \in \mathbb{R}^d</span> et une matrice sym√©trique-d√©finie positive <span class="math inline">\Sigma\in \mathbb{R^{d\times d}}</span>, la densit√© normale mutlivari√©e associ√©e est donn√©e par la fonction: <span class="math display">
f(x) = \frac{1}{{(2 \pi)}^{\frac{d}{2}} {\rm det}(\Sigma)} e^{-\frac{1}{2}(x-\mu)^\top \Sigma ^{-1}(x-\mu)}
</span> Notons que <span class="math inline">\mu</span> est l‚Äôesp√©rance de la loi et <span class="math inline">\Sigma</span> la matrice de variance-covariance.</p>
</div>
</section>
<section id="fonction-de-r√©partition" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="fonction-de-r√©partition">Fonction de r√©partition</h2>
<p>La notion de variable al√©atoire n‚Äôest pas facile √† manipuler puisqu‚Äôelle part d‚Äôun espace <span class="math inline">\Omega</span> dont on ne sait rien. On souhaite donc caract√©riser la loi d‚Äôune variable al√©atoire en ne consid√©rant que l‚Äôespace d‚Äôarriv√©e <span class="math inline">(E, \mathcal{E})</span> .</p>
<p>Plusieurs outils existent : la fonction de r√©partition (pour des variables al√©atoires r√©elles), la fonction caract√©ristique (pour des variables al√©atoires dans <span class="math inline">\mathbb{R}^d</span>), la fonction g√©n√©ratrice des moments (pour des variables al√©atoires discr√®tes), etc. On se contente ici de la fonction de r√©partition qui nous sera utile pour simuler des variables al√©atoires, ainsi que son inverse au sens de Levy.</p>
<div id="def-cdf" class="theorem definition">
<p><span class="theorem-title"><strong>D√©finition 3 (Fonction de r√©partition üá¨üáß: <em>cumulative distribution function</em>) </strong></span><br></p>
<p>Soit <span class="math inline">X</span> une variable al√©atoire sur <span class="math inline">(\mathbb{R}, \mathcal{B}(\mathbb{R}))</span>. La fonction de r√©partition de <span class="math inline">X</span> est la fonction <span class="math inline">F_X</span> d√©finie sur <span class="math inline">\mathbb{R}</span> par <span class="math display">
    F_X(x) = \mathbb{P}(X \leq x) = \mathbb{P}(X \in ]-\infty, x]) \enspace.
</span></p>
</div>
<p>On appelle quantile d‚Äôordre <span class="math inline">p\in (0,1)</span>, la quantit√© <span class="math inline">F_X^\leftarrow(p).</span> La <strong>m√©diane</strong> est √©gale √† <span class="math inline">F_X^\leftarrow(1/2)</span>, les premiers et troisi√®mes <strong>quartiles</strong> sont √©gaux √† <span class="math inline">F_X^\leftarrow(1/4)</span> et <span class="math inline">F_X^\leftarrow(3/4)</span>. Enfin, les d√©ciles sont les quantiles <span class="math inline">F_X^\leftarrow(k/10)</span> pour <span class="math inline">k=1,\dots, 9</span>.</p>
<div id="exm-cdf-discret" class="theorem example">
<p><span class="theorem-title"><strong>Exemple 9 (Cas discret) </strong></span>Soit <span class="math inline">(x_i)_{i \in I}</span> une suite ordonn√©e de r√©els, avec <span class="math inline">I \subset \mathbb{N}</span>. Si <span class="math inline">X</span> est une variable al√©atoire discr√®te prenant les valeurs <span class="math inline">(x_i)_{i \in I}</span> et de loi <span class="math inline">(p_i = \mathbb{P}(X=x_i))_{i \in I}</span>, alors <span class="math display">
F_X(x) = \sum_{i \in I} p_i {1\hspace{-3.8pt} 1}_{[x_i, \infty[}(x) \enspace.
</span></p>
</div>
<div id="exm-cdf-discret" class="theorem example">
<p><span class="theorem-title"><strong>Exemple 10 (Cas continu) </strong></span>Si <span class="math inline">X</span> est une variable al√©atoire de densit√© <span class="math inline">f</span>, alors <span class="math display">
    F_X(x) = \int_{-\infty}^x f(t) \, \mathrm dt \enspace.
</span></p>
</div>
<p>Le graphe des fonctions de r√©partition des loi de Bernoulli, uniforme et normale sont repr√©sent√©es en Figure XXX. Notons que la fonction de r√©partition de la loi normale <span class="math inline">\mathcal{N}(0,1)</span>, souvent not√©e <span class="math inline">\Phi</span>, n‚Äôadmet pas d‚Äôexpression explicite autre que <span class="math display">
\Phi(x) = \dfrac{1}{\sqrt{2\pi}} \int_{-\infty}^x e^{-\frac{x^2}{2}}\, \mathrm d x\enspace,
</span> Les valeurs num√©riques de <span class="math inline">\Phi(x)</span> √©taient autrefois report√©es dans des tables<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>. Par transformation affine, si <span class="math inline">X \sim \mathcal{N}(\mu, \sigma^2)</span> ‚Äî ce que l‚Äôon peut aussi √©crire : <span class="math inline">X=\mu + \sigma Y</span>, avec <span class="math inline">Y\sim \mathcal{N}(0,1)</span> ‚Äî alors sa fonction de r√©partition est donn√©e par <span class="math inline">F_X(x)=\Phi((x-\mu)/\sigma)</span>.</p>
<div class="no-row-height column-margin column-container"><li id="fn1"><p><sup>1</sup>&nbsp;<a href="https://fr.wikipedia.org/wiki/Loi_normale#Tables_num%C3%A9riques_et_calculs">Wikipedia: loi normale</a></p></li></div><div id="prp-toto" class="theorem proposition">
<p><span class="theorem-title"><strong>Proposition 1 (Propri√©t√©s de la fonction de r√©partition) </strong></span>Soit <span class="math inline">X</span> une variable al√©atoire de fonction de r√©partition <span class="math inline">F_X</span>.</p>
<ol type="1">
<li><span class="math inline">F_X</span> est une fonction croissante, de limite <span class="math inline">0</span> en <span class="math inline">-\infty</span> et de limite <span class="math inline">1</span> en <span class="math inline">+\infty</span>.</li>
<li><span class="math inline">F_X</span> est continue √† droite en tout point.</li>
<li>Pour tout <span class="math inline">x \in \mathbb{R}</span>, on a <span class="math inline">\mathbb{P}(X=x) = F_X(x) - F_X(x-)</span>, o√π <span class="math inline">F_X(x-) = \lim_{\epsilon \to 0+} F_X(x- \epsilon)</span>.</li>
<li>Si <span class="math inline">X</span> a pour densit√© <span class="math inline">f</span>, alors <span class="math inline">F_X</span> est d√©rivable <span class="math inline">\lambda</span>-presque partout de d√©riv√©e <span class="math inline">f</span>.</li>
</ol>
</div>
<p>La propri√©t√© 3. est utile dans le cas discret : les valeurs prises par <span class="math inline">X</span> correspondent aux points de discontinuit√© de <span class="math inline">F_X</span> et les probabilit√©s associ√©es correspondent √† la hauteur du saut.</p>
<p>La propri√©t√© 4. donne le lien entre la fonction de r√©partition d‚Äôune variable al√©atoire √† densit√© et sa densit√©. On peut donc retrouver la loi de <span class="math inline">X</span> √† partir de sa fonction de r√©partition. Le th√©or√®me suivant g√©n√©ralise ce r√©sultat √† toute variable al√©atoire r√©elle (pas n√©cessairement discr√®te ou √† densit√©).</p>
<div id="thm-fdr_carac" class="theorem">
<p><span class="theorem-title"><strong>Th√©or√®me 1 (Caract√©risation de la loi d‚Äôune variable al√©atoire r√©elle) </strong></span>La fonction de r√©partition d‚Äôune variable al√©atoire caract√©rise sa loi : deux variables al√©atoires ont m√™me loi si et seulement si elles ont m√™me fonction de r√©partition.</p>
</div>
<p>XXX source + proof???</p>
<p>On rappelle que la tribu des bor√©liens est engendr√©e par la famille d‚Äôensembles <span class="math inline">\{]-\infty,x], x \in \mathbb{R}\}</span>. Le th√©or√®me pr√©c√©dent assure que si on conna√Æt la mesure <span class="math inline">\mathbb{P}_X</span> sur cette famille d‚Äôensemble alors on la conna√Æt partout.</p>
<p>XXX TODO: move this in correct part.</p>
<div id="exm-genereexponentielle" class="theorem example">
<p><span class="theorem-title"><strong>Exemple 11 (Loi exponentielle depuis une loi uniforme) </strong></span>On consid√®re une variable al√©atoire <span class="math inline">U</span> de loi uniforme sur <span class="math inline">[0,1]</span> et on pose <span class="math inline">X = -\ln(1-U)</span>. D√©terminons la loi de <span class="math inline">X</span> en calculant sa fonction de r√©partition. Pour tout <span class="math inline">x \in \mathbb{R}</span>, <span class="math display">
\begin{align*}
F_X(x) = &amp; \mathbb{P}(X \leq x) \\
       = &amp; \mathbb{P}(-\ln(1-U) \leq x) \\
       = &amp; \mathbb{P}(U \leq 1-e^{-x}) \\
       = &amp;
    \begin{cases}
        0           &amp; \text{ si }x &lt; 0\,,    \\
        1 - e^{-x} &amp; \text{ si }x \geq 0\,,
    \end{cases}
\end{align*}
</span></p>
<p>o√π on a utilis√© l‚Äô√©galit√© <span class="math inline">\mathbb{P}(U \leq t) = t</span> pour tout <span class="math inline">t \in [0,1]</span>. Ainsi la variable al√©atoire <span class="math inline">X</span> a la m√™me fonction de r√©partition qu‚Äôune loi exponentielle de param√®tre <span class="math inline">1</span>. On en conclut que <span class="math inline">X \sim \mathcal{Exp}(1)</span>. Notons que l‚Äôon peut aussi montrer que <span class="math inline">-\ln(X)\sim\mathcal{E}(1)</span>, sachant que <span class="math inline">U</span> et <span class="math inline">1-U</span> ont la m√™me loi.</p>
</div>
</section>
<section id="fonction-quantile-inverse-g√©n√©ralis√©e-√†-gauche" class="level2">
<h2 class="anchored" data-anchor-id="fonction-quantile-inverse-g√©n√©ralis√©e-√†-gauche">Fonction quantile, inverse g√©n√©ralis√©e √† gauche</h2>
<p>La fonction de r√©partition √©tant une fonction croissante on peut donner un sens √† son inverse g√©n√©ralis√©e de la mani√®re suivante.</p>
<div id="def-quantile" class="theorem definition">
<p><span class="theorem-title"><strong>D√©finition 4 (Fonction quantile/ inverse g√©n√©ralis√©e üá¨üáß: <em>quantile distribution function</em>) </strong></span><br></p>
<p>Soit <span class="math inline">X</span> une variable al√©atoire sur <span class="math inline">(\mathbb{R}, \mathcal{B}(\mathbb{R}))</span> et <span class="math inline">F_X</span> sa fonction de r√©partion. La fonction quantile associ√©e <span class="math inline">F_X^\leftarrow: ]0,1[\rightarrow \mathbb{R}</span> est d√©finie par <span class="math display">
  F_X^\leftarrow(p)=  \inf\{ x \in \mathbb{R} \colon F_X(x)\geq p\} \enspace.
</span></p>
</div>
<p>On parle parfois aussi d‚Äôinverse au sens de Levy pour cette inverse g√©n√©ralis√©e.</p>
<p>Dans le cas o√π la fonction de r√©partition <span class="math inline">F</span> est bijective, alors l‚Äôinverse de la fonction de r√©partition coincide avec la fonction quantile.</p>
</section>
<section id="visualisation-densit√©-fonction-de-r√©partition-quantiles-etc." class="level2">
<h2 class="anchored" data-anchor-id="visualisation-densit√©-fonction-de-r√©partition-quantiles-etc.">Visualisation: densit√©, fonction de r√©partition, quantiles, etc.</h2>
<section id="cas-des-variables-continues" class="level3">
<h3 class="anchored" data-anchor-id="cas-des-variables-continues">Cas des variables continues</h3>
<pre class="shinylive-python" data-engine="python"><code>#| standalone: true
#| viewerHeight: 830
import numpy as np
from scipy import stats
import plotly.graph_objects as go
from plotly.subplots import make_subplots
from shiny import ui, render, App
from shinywidgets import output_widget, render_widget


def keep_no_param_distribution():
    distributions = stats._continuous_distns._distn_names
    distributions_0 = []
    for _, name in enumerate(distributions):
        dist = getattr(stats, name)
        if not dist.shapes or len(dist.shapes) == 0:
            distributions_0.append(name)
    distributions_0_val = [
        getattr(stats.distributions, string) for string in distributions_0
    ]
    distributions_0_dict = dict(zip(distributions_0, distributions_0_val))
    return distributions_0_dict


distributions_0_dict = keep_no_param_distribution()

mu = 0
sigma = 1

app_ui = ui.page_fluid(
    ui.div(
        ui.input_slider("alpha", "Quantile", 0.01, 0.99, value=0.5, step=0.01),
        ui.input_slider("xrange", "x-range", -10, 10, value=(-5, 5), step=0.2),
        ui.input_select(
            "distrib",
            "Distribution",
            list(distributions_0_dict.keys()),
            selected='norm'
        ),
        class_="d-flex gap-3",
    ),
    output_widget("my_widget"),
)


def server(input, output, session):
    @output
    @render_widget
    def my_widget():
        fig = make_subplots(
            rows=3,
            cols=2,
            vertical_spacing=0.1,
            horizontal_spacing=0.15,
            subplot_titles=(
                "Fonction quantile",
                "",
                "",
                "Fonction de r√©partition",
                "",
                "Densit√© et quantile",
            ),
            column_widths=[0.2, 0.5],
            row_heights=[0.35, 0.17, 0.17],
        )

        alpha = input.alpha()
        distribution = distributions_0_dict[input.distrib()]
        x = np.linspace(input.xrange()[0], input.xrange()[1], num=400)
        cdf_data = distribution.cdf(x, loc=mu, scale=sigma)
        pdf_data = distribution.pdf(x, loc=mu, scale=sigma)
        q_alpha = distribution.ppf(alpha, loc=mu, scale=sigma)

        fig.update_layout(autosize=True, height=700)

        # Quantile plot
        fig.add_trace(
            go.Scatter(
                x=cdf_data, y=x, mode="lines", marker={"color": "black"}
            ),
            row=1,
            col=1,
        )
        # Diagonal
        fig.add_trace(
            go.Scatter(
                x=cdf_data, y=cdf_data, mode="lines", marker={"color": "black"}
            ),
            row=2,
            col=1,
        )
        # Cdf part
        fig.add_trace(
            go.Scatter(
                x=x, y=cdf_data, mode="lines", marker={"color": "black"}
            ),
            row=2,
            col=2,
        )
        # pdf part
        fig.add_scatter(
            x=x[x &lt; q_alpha],
            y=pdf_data[x &lt; q_alpha],
            fill="tozeroy",
            mode="none",
            fillcolor="rgb(66, 139, 202)",
            row=3,
            col=2,
        )

        fig.add_trace(
            go.Scatter(
                x=x, y=pdf_data, mode="lines", marker={"color": "black"}
            ),
            row=3,
            col=2,
        )

        # Dots
        fig.add_trace(
            go.Scatter(
                x=[alpha],
                y=[q_alpha],
                mode="markers",
                marker={"color": "rgb(66, 139, 202)"},
                marker_symbol="x",
                marker_size=8,
            ),
            row=1,
            col=1,
        )

        fig.add_trace(
            go.Scatter(
                x=[alpha],
                y=[alpha],
                mode="markers",
                marker={"color": "rgb(66, 139, 202)"},
                marker_symbol="x",
                marker_size=8,
            ),
            row=2,
            col=1,
        )

        fig.add_trace(
            go.Scatter(
                x=[q_alpha],
                y=[alpha],
                mode="markers",
                marker={"color": "rgb(66, 139, 202)"},
                marker_symbol="x",
                marker_size=8,
            ),
            row=2,
            col=2,
        )

        # Lines
        fig.add_trace(
            go.Scatter(
                x=[alpha, alpha],
                y=[x[0], q_alpha],
                mode="lines",
                line=dict(dash="dash", color="rgb(66, 139, 202)")
            ),
            row=1,
            col=1
        )

        fig.add_trace(
            go.Scatter(
                x=[alpha, alpha],
                y=[alpha, 1.],
                mode="lines",
                line=dict(dash="dash", color="rgb(66, 139, 202)")
            ),
            row=2,
            col=1
        )
        fig.add_trace(
            go.Scatter(
                x=[alpha, 1],
                y=[alpha, alpha],
                mode="lines",
                line=dict(dash="dash", color="rgb(66, 139, 202)")
            ),
            row=2,
            col=1
        )
        fig.add_trace(
            go.Scatter(
                x=[x[0], q_alpha],
                y=[alpha, alpha],
                mode="lines",
                line=dict(dash="dash", color="rgb(66, 139, 202)")
            ),
            row=2,
            col=2
        )
        fig.add_trace(
            go.Scatter(
                x=[x[0], q_alpha],
                y=[x[0], 0],
                mode="lines",
                line=dict(dash="dash", color="rgb(66, 139, 202)")
            ),
            row=2,
            col=2
        )
        # Axes ranges
        fig.update_xaxes(range=[0, 1.], row=1, col=1)
        fig.update_yaxes(matches="x6", row=1, col=1)

        fig.update_yaxes(range=[0, 1.], row=2, col=1)
        fig.update_xaxes(matches="x1", row=2, col=1)

        fig.update_yaxes(rangemode="tozero", row=3, col=2)
        fig.update_xaxes(range=[x[0], x[-1]], row=3, col=2)

        fig.update_xaxes(matches="x6", row=2, col=2)
        fig.update_yaxes(matches="y3", row=2, col=2)

        # Add dropdown
        fig.update_layout(
            showlegend=False,
            template="simple_white",
        )
        return fig


app = App(app_ui, server)
</code></pre>
</section>
<section id="cas-des-variables-discr√®tes" class="level3">
<h3 class="anchored" data-anchor-id="cas-des-variables-discr√®tes">Cas des variables discr√®tes</h3>
<pre class="shinylive-python" data-engine="python"><code>#| standalone: true
#| viewerHeight: 830
import numpy as np
from scipy import stats
import plotly.graph_objects as go
from plotly.subplots import make_subplots
from shiny import ui, render, App
from shinywidgets import output_widget, render_widget


def keep_no_param_distribution_disc():
    distributions = stats._discrete_distns._distn_names
    distributions_0 = [name for name in distributions if not getattr(stats, name).shapes or len(getattr(stats, name).shapes) in [1, 2]]
    distributions_0_val = [getattr(stats.distributions, string) for string in distributions_0]
    distributions_0_dict = dict(zip(distributions_0, distributions_0_val))
    return distributions_0_dict

def cdf_tool(x, dtype='int64'):
    y = np.zeros(2*(len(x)), dtype=dtype)
    y[::2]=x
    y[1::2]=x
    return y[1::], y[:-1], y

def pmf_tool(x, dtype='int64'):
    y = np.zeros(2*(len(x)), dtype=dtype)
    y[::2]=x
    return y[1::], y[:-1], y

def insert_nones(my_list):
    for i, val in enumerate(my_list):
        if i % 3 == 2:
            my_list.insert(i, None)
    return my_list

distributions_0_dict = keep_no_param_distribution_disc()

app_ui = ui.page_fluid(
    ui.div(
        ui.input_slider("alpha", "Quantile", 0.01, 0.99, value=0.5, step=0.01),
        ui.input_slider("xrange", "x-range", -10, 10, value=(-5.5, 5.5), step=0.2),
        ui.input_select(
            "distrib",
            "Distribution",
            list(distributions_0_dict.keys()),
            selected='poisson'
        ),
        class_="d-flex gap-3",
    ),
    output_widget("my_widget"),
)


def server(input, output, session):
    @output
    @render_widget
    def my_widget():
        fig = make_subplots(
            rows=3,
            cols=2,
            vertical_spacing=0.1,
            horizontal_spacing=0.15,
            subplot_titles=(
                "Fonction quantile",
                "",
                "",
                "Fonction de r√©partition",
                "",
                "Fonction de masse et quantile",
            ),
            column_widths=[0.2, 0.5],
            row_heights=[0.35, 0.17, 0.17],
        )


        alpha = input.alpha()
        # alpha=0.5

        mu = 0.5  # Param needed for some distribution
        if input.distrib()=='zipf':
            mu = 2
        distribution = distributions_0_dict[input.distrib()]
        # distribution=distributions_0_dict['poisson']
        x = np.arange(np.floor(input.xrange()[0]), np.ceil(input.xrange()[1]))
        # x = np.arange(np.floor(-5.5), np.ceil(5.5))

        cdf_data = distribution.cdf(x, mu)
        pmf_data = distribution.pmf(x, mu)
        q_alpha = distribution.ppf(alpha, mu)
        support = pmf_data.nonzero()[0]
        fig.update_layout(autosize=True, height=700)

        # Quantile plot
        new_x, new_y, new_z = cdf_tool(support)
        _, _, new_pmf = pmf_tool(support)

        fig.add_trace(
            go.Scatter(
                x=insert_nones(list(np.append(cdf_data[new_y[::-1]], distribution.cdf(x[0], mu)))),
                y=insert_nones(list(np.append(x[new_x[::-1]], x[new_x[0]]))),
                mode="lines",
                line=dict(color="black")
            ),
            row=1,
            col=1,
        )
        fig.add_trace(
             go.Scatter(
                x=cdf_data[support], y=x[support],
                mode="markers", marker={"color": "black"}
            ),
            row=1,
            col=1,
        )
        # Diagonal
        fig.add_trace(
            go.Scatter(
                x=cdf_data, y=cdf_data, mode="lines", marker={"color": "black"}
            ),
            row=2,
            col=1,
        )
        # Cdf part
        fig.add_trace(
            go.Scatter(
                x=x[support], y=cdf_data[support],
                mode="markers", marker={"color": "black"}
            ),
            row=2,
            col=2,
        )
        fig.add_trace(
            go.Scatter(
                x=insert_nones(list(np.append(np.insert(x[new_x], 0, [x[0], x[new_x[0]]]),x[-1]))),
                y=insert_nones(list(np.append(np.insert(cdf_data[new_y], 0, [0,0]), cdf_data[-1]))),
                mode="lines",
                line=dict(color="black")
            ),
            row=2,
            col=2
        )

        fig.add_trace(
            go.Scatter(
                x=x, y=pmf_data, mode="markers", marker={"color": "black"}
            ),
            row=3,
            col=2,
        )
        fig.add_trace(
            go.Scatter(
                x=x, y=pmf_data, mode="markers", marker={"color": "black"}
            ),
            row=3,
            col=2,
        )
        x_bar = insert_nones(list(x[new_z]))
        y_bar = insert_nones(list(pmf_data[new_pmf]))
        fig.add_trace(
            go.Scatter(
                x=x_bar,
                y=y_bar,
                mode="lines",
                line=dict(color="black")
            ),
            row=3,
            col=2
        )
        _,_, devil_x = cdf_tool(x[x&lt;=q_alpha])
        _,_, devil_y = cdf_tool(pmf_data[x&lt;q_alpha], dtype='float64')

        x_bar_blue = insert_nones(list(devil_x))
        y_bar_blue = np.array(insert_nones(list(devil_y)))
        y_bar_blue[::-3]=0.
        y_bar_blue = list(y_bar_blue)
        fig.add_trace(
            go.Scatter(
                x=x_bar_blue,
                y=y_bar_blue,
                mode="lines",
                line=dict(color="rgb(66, 139, 202)")
            ),
            row=3,
            col=2
        )
        # pdf part
        fig.add_scatter(
            x=x[x &lt;= q_alpha],
            y=pmf_data[x &lt;= q_alpha],
            mode="markers",
            marker={"color":"rgb(66, 139, 202)"},
            row=3,
            col=2,
        )

        # Dots
        fig.add_trace(
            go.Scatter(
                x=[alpha],
                y=[q_alpha],
                mode="markers",
                marker={"color": "rgb(66, 139, 202)"},
                marker_symbol="x",
                marker_size=8,
            ),
            row=1,
            col=1,
        )

        fig.add_trace(
            go.Scatter(
                x=[alpha],
                y=[alpha],
                mode="markers",
                marker={"color": "rgb(66, 139, 202)"},
                marker_symbol="x",
                marker_size=8,
            ),
            row=2,
            col=1,
        )

        fig.add_trace(
            go.Scatter(
                x=[q_alpha],
                y=[alpha],
                mode="markers",
                marker={"color": "rgb(66, 139, 202)"},
                marker_symbol="x",
                marker_size=8,
            ),
            row=2,
            col=2,
        )

        # Lines
        fig.add_trace(
            go.Scatter(
                x=[alpha, alpha],
                y=[x[0], q_alpha],
                mode="lines",
                line=dict(dash="dash", color="rgb(66, 139, 202)")
            ),
            row=1,
            col=1
        )

        fig.add_trace(
            go.Scatter(
                x=[alpha, alpha],
                y=[alpha, 1.],
                mode="lines",
                line=dict(dash="dash", color="rgb(66, 139, 202)")
            ),
            row=2,
            col=1
        )
        fig.add_trace(
            go.Scatter(
                x=[alpha, 1],
                y=[alpha, alpha],
                mode="lines",
                line=dict(dash="dash", color="rgb(66, 139, 202)")
            ),
            row=2,
            col=1
        )
        fig.add_trace(
            go.Scatter(
                x=[x[0], q_alpha],
                y=[alpha, alpha],
                mode="lines",
                line=dict(dash="dash", color="rgb(66, 139, 202)")
            ),
            row=2,
            col=2
        )
        fig.add_trace(
            go.Scatter(
                x=[x[0], q_alpha],
                y=[x[0], 0],
                mode="lines",
                line=dict(dash="dash", color="rgb(66, 139, 202)")
            ),
            row=2,
            col=2
        )
        # Axes ranges
        fig.update_xaxes(range=[0, 1.05], row=1, col=1)
        fig.update_yaxes(matches="x6", row=1, col=1)

        fig.update_yaxes(range=[0, 1.05], row=2, col=1)
        fig.update_xaxes(matches="x1", row=2, col=1)

        fig.update_yaxes(rangemode="tozero", row=3, col=2)
        fig.update_xaxes(range=[x[0], x[-1]], row=3, col=2)

        fig.update_xaxes(matches="x6", row=2, col=2)
        fig.update_yaxes(matches="y3", row=2, col=2)

        # Add dropdown
        fig.update_layout(
            showlegend=False,
            template="simple_white",
        )
        return fig


app = App(app_ui, server)
</code></pre>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb3" data-startfrom="868" data-source-offset="-64"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 867;"><span id="cb3-868"><a href="#cb3-868" aria-hidden="true" tabindex="-1"></a>Plotly <span class="op">=</span> <span class="pp">require</span>(<span class="st">'plotly.js-dist'</span>)<span class="op">;</span></span>
<span id="cb3-869"><a href="#cb3-869" aria-hidden="true" tabindex="-1"></a>jstat <span class="op">=</span> <span class="pp">require</span>(<span class="st">'jstat'</span>)<span class="op">;</span></span>
<span id="cb3-870"><a href="#cb3-870" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-871"><a href="#cb3-871" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">laplacecdf</span>(x<span class="op">,</span> mu<span class="op">,</span> b){</span>
<span id="cb3-872"><a href="#cb3-872" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (x <span class="op">&lt;=</span> mu){</span>
<span id="cb3-873"><a href="#cb3-873" aria-hidden="true" tabindex="-1"></a>      <span class="kw">var</span> cdf <span class="op">=</span> <span class="fl">0.5</span><span class="op">*</span><span class="bu">Math</span><span class="op">.</span><span class="fu">exp</span>((x<span class="op">-</span>mu)<span class="op">/</span>b)</span>
<span id="cb3-874"><a href="#cb3-874" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb3-875"><a href="#cb3-875" aria-hidden="true" tabindex="-1"></a>      <span class="kw">var</span> cdf <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> <span class="fl">0.5</span><span class="op">*</span><span class="bu">Math</span><span class="op">.</span><span class="fu">exp</span>(<span class="op">-</span>(x<span class="op">-</span>mu)<span class="op">/</span>b)</span>
<span id="cb3-876"><a href="#cb3-876" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-877"><a href="#cb3-877" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> cdf</span>
<span id="cb3-878"><a href="#cb3-878" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-879"><a href="#cb3-879" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-880"><a href="#cb3-880" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">laplacepdf</span>(x<span class="op">,</span>mu<span class="op">,</span>b){</span>
<span id="cb3-881"><a href="#cb3-881" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> (<span class="dv">1</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>b))<span class="op">*</span><span class="bu">Math</span><span class="op">.</span><span class="fu">exp</span>(<span class="op">-</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">abs</span>((x<span class="op">-</span>mu)<span class="op">/</span>b) )</span>
<span id="cb3-882"><a href="#cb3-882" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-883"><a href="#cb3-883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-884"><a href="#cb3-884" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">laplaceinv</span>(p<span class="op">,</span>mu<span class="op">,</span>b){</span>
<span id="cb3-885"><a href="#cb3-885" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> mu <span class="op">-</span> b<span class="op">*</span><span class="bu">Math</span><span class="op">.</span><span class="fu">sign</span>(p<span class="op">-</span><span class="fl">0.5</span>)<span class="op">*</span><span class="bu">Math</span><span class="op">.</span><span class="fu">log</span>(<span class="dv">1</span><span class="op">-</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">abs</span>(p<span class="op">-</span><span class="fl">0.5</span>))</span>
<span id="cb3-886"><a href="#cb3-886" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-887"><a href="#cb3-887" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-888"><a href="#cb3-888" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-889"><a href="#cb3-889" aria-hidden="true" tabindex="-1"></a>jstatPDFs <span class="op">=</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb3-890"><a href="#cb3-890" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> distributions <span class="op">=</span> <span class="bu">Object</span><span class="op">.</span><span class="fu">keys</span>(jstat)<span class="op">;</span></span>
<span id="cb3-891"><a href="#cb3-891" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> continuousDistributions <span class="op">=</span> distributions<span class="op">.</span><span class="fu">filter</span>(name <span class="kw">=&gt;</span> jstat[name]<span class="op">.</span><span class="at">pdf</span> <span class="op">&amp;&amp;</span> jstat[name]<span class="op">.</span><span class="at">cdf</span> <span class="op">&amp;&amp;</span> jstat[name]<span class="op">.</span><span class="at">inv</span>)<span class="op">;</span></span>
<span id="cb3-892"><a href="#cb3-892" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> pdfs <span class="op">=</span> {}<span class="op">;</span></span>
<span id="cb3-893"><a href="#cb3-893" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> cdfs <span class="op">=</span> {}<span class="op">;</span></span>
<span id="cb3-894"><a href="#cb3-894" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> invs <span class="op">=</span> {}<span class="op">;</span></span>
<span id="cb3-895"><a href="#cb3-895" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-896"><a href="#cb3-896" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (<span class="kw">const</span> name <span class="kw">of</span> continuousDistributions) {</span>
<span id="cb3-897"><a href="#cb3-897" aria-hidden="true" tabindex="-1"></a>    <span class="co">// if (name == 'laplace') {</span></span>
<span id="cb3-898"><a href="#cb3-898" aria-hidden="true" tabindex="-1"></a>        <span class="co">// cdfs[name] = (p, mu, b) =&gt; laplacecdf(p, mu, b);</span></span>
<span id="cb3-899"><a href="#cb3-899" aria-hidden="true" tabindex="-1"></a>        <span class="co">// pdfs[name] = (p, mu, b) =&gt; laplacepdf(p, mu, b);</span></span>
<span id="cb3-900"><a href="#cb3-900" aria-hidden="true" tabindex="-1"></a>        <span class="co">// invs[name] = (p, mu, b) =&gt; laplaceinv(p, mu, b);</span></span>
<span id="cb3-901"><a href="#cb3-901" aria-hidden="true" tabindex="-1"></a>        <span class="co">// }</span></span>
<span id="cb3-902"><a href="#cb3-902" aria-hidden="true" tabindex="-1"></a>    <span class="co">// else{</span></span>
<span id="cb3-903"><a href="#cb3-903" aria-hidden="true" tabindex="-1"></a>    pdfs[name] <span class="op">=</span> jstat[name]<span class="op">.</span><span class="at">pdf</span><span class="op">;</span></span>
<span id="cb3-904"><a href="#cb3-904" aria-hidden="true" tabindex="-1"></a>    cdfs[name] <span class="op">=</span> jstat[name]<span class="op">.</span><span class="at">cdf</span><span class="op">;</span></span>
<span id="cb3-905"><a href="#cb3-905" aria-hidden="true" tabindex="-1"></a>    invs[name] <span class="op">=</span> jstat[name]<span class="op">.</span><span class="at">inv</span><span class="op">;</span></span>
<span id="cb3-906"><a href="#cb3-906" aria-hidden="true" tabindex="-1"></a>    <span class="co">// }</span></span>
<span id="cb3-907"><a href="#cb3-907" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-908"><a href="#cb3-908" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> {<span class="dt">pdf</span><span class="op">:</span>pdfs<span class="op">,</span> <span class="dt">cdf</span><span class="op">:</span>cdfs<span class="op">,</span> <span class="dt">inv</span><span class="op">:</span>invs}<span class="op">;</span></span>
<span id="cb3-909"><a href="#cb3-909" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span>
<span id="cb3-910"><a href="#cb3-910" aria-hidden="true" tabindex="-1"></a>output <span class="op">=</span> <span class="fu">jstatPDFs</span>()<span class="op">;</span></span>
<span id="cb3-911"><a href="#cb3-911" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-912"><a href="#cb3-912" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-913"><a href="#cb3-913" aria-hidden="true" tabindex="-1"></a>excludedPDFs <span class="op">=</span> [<span class="st">'binomial'</span><span class="op">,</span> <span class="st">'negbin'</span><span class="op">,</span> <span class="st">'poisson'</span>]<span class="op">;</span></span>
<span id="cb3-914"><a href="#cb3-914" aria-hidden="true" tabindex="-1"></a>pdfNames_unsorted <span class="op">=</span> <span class="bu">Object</span><span class="op">.</span><span class="fu">keys</span>(output<span class="op">.</span><span class="at">pdf</span>)<span class="op">.</span><span class="fu">filter</span>(name <span class="kw">=&gt;</span> <span class="op">!</span>excludedPDFs<span class="op">.</span><span class="fu">includes</span>(name))<span class="op">;</span></span>
<span id="cb3-915"><a href="#cb3-915" aria-hidden="true" tabindex="-1"></a>pdfNames<span class="op">=</span>pdfNames_unsorted<span class="op">.</span><span class="fu">toSorted</span>()<span class="op">;</span></span>
<span id="cb3-916"><a href="#cb3-916" aria-hidden="true" tabindex="-1"></a>viewof inputs <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">form</span>([</span>
<span id="cb3-917"><a href="#cb3-917" aria-hidden="true" tabindex="-1"></a>      Inputs<span class="op">.</span><span class="fu">range</span>([<span class="op">-</span><span class="dv">10</span><span class="op">,</span> <span class="dv">10</span>]<span class="op">,</span> {<span class="dt">value</span><span class="op">:</span> <span class="fl">0.1</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="fl">0.001</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="fu">tex</span><span class="vs">`</span><span class="sc">\m</span><span class="vs">u`</span>})<span class="op">,</span></span>
<span id="cb3-918"><a href="#cb3-918" aria-hidden="true" tabindex="-1"></a>      Inputs<span class="op">.</span><span class="fu">range</span>([<span class="fl">0.01</span><span class="op">,</span> <span class="dv">5</span>]<span class="op">,</span> {<span class="dt">value</span><span class="op">:</span> <span class="fl">1.01</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="fl">0.001</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="fu">tex</span><span class="vs">`</span><span class="sc">\s</span><span class="vs">igma`</span>})<span class="op">,</span></span>
<span id="cb3-919"><a href="#cb3-919" aria-hidden="true" tabindex="-1"></a>      Inputs<span class="op">.</span><span class="fu">range</span>([<span class="fl">0.001</span><span class="op">,</span> <span class="fl">0.999</span>]<span class="op">,</span> {<span class="dt">value</span><span class="op">:</span> <span class="fl">0.75</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="fl">0.001</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span><span class="fu">tex</span><span class="vs">`</span><span class="sc">\a</span><span class="vs">lpha`</span>})<span class="op">,</span></span>
<span id="cb3-920"><a href="#cb3-920" aria-hidden="true" tabindex="-1"></a>    ])<span class="op">;</span></span>
<span id="cb3-921"><a href="#cb3-921" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-922"><a href="#cb3-922" aria-hidden="true" tabindex="-1"></a>viewof distrib_name <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">select</span>(pdfNames<span class="op">,</span> {<span class="dt">value</span><span class="op">:</span> <span class="st">"normal"</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"Distribution"</span>})<span class="op">;</span></span>
<span id="cb3-923"><a href="#cb3-923" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-924"><a href="#cb3-924" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-925"><a href="#cb3-925" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb3-926"><a href="#cb3-926" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> x <span class="op">=</span> d3<span class="op">.</span><span class="fu">range</span>(<span class="op">-</span><span class="dv">5</span><span class="op">,</span> <span class="dv">5</span><span class="op">,</span> <span class="fl">0.01</span>)<span class="op">;</span></span>
<span id="cb3-927"><a href="#cb3-927" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> pdf <span class="op">=</span> x<span class="op">.</span><span class="fu">map</span>(x <span class="kw">=&gt;</span> jstat[distrib_name]<span class="op">.</span><span class="fu">pdf</span>(x<span class="op">,</span> mu<span class="op">,</span> sigma))<span class="op">;</span></span>
<span id="cb3-928"><a href="#cb3-928" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> cdf <span class="op">=</span> x<span class="op">.</span><span class="fu">map</span>(x <span class="kw">=&gt;</span> jstat[distrib_name]<span class="op">.</span><span class="fu">cdf</span>(x<span class="op">,</span> mu<span class="op">,</span> sigma))<span class="op">;</span></span>
<span id="cb3-929"><a href="#cb3-929" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> inv <span class="op">=</span> x<span class="op">.</span><span class="fu">map</span>(x <span class="kw">=&gt;</span> jstat[distrib_name]<span class="op">.</span><span class="fu">inv</span>(x<span class="op">,</span> mu<span class="op">,</span> sigma))<span class="op">;</span></span>
<span id="cb3-930"><a href="#cb3-930" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> quantile <span class="op">=</span> jstat[distrib_name]<span class="op">.</span><span class="fu">inv</span>(alpha<span class="op">,</span> mu<span class="op">,</span> sigma)<span class="op">;</span></span>
<span id="cb3-931"><a href="#cb3-931" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> filteredX <span class="op">=</span> x<span class="op">.</span><span class="fu">filter</span>(coord <span class="kw">=&gt;</span> coord <span class="op">&lt;=</span> quantile)<span class="op">;</span></span>
<span id="cb3-932"><a href="#cb3-932" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> filteredPdf <span class="op">=</span> pdf<span class="op">.</span><span class="fu">filter</span>((_<span class="op">,</span> i) <span class="kw">=&gt;</span> x[i] <span class="op">&lt;=</span> quantile)<span class="op">;</span></span>
<span id="cb3-933"><a href="#cb3-933" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> filteredCdf <span class="op">=</span> cdf<span class="op">.</span><span class="fu">filter</span>(coord <span class="kw">=&gt;</span> coord <span class="op">&lt;=</span> quantile)<span class="op">;</span></span>
<span id="cb3-934"><a href="#cb3-934" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-935"><a href="#cb3-935" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-936"><a href="#cb3-936" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb3-937"><a href="#cb3-937" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> trace1 <span class="op">=</span> {</span>
<span id="cb3-938"><a href="#cb3-938" aria-hidden="true" tabindex="-1"></a>      <span class="dt">type</span><span class="op">:</span> <span class="st">"scatter"</span><span class="op">,</span></span>
<span id="cb3-939"><a href="#cb3-939" aria-hidden="true" tabindex="-1"></a>      <span class="dt">name</span><span class="op">:</span> <span class="st">'Quantile'</span><span class="op">,</span></span>
<span id="cb3-940"><a href="#cb3-940" aria-hidden="true" tabindex="-1"></a>      <span class="dt">x</span> <span class="op">:</span> cdf<span class="op">,</span></span>
<span id="cb3-941"><a href="#cb3-941" aria-hidden="true" tabindex="-1"></a>      <span class="dt">y</span> <span class="op">:</span> x<span class="op">,</span></span>
<span id="cb3-942"><a href="#cb3-942" aria-hidden="true" tabindex="-1"></a>      <span class="dt">line</span><span class="op">:</span> {<span class="dt">color</span><span class="op">:</span> <span class="st">'black'</span>}<span class="op">,</span></span>
<span id="cb3-943"><a href="#cb3-943" aria-hidden="true" tabindex="-1"></a>      <span class="dt">xaxis</span><span class="op">:</span> <span class="st">'x1'</span><span class="op">,</span></span>
<span id="cb3-944"><a href="#cb3-944" aria-hidden="true" tabindex="-1"></a>      <span class="dt">yaxis</span><span class="op">:</span> <span class="st">'y3'</span><span class="op">,</span></span>
<span id="cb3-945"><a href="#cb3-945" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-946"><a href="#cb3-946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-947"><a href="#cb3-947" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span>
<span id="cb3-948"><a href="#cb3-948" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-949"><a href="#cb3-949" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> trace12 <span class="op">=</span> {</span>
<span id="cb3-950"><a href="#cb3-950" aria-hidden="true" tabindex="-1"></a>        <span class="dt">x</span> <span class="op">:</span> [alpha<span class="op">,</span> alpha]<span class="op">,</span></span>
<span id="cb3-951"><a href="#cb3-951" aria-hidden="true" tabindex="-1"></a>        <span class="dt">y</span> <span class="op">:</span> [x[<span class="dv">0</span>]<span class="op">,</span> quantile]<span class="op">,</span></span>
<span id="cb3-952"><a href="#cb3-952" aria-hidden="true" tabindex="-1"></a>        <span class="dt">mode</span><span class="op">:</span> <span class="st">'lines'</span><span class="op">,</span></span>
<span id="cb3-953"><a href="#cb3-953" aria-hidden="true" tabindex="-1"></a>        <span class="dt">line</span><span class="op">:</span> {</span>
<span id="cb3-954"><a href="#cb3-954" aria-hidden="true" tabindex="-1"></a>            <span class="dt">dash</span><span class="op">:</span> <span class="st">'dash'</span><span class="op">,</span></span>
<span id="cb3-955"><a href="#cb3-955" aria-hidden="true" tabindex="-1"></a>            <span class="dt">width</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb3-956"><a href="#cb3-956" aria-hidden="true" tabindex="-1"></a>            <span class="dt">color</span><span class="op">:</span> <span class="st">' #428BCA'</span><span class="op">,</span></span>
<span id="cb3-957"><a href="#cb3-957" aria-hidden="true" tabindex="-1"></a>            <span class="dt">marks</span><span class="op">:</span> {</span>
<span id="cb3-958"><a href="#cb3-958" aria-hidden="true" tabindex="-1"></a>                <span class="dt">size</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb3-959"><a href="#cb3-959" aria-hidden="true" tabindex="-1"></a>                <span class="dt">color</span><span class="op">:</span> <span class="st">' #428BCA'</span><span class="op">,</span></span>
<span id="cb3-960"><a href="#cb3-960" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb3-961"><a href="#cb3-961" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-962"><a href="#cb3-962" aria-hidden="true" tabindex="-1"></a>          }<span class="op">,</span></span>
<span id="cb3-963"><a href="#cb3-963" aria-hidden="true" tabindex="-1"></a>      <span class="dt">xaxis</span><span class="op">:</span> <span class="st">'x1'</span><span class="op">,</span></span>
<span id="cb3-964"><a href="#cb3-964" aria-hidden="true" tabindex="-1"></a>      <span class="dt">yaxis</span><span class="op">:</span> <span class="st">'y3'</span><span class="op">,</span></span>
<span id="cb3-965"><a href="#cb3-965" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-966"><a href="#cb3-966" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-967"><a href="#cb3-967" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span>
<span id="cb3-968"><a href="#cb3-968" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-969"><a href="#cb3-969" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-970"><a href="#cb3-970" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-971"><a href="#cb3-971" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> trace13 <span class="op">=</span> {</span>
<span id="cb3-972"><a href="#cb3-972" aria-hidden="true" tabindex="-1"></a>    <span class="dt">x</span><span class="op">:</span> [<span class="dv">0</span><span class="op">,</span> alpha]<span class="op">,</span></span>
<span id="cb3-973"><a href="#cb3-973" aria-hidden="true" tabindex="-1"></a>    <span class="dt">y</span><span class="op">:</span> [quantile<span class="op">,</span> quantile]<span class="op">,</span></span>
<span id="cb3-974"><a href="#cb3-974" aria-hidden="true" tabindex="-1"></a>    <span class="dt">mode</span><span class="op">:</span> <span class="st">'scatter'</span><span class="op">,</span></span>
<span id="cb3-975"><a href="#cb3-975" aria-hidden="true" tabindex="-1"></a>    <span class="dt">line</span><span class="op">:</span> {</span>
<span id="cb3-976"><a href="#cb3-976" aria-hidden="true" tabindex="-1"></a>        <span class="dt">dash</span><span class="op">:</span> <span class="st">'dash'</span><span class="op">,</span></span>
<span id="cb3-977"><a href="#cb3-977" aria-hidden="true" tabindex="-1"></a>        <span class="dt">width</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb3-978"><a href="#cb3-978" aria-hidden="true" tabindex="-1"></a>        <span class="dt">color</span><span class="op">:</span> <span class="st">' #428BCA'</span><span class="op">,</span></span>
<span id="cb3-979"><a href="#cb3-979" aria-hidden="true" tabindex="-1"></a>        <span class="dt">marks</span><span class="op">:</span> {</span>
<span id="cb3-980"><a href="#cb3-980" aria-hidden="true" tabindex="-1"></a>            <span class="dt">size</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb3-981"><a href="#cb3-981" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb3-982"><a href="#cb3-982" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb3-983"><a href="#cb3-983" aria-hidden="true" tabindex="-1"></a>    <span class="dt">xaxis</span><span class="op">:</span> <span class="st">'x1'</span><span class="op">,</span></span>
<span id="cb3-984"><a href="#cb3-984" aria-hidden="true" tabindex="-1"></a>    <span class="dt">yaxis</span><span class="op">:</span> <span class="st">'y3'</span></span>
<span id="cb3-985"><a href="#cb3-985" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-986"><a href="#cb3-986" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-987"><a href="#cb3-987" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-988"><a href="#cb3-988" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> trace2 <span class="op">=</span> {</span>
<span id="cb3-989"><a href="#cb3-989" aria-hidden="true" tabindex="-1"></a><span class="dt">x</span><span class="op">:</span> cdf<span class="op">,</span></span>
<span id="cb3-990"><a href="#cb3-990" aria-hidden="true" tabindex="-1"></a><span class="dt">y</span><span class="op">:</span> cdf<span class="op">,</span></span>
<span id="cb3-991"><a href="#cb3-991" aria-hidden="true" tabindex="-1"></a><span class="dt">type</span><span class="op">:</span> <span class="st">'scatter'</span><span class="op">,</span></span>
<span id="cb3-992"><a href="#cb3-992" aria-hidden="true" tabindex="-1"></a><span class="dt">name</span><span class="op">:</span> <span class="st">'identity'</span><span class="op">,</span></span>
<span id="cb3-993"><a href="#cb3-993" aria-hidden="true" tabindex="-1"></a><span class="dt">line</span><span class="op">:</span> {<span class="dt">color</span><span class="op">:</span> <span class="st">'black'</span>}<span class="op">,</span></span>
<span id="cb3-994"><a href="#cb3-994" aria-hidden="true" tabindex="-1"></a><span class="dt">xaxis</span><span class="op">:</span> <span class="st">'x1'</span><span class="op">,</span></span>
<span id="cb3-995"><a href="#cb3-995" aria-hidden="true" tabindex="-1"></a><span class="dt">yaxis</span><span class="op">:</span> <span class="st">'y2'</span></span>
<span id="cb3-996"><a href="#cb3-996" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-997"><a href="#cb3-997" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span>
<span id="cb3-998"><a href="#cb3-998" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-999"><a href="#cb3-999" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-1000"><a href="#cb3-1000" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> trace21 <span class="op">=</span> {</span>
<span id="cb3-1001"><a href="#cb3-1001" aria-hidden="true" tabindex="-1"></a>        <span class="dt">x</span> <span class="op">:</span> [alpha<span class="op">,</span> <span class="dv">1</span>]<span class="op">,</span></span>
<span id="cb3-1002"><a href="#cb3-1002" aria-hidden="true" tabindex="-1"></a>        <span class="dt">y</span> <span class="op">:</span> [alpha<span class="op">,</span> alpha]<span class="op">,</span></span>
<span id="cb3-1003"><a href="#cb3-1003" aria-hidden="true" tabindex="-1"></a>        <span class="dt">mode</span><span class="op">:</span> <span class="st">'lines'</span><span class="op">,</span></span>
<span id="cb3-1004"><a href="#cb3-1004" aria-hidden="true" tabindex="-1"></a>        <span class="dt">line</span><span class="op">:</span> {</span>
<span id="cb3-1005"><a href="#cb3-1005" aria-hidden="true" tabindex="-1"></a>            <span class="dt">dash</span><span class="op">:</span> <span class="st">'dash'</span><span class="op">,</span></span>
<span id="cb3-1006"><a href="#cb3-1006" aria-hidden="true" tabindex="-1"></a>            <span class="dt">width</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb3-1007"><a href="#cb3-1007" aria-hidden="true" tabindex="-1"></a>            <span class="dt">color</span><span class="op">:</span> <span class="st">' #428BCA'</span><span class="op">,</span></span>
<span id="cb3-1008"><a href="#cb3-1008" aria-hidden="true" tabindex="-1"></a>            <span class="dt">marks</span><span class="op">:</span> {</span>
<span id="cb3-1009"><a href="#cb3-1009" aria-hidden="true" tabindex="-1"></a>                <span class="dt">size</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb3-1010"><a href="#cb3-1010" aria-hidden="true" tabindex="-1"></a>                <span class="dt">color</span><span class="op">:</span> <span class="st">' #428BCA'</span><span class="op">,</span></span>
<span id="cb3-1011"><a href="#cb3-1011" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb3-1012"><a href="#cb3-1012" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-1013"><a href="#cb3-1013" aria-hidden="true" tabindex="-1"></a>          }<span class="op">,</span></span>
<span id="cb3-1014"><a href="#cb3-1014" aria-hidden="true" tabindex="-1"></a>      <span class="dt">xaxis</span><span class="op">:</span> <span class="st">'x1'</span><span class="op">,</span></span>
<span id="cb3-1015"><a href="#cb3-1015" aria-hidden="true" tabindex="-1"></a>      <span class="dt">yaxis</span><span class="op">:</span> <span class="st">'y2'</span></span>
<span id="cb3-1016"><a href="#cb3-1016" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-1017"><a href="#cb3-1017" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-1018"><a href="#cb3-1018" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> trace22 <span class="op">=</span> {</span>
<span id="cb3-1019"><a href="#cb3-1019" aria-hidden="true" tabindex="-1"></a>        <span class="dt">x</span> <span class="op">:</span> [alpha<span class="op">,</span> alpha]<span class="op">,</span></span>
<span id="cb3-1020"><a href="#cb3-1020" aria-hidden="true" tabindex="-1"></a>        <span class="dt">y</span> <span class="op">:</span> [alpha<span class="op">,</span> <span class="dv">1</span>]<span class="op">,</span></span>
<span id="cb3-1021"><a href="#cb3-1021" aria-hidden="true" tabindex="-1"></a>        <span class="dt">mode</span><span class="op">:</span> <span class="st">'lines'</span><span class="op">,</span></span>
<span id="cb3-1022"><a href="#cb3-1022" aria-hidden="true" tabindex="-1"></a>        <span class="dt">line</span><span class="op">:</span> {</span>
<span id="cb3-1023"><a href="#cb3-1023" aria-hidden="true" tabindex="-1"></a>            <span class="dt">dash</span><span class="op">:</span> <span class="st">'dash'</span><span class="op">,</span></span>
<span id="cb3-1024"><a href="#cb3-1024" aria-hidden="true" tabindex="-1"></a>            <span class="dt">width</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb3-1025"><a href="#cb3-1025" aria-hidden="true" tabindex="-1"></a>            <span class="dt">color</span><span class="op">:</span> <span class="st">' #428BCA'</span><span class="op">,</span></span>
<span id="cb3-1026"><a href="#cb3-1026" aria-hidden="true" tabindex="-1"></a>            <span class="dt">marks</span><span class="op">:</span> {</span>
<span id="cb3-1027"><a href="#cb3-1027" aria-hidden="true" tabindex="-1"></a>                <span class="dt">size</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb3-1028"><a href="#cb3-1028" aria-hidden="true" tabindex="-1"></a>                <span class="dt">color</span><span class="op">:</span> <span class="st">' #428BCA'</span><span class="op">,</span></span>
<span id="cb3-1029"><a href="#cb3-1029" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb3-1030"><a href="#cb3-1030" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-1031"><a href="#cb3-1031" aria-hidden="true" tabindex="-1"></a>          }<span class="op">,</span></span>
<span id="cb3-1032"><a href="#cb3-1032" aria-hidden="true" tabindex="-1"></a>      <span class="dt">xaxis</span><span class="op">:</span> <span class="st">'x1'</span><span class="op">,</span></span>
<span id="cb3-1033"><a href="#cb3-1033" aria-hidden="true" tabindex="-1"></a>      <span class="dt">yaxis</span><span class="op">:</span> <span class="st">'y2'</span></span>
<span id="cb3-1034"><a href="#cb3-1034" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-1035"><a href="#cb3-1035" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-1036"><a href="#cb3-1036" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> trace23 <span class="op">=</span> {</span>
<span id="cb3-1037"><a href="#cb3-1037" aria-hidden="true" tabindex="-1"></a>    <span class="dt">x</span><span class="op">:</span> [alpha]<span class="op">,</span></span>
<span id="cb3-1038"><a href="#cb3-1038" aria-hidden="true" tabindex="-1"></a>    <span class="dt">y</span><span class="op">:</span> [alpha]<span class="op">,</span></span>
<span id="cb3-1039"><a href="#cb3-1039" aria-hidden="true" tabindex="-1"></a>    <span class="dt">mode</span><span class="op">:</span> <span class="st">'scatter'</span><span class="op">,</span></span>
<span id="cb3-1040"><a href="#cb3-1040" aria-hidden="true" tabindex="-1"></a>    <span class="dt">line</span><span class="op">:</span> {</span>
<span id="cb3-1041"><a href="#cb3-1041" aria-hidden="true" tabindex="-1"></a>        <span class="dt">dash</span><span class="op">:</span> <span class="st">'dash'</span><span class="op">,</span></span>
<span id="cb3-1042"><a href="#cb3-1042" aria-hidden="true" tabindex="-1"></a>        <span class="dt">width</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb3-1043"><a href="#cb3-1043" aria-hidden="true" tabindex="-1"></a>        <span class="dt">color</span><span class="op">:</span> <span class="st">' #428BCA'</span><span class="op">,</span></span>
<span id="cb3-1044"><a href="#cb3-1044" aria-hidden="true" tabindex="-1"></a>        <span class="dt">marks</span><span class="op">:</span> {</span>
<span id="cb3-1045"><a href="#cb3-1045" aria-hidden="true" tabindex="-1"></a>            <span class="dt">size</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb3-1046"><a href="#cb3-1046" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb3-1047"><a href="#cb3-1047" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb3-1048"><a href="#cb3-1048" aria-hidden="true" tabindex="-1"></a>    <span class="dt">xaxis</span><span class="op">:</span> <span class="st">'x1'</span><span class="op">,</span></span>
<span id="cb3-1049"><a href="#cb3-1049" aria-hidden="true" tabindex="-1"></a>    <span class="dt">yaxis</span><span class="op">:</span> <span class="st">'y2'</span></span>
<span id="cb3-1050"><a href="#cb3-1050" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-1051"><a href="#cb3-1051" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-1052"><a href="#cb3-1052" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-1053"><a href="#cb3-1053" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> trace31 <span class="op">=</span> {</span>
<span id="cb3-1054"><a href="#cb3-1054" aria-hidden="true" tabindex="-1"></a>      <span class="dt">type</span><span class="op">:</span> <span class="st">"scatter"</span><span class="op">,</span></span>
<span id="cb3-1055"><a href="#cb3-1055" aria-hidden="true" tabindex="-1"></a>      <span class="dt">mode</span><span class="op">:</span> <span class="st">"lines"</span><span class="op">,</span></span>
<span id="cb3-1056"><a href="#cb3-1056" aria-hidden="true" tabindex="-1"></a>      <span class="dt">name</span><span class="op">:</span> <span class="st">'PDF2'</span><span class="op">,</span></span>
<span id="cb3-1057"><a href="#cb3-1057" aria-hidden="true" tabindex="-1"></a>      <span class="dt">x</span><span class="op">:</span> x<span class="op">,</span></span>
<span id="cb3-1058"><a href="#cb3-1058" aria-hidden="true" tabindex="-1"></a>      <span class="dt">y</span><span class="op">:</span> cdf<span class="op">,</span></span>
<span id="cb3-1059"><a href="#cb3-1059" aria-hidden="true" tabindex="-1"></a>      <span class="dt">line</span><span class="op">:</span> {<span class="dt">color</span><span class="op">:</span> <span class="st">'black'</span>}<span class="op">,</span></span>
<span id="cb3-1060"><a href="#cb3-1060" aria-hidden="true" tabindex="-1"></a>      <span class="dt">xaxis</span><span class="op">:</span> <span class="st">'x2'</span><span class="op">,</span></span>
<span id="cb3-1061"><a href="#cb3-1061" aria-hidden="true" tabindex="-1"></a>      <span class="dt">yaxis</span><span class="op">:</span> <span class="st">'y2'</span><span class="op">,</span></span>
<span id="cb3-1062"><a href="#cb3-1062" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span>
<span id="cb3-1063"><a href="#cb3-1063" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-1064"><a href="#cb3-1064" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> trace32 <span class="op">=</span> {</span>
<span id="cb3-1065"><a href="#cb3-1065" aria-hidden="true" tabindex="-1"></a>        <span class="dt">x</span> <span class="op">:</span> filteredX<span class="op">,</span></span>
<span id="cb3-1066"><a href="#cb3-1066" aria-hidden="true" tabindex="-1"></a>        <span class="dt">y</span> <span class="op">:</span> filteredX<span class="op">.</span><span class="fu">map</span>(x <span class="kw">=&gt;</span> alpha)<span class="op">,</span></span>
<span id="cb3-1067"><a href="#cb3-1067" aria-hidden="true" tabindex="-1"></a>        <span class="dt">mode</span><span class="op">:</span> <span class="st">'lines'</span><span class="op">,</span></span>
<span id="cb3-1068"><a href="#cb3-1068" aria-hidden="true" tabindex="-1"></a>        <span class="dt">line</span><span class="op">:</span> {</span>
<span id="cb3-1069"><a href="#cb3-1069" aria-hidden="true" tabindex="-1"></a>            <span class="dt">dash</span><span class="op">:</span> <span class="st">'dash'</span><span class="op">,</span></span>
<span id="cb3-1070"><a href="#cb3-1070" aria-hidden="true" tabindex="-1"></a>            <span class="dt">width</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb3-1071"><a href="#cb3-1071" aria-hidden="true" tabindex="-1"></a>            <span class="dt">color</span><span class="op">:</span> <span class="st">' #428BCA'</span><span class="op">,</span></span>
<span id="cb3-1072"><a href="#cb3-1072" aria-hidden="true" tabindex="-1"></a>            <span class="dt">marks</span><span class="op">:</span> {</span>
<span id="cb3-1073"><a href="#cb3-1073" aria-hidden="true" tabindex="-1"></a>                <span class="dt">size</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb3-1074"><a href="#cb3-1074" aria-hidden="true" tabindex="-1"></a>                <span class="dt">color</span><span class="op">:</span> <span class="st">' #428BCA'</span><span class="op">,</span></span>
<span id="cb3-1075"><a href="#cb3-1075" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb3-1076"><a href="#cb3-1076" aria-hidden="true" tabindex="-1"></a>          }<span class="op">,</span></span>
<span id="cb3-1077"><a href="#cb3-1077" aria-hidden="true" tabindex="-1"></a>      <span class="dt">xaxis</span><span class="op">:</span> <span class="st">'x2'</span><span class="op">,</span></span>
<span id="cb3-1078"><a href="#cb3-1078" aria-hidden="true" tabindex="-1"></a>      <span class="dt">yaxis</span><span class="op">:</span> <span class="st">'y2'</span></span>
<span id="cb3-1079"><a href="#cb3-1079" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-1080"><a href="#cb3-1080" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-1081"><a href="#cb3-1081" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> trace33 <span class="op">=</span> {</span>
<span id="cb3-1082"><a href="#cb3-1082" aria-hidden="true" tabindex="-1"></a>        <span class="dt">x</span> <span class="op">:</span> [quantile<span class="op">,</span> quantile]<span class="op">,</span></span>
<span id="cb3-1083"><a href="#cb3-1083" aria-hidden="true" tabindex="-1"></a>        <span class="dt">y</span> <span class="op">:</span> [<span class="dv">0</span><span class="op">,</span> alpha]<span class="op">,</span></span>
<span id="cb3-1084"><a href="#cb3-1084" aria-hidden="true" tabindex="-1"></a>        <span class="dt">mode</span><span class="op">:</span> <span class="st">'lines'</span><span class="op">,</span></span>
<span id="cb3-1085"><a href="#cb3-1085" aria-hidden="true" tabindex="-1"></a>        <span class="dt">line</span><span class="op">:</span> {</span>
<span id="cb3-1086"><a href="#cb3-1086" aria-hidden="true" tabindex="-1"></a>            <span class="dt">dash</span><span class="op">:</span> <span class="st">'dash'</span><span class="op">,</span></span>
<span id="cb3-1087"><a href="#cb3-1087" aria-hidden="true" tabindex="-1"></a>            <span class="dt">width</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb3-1088"><a href="#cb3-1088" aria-hidden="true" tabindex="-1"></a>            <span class="dt">color</span><span class="op">:</span> <span class="st">' #428BCA'</span><span class="op">,</span></span>
<span id="cb3-1089"><a href="#cb3-1089" aria-hidden="true" tabindex="-1"></a>            <span class="dt">marks</span><span class="op">:</span> {</span>
<span id="cb3-1090"><a href="#cb3-1090" aria-hidden="true" tabindex="-1"></a>                <span class="dt">size</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb3-1091"><a href="#cb3-1091" aria-hidden="true" tabindex="-1"></a>                <span class="dt">color</span><span class="op">:</span> <span class="st">' #428BCA'</span><span class="op">,</span></span>
<span id="cb3-1092"><a href="#cb3-1092" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb3-1093"><a href="#cb3-1093" aria-hidden="true" tabindex="-1"></a>          }<span class="op">,</span></span>
<span id="cb3-1094"><a href="#cb3-1094" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-1095"><a href="#cb3-1095" aria-hidden="true" tabindex="-1"></a>      <span class="dt">xaxis</span><span class="op">:</span> <span class="st">'x2'</span><span class="op">,</span></span>
<span id="cb3-1096"><a href="#cb3-1096" aria-hidden="true" tabindex="-1"></a>      <span class="dt">yaxis</span><span class="op">:</span> <span class="st">'y2'</span></span>
<span id="cb3-1097"><a href="#cb3-1097" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-1098"><a href="#cb3-1098" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-1099"><a href="#cb3-1099" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> trace34 <span class="op">=</span> {</span>
<span id="cb3-1100"><a href="#cb3-1100" aria-hidden="true" tabindex="-1"></a>    <span class="dt">x</span><span class="op">:</span> [quantile]<span class="op">,</span></span>
<span id="cb3-1101"><a href="#cb3-1101" aria-hidden="true" tabindex="-1"></a>    <span class="dt">y</span><span class="op">:</span> [alpha]<span class="op">,</span></span>
<span id="cb3-1102"><a href="#cb3-1102" aria-hidden="true" tabindex="-1"></a>    <span class="dt">mode</span><span class="op">:</span> <span class="st">'scatter'</span><span class="op">,</span></span>
<span id="cb3-1103"><a href="#cb3-1103" aria-hidden="true" tabindex="-1"></a>    <span class="dt">line</span><span class="op">:</span> {</span>
<span id="cb3-1104"><a href="#cb3-1104" aria-hidden="true" tabindex="-1"></a>        <span class="dt">dash</span><span class="op">:</span> <span class="st">'dash'</span><span class="op">,</span></span>
<span id="cb3-1105"><a href="#cb3-1105" aria-hidden="true" tabindex="-1"></a>        <span class="dt">width</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb3-1106"><a href="#cb3-1106" aria-hidden="true" tabindex="-1"></a>        <span class="dt">color</span><span class="op">:</span> <span class="st">' #428BCA'</span><span class="op">,</span></span>
<span id="cb3-1107"><a href="#cb3-1107" aria-hidden="true" tabindex="-1"></a>        <span class="dt">marks</span><span class="op">:</span> {</span>
<span id="cb3-1108"><a href="#cb3-1108" aria-hidden="true" tabindex="-1"></a>            <span class="dt">size</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb3-1109"><a href="#cb3-1109" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb3-1110"><a href="#cb3-1110" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb3-1111"><a href="#cb3-1111" aria-hidden="true" tabindex="-1"></a>    <span class="dt">xaxis</span><span class="op">:</span> <span class="st">'x2'</span><span class="op">,</span></span>
<span id="cb3-1112"><a href="#cb3-1112" aria-hidden="true" tabindex="-1"></a>    <span class="dt">yaxis</span><span class="op">:</span> <span class="st">'y2'</span></span>
<span id="cb3-1113"><a href="#cb3-1113" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-1114"><a href="#cb3-1114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-1115"><a href="#cb3-1115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-1116"><a href="#cb3-1116" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> trace41 <span class="op">=</span> {</span>
<span id="cb3-1117"><a href="#cb3-1117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-1118"><a href="#cb3-1118" aria-hidden="true" tabindex="-1"></a>  <span class="dt">type</span><span class="op">:</span> <span class="st">"scatter"</span><span class="op">,</span></span>
<span id="cb3-1119"><a href="#cb3-1119" aria-hidden="true" tabindex="-1"></a>  <span class="dt">name</span><span class="op">:</span> <span class="st">'Quantile2'</span><span class="op">,</span></span>
<span id="cb3-1120"><a href="#cb3-1120" aria-hidden="true" tabindex="-1"></a>  <span class="dt">fill</span><span class="op">:</span> <span class="st">'tozeroy'</span><span class="op">,</span></span>
<span id="cb3-1121"><a href="#cb3-1121" aria-hidden="true" tabindex="-1"></a>  <span class="dt">x</span> <span class="op">:</span> filteredX<span class="op">,</span></span>
<span id="cb3-1122"><a href="#cb3-1122" aria-hidden="true" tabindex="-1"></a>  <span class="dt">y</span> <span class="op">:</span> filteredPdf<span class="op">,</span></span>
<span id="cb3-1123"><a href="#cb3-1123" aria-hidden="true" tabindex="-1"></a>  <span class="dt">opacity</span><span class="op">:</span> <span class="fl">0.9</span><span class="op">,</span></span>
<span id="cb3-1124"><a href="#cb3-1124" aria-hidden="true" tabindex="-1"></a>  <span class="dt">line</span><span class="op">:</span> {<span class="dt">color</span><span class="op">:</span> <span class="st">' #428BCA'</span>}<span class="op">,</span></span>
<span id="cb3-1125"><a href="#cb3-1125" aria-hidden="true" tabindex="-1"></a>  <span class="dt">xaxis</span><span class="op">:</span> <span class="st">'x2'</span><span class="op">,</span></span>
<span id="cb3-1126"><a href="#cb3-1126" aria-hidden="true" tabindex="-1"></a>  <span class="dt">yaxis</span><span class="op">:</span> <span class="st">'y1'</span></span>
<span id="cb3-1127"><a href="#cb3-1127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-1128"><a href="#cb3-1128" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span>
<span id="cb3-1129"><a href="#cb3-1129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-1130"><a href="#cb3-1130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-1131"><a href="#cb3-1131" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> trace42 <span class="op">=</span> {</span>
<span id="cb3-1132"><a href="#cb3-1132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-1133"><a href="#cb3-1133" aria-hidden="true" tabindex="-1"></a>  <span class="dt">type</span><span class="op">:</span> <span class="st">"scatter"</span><span class="op">,</span></span>
<span id="cb3-1134"><a href="#cb3-1134" aria-hidden="true" tabindex="-1"></a>  <span class="dt">mode</span><span class="op">:</span> <span class="st">"lines"</span><span class="op">,</span></span>
<span id="cb3-1135"><a href="#cb3-1135" aria-hidden="true" tabindex="-1"></a>  <span class="dt">name</span><span class="op">:</span> <span class="st">'PDF2'</span><span class="op">,</span></span>
<span id="cb3-1136"><a href="#cb3-1136" aria-hidden="true" tabindex="-1"></a>  <span class="dt">x</span><span class="op">:</span> x<span class="op">,</span></span>
<span id="cb3-1137"><a href="#cb3-1137" aria-hidden="true" tabindex="-1"></a>  <span class="dt">y</span><span class="op">:</span> pdf<span class="op">,</span></span>
<span id="cb3-1138"><a href="#cb3-1138" aria-hidden="true" tabindex="-1"></a>  <span class="dt">line</span><span class="op">:</span> {<span class="dt">color</span><span class="op">:</span> <span class="st">'black'</span>}<span class="op">,</span></span>
<span id="cb3-1139"><a href="#cb3-1139" aria-hidden="true" tabindex="-1"></a>  <span class="dt">xaxis</span><span class="op">:</span> <span class="st">'x2'</span><span class="op">,</span></span>
<span id="cb3-1140"><a href="#cb3-1140" aria-hidden="true" tabindex="-1"></a>  <span class="dt">yaxis</span><span class="op">:</span> <span class="st">'y1'</span></span>
<span id="cb3-1141"><a href="#cb3-1141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-1142"><a href="#cb3-1142" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span>
<span id="cb3-1143"><a href="#cb3-1143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-1144"><a href="#cb3-1144" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> data <span class="op">=</span> [</span>
<span id="cb3-1145"><a href="#cb3-1145" aria-hidden="true" tabindex="-1"></a>  trace1<span class="op">,</span></span>
<span id="cb3-1146"><a href="#cb3-1146" aria-hidden="true" tabindex="-1"></a>  trace12<span class="op">,</span> trace13<span class="op">,</span></span>
<span id="cb3-1147"><a href="#cb3-1147" aria-hidden="true" tabindex="-1"></a>  trace2<span class="op">,</span> trace21<span class="op">,</span> trace22<span class="op">,</span> trace23<span class="op">,</span></span>
<span id="cb3-1148"><a href="#cb3-1148" aria-hidden="true" tabindex="-1"></a>  trace31<span class="op">,</span> trace32<span class="op">,</span> trace33<span class="op">,</span> trace34<span class="op">,</span></span>
<span id="cb3-1149"><a href="#cb3-1149" aria-hidden="true" tabindex="-1"></a>  trace41<span class="op">,</span> trace42]<span class="op">;</span></span>
<span id="cb3-1150"><a href="#cb3-1150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-1151"><a href="#cb3-1151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-1152"><a href="#cb3-1152" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> layout <span class="op">=</span> {</span>
<span id="cb3-1153"><a href="#cb3-1153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-1154"><a href="#cb3-1154" aria-hidden="true" tabindex="-1"></a>  <span class="dt">title</span><span class="op">:</span> <span class="st">'Distribution et quantile'</span><span class="op">,</span></span>
<span id="cb3-1155"><a href="#cb3-1155" aria-hidden="true" tabindex="-1"></a>  <span class="dt">xaxis</span><span class="op">:</span> {</span>
<span id="cb3-1156"><a href="#cb3-1156" aria-hidden="true" tabindex="-1"></a>    <span class="dt">domain</span><span class="op">:</span> [<span class="dv">0</span><span class="op">,</span> <span class="fl">0.32</span>]<span class="op">,</span></span>
<span id="cb3-1157"><a href="#cb3-1157" aria-hidden="true" tabindex="-1"></a>    <span class="dt">anchor</span><span class="op">:</span> <span class="st">'y1'</span></span>
<span id="cb3-1158"><a href="#cb3-1158" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb3-1159"><a href="#cb3-1159" aria-hidden="true" tabindex="-1"></a>  <span class="dt">yaxis</span><span class="op">:</span> {</span>
<span id="cb3-1160"><a href="#cb3-1160" aria-hidden="true" tabindex="-1"></a>    <span class="dt">domain</span><span class="op">:</span> [<span class="dv">0</span><span class="op">,</span> <span class="fl">0.24</span>]<span class="op">,</span></span>
<span id="cb3-1161"><a href="#cb3-1161" aria-hidden="true" tabindex="-1"></a>    <span class="dt">anchor</span><span class="op">:</span> <span class="st">'x1'</span></span>
<span id="cb3-1162"><a href="#cb3-1162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-1163"><a href="#cb3-1163" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb3-1164"><a href="#cb3-1164" aria-hidden="true" tabindex="-1"></a>  <span class="dt">xaxis2</span><span class="op">:</span> {</span>
<span id="cb3-1165"><a href="#cb3-1165" aria-hidden="true" tabindex="-1"></a>    <span class="dt">domain</span><span class="op">:</span> [<span class="fl">0.35</span><span class="op">,</span> <span class="dv">1</span>]<span class="op">,</span></span>
<span id="cb3-1166"><a href="#cb3-1166" aria-hidden="true" tabindex="-1"></a>    <span class="dt">anchor</span><span class="op">:</span> <span class="st">'y'</span></span>
<span id="cb3-1167"><a href="#cb3-1167" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb3-1168"><a href="#cb3-1168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-1169"><a href="#cb3-1169" aria-hidden="true" tabindex="-1"></a>  <span class="dt">yaxis2</span><span class="op">:</span> {</span>
<span id="cb3-1170"><a href="#cb3-1170" aria-hidden="true" tabindex="-1"></a>    <span class="dt">domain</span><span class="op">:</span> [<span class="fl">0.26</span><span class="op">,</span> <span class="fl">0.49</span>]<span class="op">,</span></span>
<span id="cb3-1171"><a href="#cb3-1171" aria-hidden="true" tabindex="-1"></a>    <span class="dt">anchor</span><span class="op">:</span> <span class="st">'x1'</span></span>
<span id="cb3-1172"><a href="#cb3-1172" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb3-1173"><a href="#cb3-1173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-1174"><a href="#cb3-1174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-1175"><a href="#cb3-1175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-1176"><a href="#cb3-1176" aria-hidden="true" tabindex="-1"></a>  <span class="dt">yaxis3</span><span class="op">:</span> {</span>
<span id="cb3-1177"><a href="#cb3-1177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-1178"><a href="#cb3-1178" aria-hidden="true" tabindex="-1"></a>    <span class="dt">domain</span><span class="op">:</span> [<span class="fl">0.5</span><span class="op">,</span> <span class="dv">1</span>]<span class="op">,</span></span>
<span id="cb3-1179"><a href="#cb3-1179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-1180"><a href="#cb3-1180" aria-hidden="true" tabindex="-1"></a>    <span class="dt">anchor</span><span class="op">:</span> <span class="st">'x1'</span></span>
<span id="cb3-1181"><a href="#cb3-1181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-1182"><a href="#cb3-1182" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb3-1183"><a href="#cb3-1183" aria-hidden="true" tabindex="-1"></a>  <span class="dt">height</span><span class="op">:</span> <span class="dv">640</span><span class="op">,</span></span>
<span id="cb3-1184"><a href="#cb3-1184" aria-hidden="true" tabindex="-1"></a>   <span class="dt">width</span><span class="op">:</span> <span class="dv">480</span><span class="op">,</span></span>
<span id="cb3-1185"><a href="#cb3-1185" aria-hidden="true" tabindex="-1"></a><span class="co">// legend off</span></span>
<span id="cb3-1186"><a href="#cb3-1186" aria-hidden="true" tabindex="-1"></a>  <span class="dt">showlegend</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span></span>
<span id="cb3-1187"><a href="#cb3-1187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-1188"><a href="#cb3-1188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-1189"><a href="#cb3-1189" aria-hidden="true" tabindex="-1"></a>  <span class="dt">annotations</span><span class="op">:</span> [</span>
<span id="cb3-1190"><a href="#cb3-1190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-1191"><a href="#cb3-1191" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb3-1192"><a href="#cb3-1192" aria-hidden="true" tabindex="-1"></a>      <span class="dt">x</span><span class="op">:</span> <span class="dv">1</span><span class="op">/</span><span class="dv">4</span><span class="op">,</span></span>
<span id="cb3-1193"><a href="#cb3-1193" aria-hidden="true" tabindex="-1"></a>      <span class="dt">y</span><span class="op">:</span> quantile <span class="op">-</span> (x[<span class="dv">0</span>]<span class="op">-</span>x<span class="op">.</span><span class="fu">slice</span>(<span class="op">-</span><span class="dv">1</span>))<span class="op">/</span><span class="dv">20</span><span class="op">,</span></span>
<span id="cb3-1194"><a href="#cb3-1194" aria-hidden="true" tabindex="-1"></a>      <span class="dt">xref</span><span class="op">:</span> <span class="st">'x1'</span><span class="op">,</span></span>
<span id="cb3-1195"><a href="#cb3-1195" aria-hidden="true" tabindex="-1"></a>      <span class="dt">yref</span><span class="op">:</span> <span class="st">'y3'</span><span class="op">,</span></span>
<span id="cb3-1196"><a href="#cb3-1196" aria-hidden="true" tabindex="-1"></a>      <span class="dt">text</span><span class="op">:</span> <span class="st">'q= '</span> <span class="op">+</span> quantile<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">2</span>)<span class="op">,</span></span>
<span id="cb3-1197"><a href="#cb3-1197" aria-hidden="true" tabindex="-1"></a>      <span class="dt">font</span><span class="op">:</span> {</span>
<span id="cb3-1198"><a href="#cb3-1198" aria-hidden="true" tabindex="-1"></a>        <span class="dt">size</span><span class="op">:</span> <span class="dv">12</span><span class="op">,</span></span>
<span id="cb3-1199"><a href="#cb3-1199" aria-hidden="true" tabindex="-1"></a>        <span class="dt">color</span><span class="op">:</span> <span class="st">'#428BCA'</span><span class="op">,</span></span>
<span id="cb3-1200"><a href="#cb3-1200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-1201"><a href="#cb3-1201" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb3-1202"><a href="#cb3-1202" aria-hidden="true" tabindex="-1"></a>      <span class="dt">showarrow</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span></span>
<span id="cb3-1203"><a href="#cb3-1203" aria-hidden="true" tabindex="-1"></a>      <span class="dt">arrowhead</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb3-1204"><a href="#cb3-1204" aria-hidden="true" tabindex="-1"></a>      <span class="dt">ax</span><span class="op">:</span> <span class="dv">25</span><span class="op">,</span></span>
<span id="cb3-1205"><a href="#cb3-1205" aria-hidden="true" tabindex="-1"></a>      <span class="dt">ay</span><span class="op">:</span> <span class="op">-</span><span class="dv">10</span><span class="op">,</span></span>
<span id="cb3-1206"><a href="#cb3-1206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-1207"><a href="#cb3-1207" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb3-1208"><a href="#cb3-1208" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb3-1209"><a href="#cb3-1209" aria-hidden="true" tabindex="-1"></a>        <span class="dt">text</span><span class="op">:</span> <span class="st">"Fonction quantile"</span><span class="op">,</span></span>
<span id="cb3-1210"><a href="#cb3-1210" aria-hidden="true" tabindex="-1"></a>      <span class="dt">font</span><span class="op">:</span> {</span>
<span id="cb3-1211"><a href="#cb3-1211" aria-hidden="true" tabindex="-1"></a>      <span class="dt">size</span><span class="op">:</span> <span class="dv">15</span><span class="op">,</span></span>
<span id="cb3-1212"><a href="#cb3-1212" aria-hidden="true" tabindex="-1"></a>      <span class="dt">color</span><span class="op">:</span> <span class="st">'black'</span><span class="op">,</span></span>
<span id="cb3-1213"><a href="#cb3-1213" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb3-1214"><a href="#cb3-1214" aria-hidden="true" tabindex="-1"></a>    <span class="dt">showarrow</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span></span>
<span id="cb3-1215"><a href="#cb3-1215" aria-hidden="true" tabindex="-1"></a>    <span class="dt">align</span><span class="op">:</span> <span class="st">'center'</span><span class="op">,</span></span>
<span id="cb3-1216"><a href="#cb3-1216" aria-hidden="true" tabindex="-1"></a>    <span class="dt">x</span><span class="op">:</span> <span class="op">-</span><span class="fl">0.01</span><span class="op">,</span></span>
<span id="cb3-1217"><a href="#cb3-1217" aria-hidden="true" tabindex="-1"></a>    <span class="dt">y</span><span class="op">:</span> <span class="fl">1.05</span><span class="op">,</span></span>
<span id="cb3-1218"><a href="#cb3-1218" aria-hidden="true" tabindex="-1"></a>    <span class="dt">xref</span><span class="op">:</span> <span class="st">'paper'</span><span class="op">,</span></span>
<span id="cb3-1219"><a href="#cb3-1219" aria-hidden="true" tabindex="-1"></a>    <span class="dt">yref</span><span class="op">:</span> <span class="st">'paper'</span><span class="op">,</span></span>
<span id="cb3-1220"><a href="#cb3-1220" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb3-1221"><a href="#cb3-1221" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb3-1222"><a href="#cb3-1222" aria-hidden="true" tabindex="-1"></a>      <span class="dt">text</span><span class="op">:</span> <span class="st">"Fonction de r√©partition"</span><span class="op">,</span></span>
<span id="cb3-1223"><a href="#cb3-1223" aria-hidden="true" tabindex="-1"></a>      <span class="dt">font</span><span class="op">:</span> {</span>
<span id="cb3-1224"><a href="#cb3-1224" aria-hidden="true" tabindex="-1"></a>      <span class="dt">size</span><span class="op">:</span> <span class="dv">15</span><span class="op">,</span></span>
<span id="cb3-1225"><a href="#cb3-1225" aria-hidden="true" tabindex="-1"></a>      <span class="dt">color</span><span class="op">:</span> <span class="st">'black'</span><span class="op">,</span></span>
<span id="cb3-1226"><a href="#cb3-1226" aria-hidden="true" tabindex="-1"></a>            }<span class="op">,</span></span>
<span id="cb3-1227"><a href="#cb3-1227" aria-hidden="true" tabindex="-1"></a>    <span class="dt">showarrow</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span></span>
<span id="cb3-1228"><a href="#cb3-1228" aria-hidden="true" tabindex="-1"></a>    <span class="dt">align</span><span class="op">:</span> <span class="st">'center'</span><span class="op">,</span></span>
<span id="cb3-1229"><a href="#cb3-1229" aria-hidden="true" tabindex="-1"></a>    <span class="dt">x</span><span class="op">:</span> <span class="fl">0.65</span><span class="op">,</span></span>
<span id="cb3-1230"><a href="#cb3-1230" aria-hidden="true" tabindex="-1"></a>    <span class="dt">y</span><span class="op">:</span> <span class="fl">0.52</span><span class="op">,</span></span>
<span id="cb3-1231"><a href="#cb3-1231" aria-hidden="true" tabindex="-1"></a>    <span class="dt">xref</span><span class="op">:</span> <span class="st">'paper'</span><span class="op">,</span></span>
<span id="cb3-1232"><a href="#cb3-1232" aria-hidden="true" tabindex="-1"></a>    <span class="dt">yref</span><span class="op">:</span> <span class="st">'paper'</span><span class="op">,</span></span>
<span id="cb3-1233"><a href="#cb3-1233" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb3-1234"><a href="#cb3-1234" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb3-1235"><a href="#cb3-1235" aria-hidden="true" tabindex="-1"></a>      <span class="dt">text</span><span class="op">:</span> <span class="st">"Fonction de densit√©"</span><span class="op">,</span></span>
<span id="cb3-1236"><a href="#cb3-1236" aria-hidden="true" tabindex="-1"></a>      <span class="dt">font</span><span class="op">:</span> {</span>
<span id="cb3-1237"><a href="#cb3-1237" aria-hidden="true" tabindex="-1"></a>      <span class="dt">size</span><span class="op">:</span> <span class="dv">15</span><span class="op">,</span></span>
<span id="cb3-1238"><a href="#cb3-1238" aria-hidden="true" tabindex="-1"></a>      <span class="dt">color</span><span class="op">:</span> <span class="st">'black'</span><span class="op">,</span></span>
<span id="cb3-1239"><a href="#cb3-1239" aria-hidden="true" tabindex="-1"></a>            }<span class="op">,</span></span>
<span id="cb3-1240"><a href="#cb3-1240" aria-hidden="true" tabindex="-1"></a>    <span class="dt">showarrow</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span></span>
<span id="cb3-1241"><a href="#cb3-1241" aria-hidden="true" tabindex="-1"></a>    <span class="dt">align</span><span class="op">:</span> <span class="st">'center'</span><span class="op">,</span></span>
<span id="cb3-1242"><a href="#cb3-1242" aria-hidden="true" tabindex="-1"></a>    <span class="dt">x</span><span class="op">:</span> <span class="fl">0.65</span><span class="op">,</span></span>
<span id="cb3-1243"><a href="#cb3-1243" aria-hidden="true" tabindex="-1"></a>    <span class="dt">y</span><span class="op">:</span> <span class="fl">0.225</span><span class="op">,</span></span>
<span id="cb3-1244"><a href="#cb3-1244" aria-hidden="true" tabindex="-1"></a>    <span class="dt">xref</span><span class="op">:</span> <span class="st">'paper'</span><span class="op">,</span></span>
<span id="cb3-1245"><a href="#cb3-1245" aria-hidden="true" tabindex="-1"></a>    <span class="dt">yref</span><span class="op">:</span> <span class="st">'paper'</span><span class="op">,</span></span>
<span id="cb3-1246"><a href="#cb3-1246" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb3-1247"><a href="#cb3-1247" aria-hidden="true" tabindex="-1"></a>  ]</span>
<span id="cb3-1248"><a href="#cb3-1248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-1249"><a href="#cb3-1249" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span>
<span id="cb3-1250"><a href="#cb3-1250" aria-hidden="true" tabindex="-1"></a><span class="co">// XXX: </span><span class="al">TODO</span><span class="co">: put the xticks labels on the middle plot for x and on the right plot for y</span></span>
<span id="cb3-1251"><a href="#cb3-1251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-1252"><a href="#cb3-1252" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> div <span class="op">=</span> DOM<span class="op">.</span><span class="fu">element</span>(<span class="st">'div'</span>)<span class="op">;</span></span>
<span id="cb3-1253"><a href="#cb3-1253" aria-hidden="true" tabindex="-1"></a>    Plotly<span class="op">.</span><span class="fu">newPlot</span>(div<span class="op">,</span> data<span class="op">,</span> layout)<span class="op">;</span></span>
<span id="cb3-1254"><a href="#cb3-1254" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> div<span class="op">;</span></span>
<span id="cb3-1255"><a href="#cb3-1255" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-1256"><a href="#cb3-1256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-1257"><a href="#cb3-1257" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-4" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-5" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-6" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-7" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-8" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-9" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-10" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-11" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-12" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-13" data-nodetype="expression">

</div>
</div>
</div>
<div class="sourceCode cell-code hidden" id="cb4" data-startfrom="1259" data-source-offset="-7164"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1258;"><span id="cb4-1259"><a href="#cb4-1259" aria-hidden="true" tabindex="-1"></a>mu <span class="op">=</span> inputs[<span class="dv">0</span>]<span class="op">;</span></span>
<span id="cb4-1260"><a href="#cb4-1260" aria-hidden="true" tabindex="-1"></a>sigma <span class="op">=</span> inputs[<span class="dv">1</span>]<span class="op">;</span></span>
<span id="cb4-1261"><a href="#cb4-1261" aria-hidden="true" tabindex="-1"></a>alpha <span class="op">=</span> inputs[<span class="dv">2</span>]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-14" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-15" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-16" data-nodetype="declaration">

</div>
</div>
</div>
</div>


</section>
</section>


<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Retour au sommet</a></main> <!-- /main -->
<script type="ojs-module-contents">
{"contents":[{"methodName":"interpret","cellName":"ojs-cell-1","inline":false,"source":"// Plotly = require(\"https://cdn.plot.ly/plotly-latest.min.js\")\nPlotly = require('plotly.js-dist');\njstat = require('jstat');\n\nfunction laplacecdf(x, mu, b){\n  if (x <= mu){\n      var cdf = 0.5*Math.exp((x-mu)/b)\n  }else{\n      var cdf = 1 - 0.5*Math.exp(-(x-mu)/b)\n  }\n  return cdf\n}\n\nfunction laplacepdf(x,mu,b){\n  return (1/(2*b))*Math.exp(- Math.abs((x-mu)/b) )\n}\n\nfunction laplaceinv(p,mu,b){\n  return mu - b*Math.sign(p-0.5)*Math.log(1- Math.abs(p-0.5))\n}\n\n\njstatPDFs = () => {\n  const distributions = Object.keys(jstat);\n  const continuousDistributions = distributions.filter(name => jstat[name].pdf && jstat[name].cdf && jstat[name].inv);\n  const pdfs = {};\n  const cdfs = {};\n  const invs = {};\n\n  for (const name of continuousDistributions) {\n    // if (name == 'laplace') {\n        // cdfs[name] = (p, mu, b) => laplacecdf(p, mu, b);\n        // pdfs[name] = (p, mu, b) => laplacepdf(p, mu, b);\n        // invs[name] = (p, mu, b) => laplaceinv(p, mu, b);\n        // }\n    // else{\n    pdfs[name] = jstat[name].pdf;\n    cdfs[name] = jstat[name].cdf;\n    invs[name] = jstat[name].inv;\n    // }\n  }\n  return {pdf:pdfs, cdf:cdfs, inv:invs};\n};\noutput = jstatPDFs();\n\n\nexcludedPDFs = ['binomial', 'negbin', 'poisson'];\npdfNames_unsorted = Object.keys(output.pdf).filter(name => !excludedPDFs.includes(name));\npdfNames=pdfNames_unsorted.toSorted();\nviewof inputs = Inputs.form([\n      Inputs.range([-10, 10], {value: 0.1, step: 0.001, label: tex`\\mu`}),\n      Inputs.range([0.01, 5], {value: 1.01, step: 0.001, label: tex`\\sigma`}),\n      Inputs.range([0.001, 0.999], {value: 0.75, step: 0.001, label:tex`\\alpha`}),\n    ]);\n\nviewof distrib_name = Inputs.select(pdfNames, {value: \"normal\", label: \"Distribution\"});\n\n\n{\n  const x = d3.range(-5, 5, 0.01);\n  const pdf = x.map(x => jstat[distrib_name].pdf(x, mu, sigma));\n  const cdf = x.map(x => jstat[distrib_name].cdf(x, mu, sigma));\n  const inv = x.map(x => jstat[distrib_name].inv(x, mu, sigma));\n  const quantile = jstat[distrib_name].inv(alpha, mu, sigma);\n  const filteredX = x.filter(coord => coord <= quantile);\n  const filteredPdf = pdf.filter((_, i) => x[i] <= quantile);\n  const filteredCdf = cdf.filter(coord => coord <= quantile);\n\n\n{\nvar trace1 = {\n      type: \"scatter\",\n      name: 'Quantile',\n      x : cdf,\n      y : x,\n      line: {color: 'black'},\n      xaxis: 'x1',\n      yaxis: 'y3',\n\n\n};\n\nvar trace12 = {\n        x : [alpha, alpha],\n        y : [x[0], quantile],\n        mode: 'lines',\n        line: {\n            dash: 'dash',\n            width: 1,\n            color: ' #428BCA',\n            marks: {\n                size: 0,\n                color: ' #428BCA',\n            }\n\n          },\n      xaxis: 'x1',\n      yaxis: 'y3',\n\n\n};\n\n\n\nvar trace13 = {\n    x: [0, alpha],\n    y: [quantile, quantile],\n    mode: 'scatter',\n    line: {\n        dash: 'dash',\n        width: 1,\n        color: ' #428BCA',\n        marks: {\n            size: 0,\n        }\n    },\n    xaxis: 'x1',\n    yaxis: 'y3'\n}\n\n\nvar trace2 = {\nx: cdf,\ny: cdf,\ntype: 'scatter',\nname: 'identity',\nline: {color: 'black'},\nxaxis: 'x1',\nyaxis: 'y2'\n\n};\n\n\nvar trace21 = {\n        x : [alpha, 1],\n        y : [alpha, alpha],\n        mode: 'lines',\n        line: {\n            dash: 'dash',\n            width: 1,\n            color: ' #428BCA',\n            marks: {\n                size: 0,\n                color: ' #428BCA',\n            }\n\n          },\n      xaxis: 'x1',\n      yaxis: 'y2'\n}\n\nvar trace22 = {\n        x : [alpha, alpha],\n        y : [alpha, 1],\n        mode: 'lines',\n        line: {\n            dash: 'dash',\n            width: 1,\n            color: ' #428BCA',\n            marks: {\n                size: 0,\n                color: ' #428BCA',\n            }\n\n          },\n      xaxis: 'x1',\n      yaxis: 'y2'\n}\n\nvar trace23 = {\n    x: [alpha],\n    y: [alpha],\n    mode: 'scatter',\n    line: {\n        dash: 'dash',\n        width: 1,\n        color: ' #428BCA',\n        marks: {\n            size: 0,\n        }\n    },\n    xaxis: 'x1',\n    yaxis: 'y2'\n}\n\n\nvar trace31 = {\n      type: \"scatter\",\n      mode: \"lines\",\n      name: 'PDF2',\n      x: x,\n      y: cdf,\n      line: {color: 'black'},\n      xaxis: 'x2',\n      yaxis: 'y2',\n};\n\nvar trace32 = {\n        x : filteredX,\n        y : filteredX.map(x => alpha),\n        mode: 'lines',\n        line: {\n            dash: 'dash',\n            width: 1,\n            color: ' #428BCA',\n            marks: {\n                size: 0,\n                color: ' #428BCA',\n            }\n          },\n      xaxis: 'x2',\n      yaxis: 'y2'\n}\n\nvar trace33 = {\n        x : [quantile, quantile],\n        y : [0, alpha],\n        mode: 'lines',\n        line: {\n            dash: 'dash',\n            width: 1,\n            color: ' #428BCA',\n            marks: {\n                size: 0,\n                color: ' #428BCA',\n            }\n          },\n\n      xaxis: 'x2',\n      yaxis: 'y2'\n}\n\nvar trace34 = {\n    x: [quantile],\n    y: [alpha],\n    mode: 'scatter',\n    line: {\n        dash: 'dash',\n        width: 1,\n        color: ' #428BCA',\n        marks: {\n            size: 0,\n        }\n    },\n    xaxis: 'x2',\n    yaxis: 'y2'\n}\n\n\nvar trace41 = {\n\n  type: \"scatter\",\n  name: 'Quantile2',\n  fill: 'tozeroy',\n  x : filteredX,\n  y : filteredPdf,\n  opacity: 0.9,\n  line: {color: ' #428BCA'},\n  xaxis: 'x2',\n  yaxis: 'y1'\n\n};\n\n\nvar trace42 = {\n\n  type: \"scatter\",\n  mode: \"lines\",\n  name: 'PDF2',\n  x: x,\n  y: pdf,\n  line: {color: 'black'},\n  xaxis: 'x2',\n  yaxis: 'y1'\n\n};\n\nvar data = [\n  trace1,\n  trace12, trace13,\n  trace2, trace21, trace22, trace23,\n  trace31, trace32, trace33, trace34,\n  trace41, trace42];\n\n\nvar layout = {\n\n  title: 'Distribution et quantile',\n  xaxis: {\n    domain: [0, 0.32],\n    anchor: 'y1'\n  },\n  yaxis: {\n    domain: [0, 0.24],\n    anchor: 'x1'\n\n  },\n  xaxis2: {\n    domain: [0.35, 1],\n    anchor: 'y'\n  },\n\n  yaxis2: {\n    domain: [0.26, 0.49],\n    anchor: 'x1'\n  },\n\n\n\n  yaxis3: {\n\n    domain: [0.5, 1],\n\n    anchor: 'x1'\n\n  },\n  height: 640,\n   width: 480,\n// legend off\n  showlegend: false,\n\n\n  annotations: [\n\n    {\n      x: 1/4,\n      y: quantile - (x[0]-x.slice(-1))/20,\n      xref: 'x1',\n      yref: 'y3',\n      text: 'q= ' + quantile.toFixed(2),\n      font: {\n        size: 12,\n        color: '#428BCA',\n\n      },\n      showarrow: false,\n      arrowhead: 0,\n      ax: 25,\n      ay: -10,\n\n    },\n    {\n        text: \"Fonction quantile\",\n      font: {\n      size: 15,\n      color: 'black',\n    },\n    showarrow: false,\n    align: 'center',\n    x: -0.01,\n    y: 1.05,\n    xref: 'paper',\n    yref: 'paper',\n    },\n    {\n      text: \"Fonction de r√©partition\",\n      font: {\n      size: 15,\n      color: 'black',\n            },\n    showarrow: false,\n    align: 'center',\n    x: 0.65,\n    y: 0.52,\n    xref: 'paper',\n    yref: 'paper',\n    },\n    {\n      text: \"Fonction de densit√©\",\n      font: {\n      size: 15,\n      color: 'black',\n            },\n    showarrow: false,\n    align: 'center',\n    x: 0.65,\n    y: 0.225,\n    xref: 'paper',\n    yref: 'paper',\n    },\n  ]\n\n};\n// XXX: TODO: put the xticks labels on the middle plot for x and on the right plot for y\n\n    const div = DOM.element('div');\n    Plotly.newPlot(div, data, layout);\n    return div;\n  }\n\n}\n\nmu = inputs[0];\nsigma = inputs[1];\nalpha = inputs[2]\n\n\n"},{"methodName":"interpretQuiet","source":"shinyInput('inputs')"},{"methodName":"interpretQuiet","source":"shinyInput('distrib_name')"}]}
</script>
<script type="module">
if (window.location.protocol === "file:") { alert("The OJS runtime does not work with file:// URLs. Please use a web server to view this document."); }
window._ojs.paths.runtimeToDoc = "../../Courses";
window._ojs.paths.runtimeToRoot = "../..";
window._ojs.paths.docToRoot = "..";
window._ojs.selfContained = false;
window._ojs.runtime.interpretFromScriptTags();
</script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "Óßã";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copi√©");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copi√©");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    const typesetMath = (el) => {
      if (window.MathJax) {
        // MathJax Typeset
        window.MathJax.typeset([el]);
      } else if (window.katex) {
        // KaTeX Render
        var mathElements = el.getElementsByClassName("math");
        var macros = [];
        for (var i = 0; i < mathElements.length; i++) {
          var texText = mathElements[i].firstChild;
          if (mathElements[i].tagName == "SPAN") {
            window.katex.render(texText.data, mathElements[i], {
              displayMode: mathElements[i].classList.contains('display'),
              throwOnError: false,
              macros: macros,
              fleqn: false
            });
          }
        }
      }
    }
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        for (let i = 0; i < 2; i++) {
          container.appendChild(note.children[i].cloneNode(true));
        }
        typesetMath(container);
        return container.innerHTML
      } else {
        typesetMath(note);
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      typesetMath(note);
      return note.innerHTML;
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
  </div>
  <div class="nav-page nav-page-next">
      <a href="../Courses/th_asymptotique.html" class="pagination-link" aria-label="Th√©or√®mes asymptotiques">
        <span class="nav-page-text">Th√©or√®mes asymptotiques</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>