<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="fr" xml:lang="fr"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.549">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>HAX603X: Modélisation stochastique - Marches aléatoires</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../Courses/monte_carlo.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Pas de résultats",
    "search-matching-documents-text": "documents trouvés",
    "search-copy-link-title": "Copier le lien vers la recherche",
    "search-hide-matches-text": "Cacher les correspondances additionnelles",
    "search-more-match-text": "correspondance de plus dans ce document",
    "search-more-matches-text": "correspondances de plus dans ce document",
    "search-clear-button-title": "Effacer",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Annuler",
    "search-submit-button-title": "Envoyer",
    "search-label": "Recherche"
  }
}</script>
<script type="module" src="../site_libs/quarto-ojs/quarto-ojs-runtime.js"></script>
<link href="../site_libs/quarto-ojs/quarto-ojs.css" rel="stylesheet">

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css">

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../custom.css">
</head>

<body class="nav-sidebar floating nav-fixed slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">HAX603X</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Recherche"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Basculer la navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-cours" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Cours</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-cours">    
        <li>
    <a class="dropdown-item" href="../Courses/perspective_historique.html">
 <span class="dropdown-text">Perspectives historiques</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Courses/notations.html">
 <span class="dropdown-text">Notations et rappels</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Courses/th_asymptotique.html">
 <span class="dropdown-text">Théorèmes asymptotiques</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Courses/simulation.html">
 <span class="dropdown-text">Simulation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Courses/loi_normale1D.html">
 <span class="dropdown-text">Loi normale: cas univarié</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Courses/loi_normale_multi.html">
 <span class="dropdown-text">Loi normale: cas multivarié</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Courses/monte_carlo.html">
 <span class="dropdown-text">Méthode de Monte Carlo</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Courses/marche_aleatoire.html">
 <span class="dropdown-text">Marches aléatoires</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-slides" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Slides</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-slides">    
        <li>
    <a class="dropdown-item" href="../Courses/slides.html">
 <span class="dropdown-text">Slides: menu principal</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Slides/slides_intro.html">
 <span class="dropdown-text">Introduction</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Slides/slides_notations_premiers_pas.html">
 <span class="dropdown-text">Notations et premiers pas</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Slides/slides_th_asymptotique.html">
 <span class="dropdown-text">Théorèmes asymptotiques</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Slides/slides_simulation.html">
 <span class="dropdown-text">Simulation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Slides/slides_loi_normale1D.html">
 <span class="dropdown-text">Loi normale: cas univarié</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Slides/slides_loi_normale_multi.html">
 <span class="dropdown-text">Loi normale: cas multivarié</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-tp" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">TP</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-tp">    
        <li class="dropdown-header">TP</li>
        <li>
    <a class="dropdown-item" href="../TP/TP1.html">
 <span class="dropdown-text">TP1: Prise en main de Python</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../TP/TP2.html">
 <span class="dropdown-text">TP2: Simulation de lois élémentaires</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../TP/TP3.html">
 <span class="dropdown-text">TP3: Simulation de variables aléatoires</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../TP/TP5.html">
 <span class="dropdown-text">TP5: Méthode de Monte-Carlo</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Quarto</li>
        <li>
    <a class="dropdown-item" href="../TP/markdown.html">
 <span class="dropdown-text">Démarrage en Markdown</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../TP/quarto.html">
 <span class="dropdown-text">Démarrage en Quarto</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-td" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">TD</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-td">    
        <li>
    <a class="dropdown-item" href="../TD/TD.html">
 <span class="dropdown-text">Travaux Dirigés (TD)</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
    <a href="https://github.com/josephsalmon/HAX603X" title="GitHub" class="quarto-navigation-tool px-1" aria-label="GitHub"><i class="bi bi-github"></i></a>
    <a href="https://moodle.umontpellier.fr/course/view.php?id=25763" title="Moodle" class="quarto-navigation-tool px-1" aria-label="Moodle"><i class="bi bi-bicycle"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Basculer la barre latérale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../Courses/marche_aleatoire.html">Marches aléatoires</a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Basculer la barre latérale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Courses/perspective_historique.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Perspectives historiques</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Courses/notations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Notations et rappels</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Courses/th_asymptotique.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Théorèmes asymptotiques</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Courses/simulation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Simulation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Courses/loi_normale1D.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Loi normale: cas univarié</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Courses/loi_normale_multi.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Loi normale: cas multivarié</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Courses/monte_carlo.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Méthode de Monte Carlo</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Courses/marche_aleatoire.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Marches aléatoires</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Sur cette page</h2>
   
  <ul>
  <li><a href="#sec-chap03-traj" id="toc-sec-chap03-traj" class="nav-link active" data-scroll-target="#sec-chap03-traj">Trajectoires de la marche aléatoire</a>
  <ul class="collapse">
  <li><a href="#sec-chap03-defi" id="toc-sec-chap03-defi" class="nav-link" data-scroll-target="#sec-chap03-defi">Définition</a></li>
  <li><a href="#sec-chap03-graphe" id="toc-sec-chap03-graphe" class="nav-link" data-scroll-target="#sec-chap03-graphe">Représentation graphique</a></li>
  <li><a href="#sec-chap03-reflex" id="toc-sec-chap03-reflex" class="nav-link" data-scroll-target="#sec-chap03-reflex">Principe de réflexion</a></li>
  </ul></li>
  <li><a href="#sec-chap03-infini" id="toc-sec-chap03-infini" class="nav-link" data-scroll-target="#sec-chap03-infini">Comportement asymptotique</a>
  <ul class="collapse">
  <li><a href="#sec-chap03-markov" id="toc-sec-chap03-markov" class="nav-link" data-scroll-target="#sec-chap03-markov">Propriété de Markov et stationnarité</a></li>
  <li><a href="#sec-chap03-retour" id="toc-sec-chap03-retour" class="nav-link" data-scroll-target="#sec-chap03-retour">Premier retour en <span class="math inline">0</span></a></li>
  <li><a href="#sec-chap03-passage" id="toc-sec-chap03-passage" class="nav-link" data-scroll-target="#sec-chap03-passage">Premier passage en <span class="math inline">a\neq 0</span></a></li>
  </ul></li>
  <li><a href="#sec-chap03-ruine" id="toc-sec-chap03-ruine" class="nav-link" data-scroll-target="#sec-chap03-ruine">La ruine de la joueuse</a></li>
  <li><a href="#sec-chap03-MB" id="toc-sec-chap03-MB" class="nav-link" data-scroll-target="#sec-chap03-MB">De la marche aléatoire vers le mouvement brownien</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/josephsalmon/HAX603X/blob/main/Courses/marche_aleatoire.qmd" class="toc-action"><i class="bi bi-github"></i>Voir la source</a></li><li><a href="https://github.com/josephsalmon/HAX603X/issues/new" class="toc-action"><i class="bi empty"></i>Faire part d'un problème</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Marches aléatoires</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="hidden">
{{
% variance % covariance
<p>}}</p>
</div>
<p>L’objet de ce chapitre est de faire une première introduction à un exemple intéressant de processus stochastique, soit la marche aléatoire simple symétrique, et ce avec un minimum de formalisme.</p>
<p>Dans la partie <a href="#sec-chap03-traj" class="quarto-xref">Section&nbsp;1</a>, on définit la marche aléatoire simple symétrique, et on étudie l’allure de ses trajectoires. La partie <a href="#sec-chap03-infini" class="quarto-xref">Section&nbsp;2</a> est dédiée à son comportement en temps long. La partie <a href="#sec-chap03-ruine" class="quarto-xref">Section&nbsp;3</a> présente une première application vers les mathématiques financières avec l’étude d’un problème de ruine.</p>
<section id="sec-chap03-traj" class="level2">
<h2 class="anchored" data-anchor-id="sec-chap03-traj">Trajectoires de la marche aléatoire</h2>
<p>Un <em>processus stochastique</em> est une suite de variables aléatoires indexée par le temps. Il permet de modéliser l’évolution temporelle d’un phénomène comme la richesse d’une joueuse ou la valeur d’un portefeuille d’actions par exemple. La marche aléatoire simple symétrique est le modèle le plus simple de processus à temps discret.</p>
<p>Dans toute la suite, on se place sur un espace probabilisé <span class="math inline">(\Omega, \mathcal{F}, \mathbb{P})</span>.</p>
<section id="sec-chap03-defi" class="level3">
<h3 class="anchored" data-anchor-id="sec-chap03-defi">Définition</h3>
<p>Commençons par définir la marche aléatoire simple symétrique.</p>
<div id="def-marche" class="theorem definition">
<p><span class="theorem-title"><strong>Définition 1</strong></span> Une <strong>marche aléatoire simple symétrique</strong> sur <span class="math inline">\mathbb{Z}</span> est une suite <span class="math inline">(S_n)_{n\in\mathbb{N}}</span> de variables aléatoires telles que</p>
<ol type="1">
<li><span class="math inline">S_0=x\in\mathbb{Z}</span> est déterministe,</li>
<li><span class="math inline">S_{n+1}=S_n+X_{n+1}</span> pour tout <span class="math inline">n\in\mathbb{N}</span>,</li>
</ol>
<p>où <span class="math inline">(X_n)_{n\geq 1}</span> est une suite de variables aléatoires indépendantes et de même loi de Rademacher de paramètre <span class="math inline">\frac 1 2</span> : <span class="math display">
\mathbb{P}(X_1=-1)=\mathbb{P}(X_1=1)=\frac{1}{2}.
</span></p>
</div>
<p>On parle de <em>marche</em> car ce processus peut représenter la position d’une personne qui se déplace en ligne droite par pas d’une unité avec équiprobabilité d’aller vers l’avant (<span class="math inline">+1</span>) ou vers l’arrière (<span class="math inline">-1</span>). Cette marche est dite <em>simple</em> car on ne fait que des pas d’amplitude <span class="math inline">1</span> et <em>symétrique</em> car il y a la même probabilité de tirer <span class="math inline">1</span> et <span class="math inline">-1</span> pour chaque incrément.</p>
<p>Ce processus peut également servir à modéliser la richesse d’une joueuse qui joue à pile ou face avec une pièce équilibrée. Partant d’une richesse initiale <span class="math inline">S_0=x&gt;0</span>, à chaque pas de temps elle perd ou gagne <span class="math inline">1</span> en fonction du tirage obtenu. Les variables <span class="math inline">X_n</span> représentent alors le gain du <span class="math inline">n</span>-ème jeu, et <span class="math inline">S_n</span> la richesse totale de la joueuse après le <span class="math inline">n</span>-ème tirage.</p>
<div id="fig-marche" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-marche-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="sourceCode cell-code hidden" id="cb1" data-startfrom="62" data-source-offset="-64"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 61;"><span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>Plotly <span class="op">=</span> <span class="pp">require</span>(<span class="st">'plotly.js-dist'</span>)<span class="op">;</span></span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>dists <span class="op">=</span> <span class="pp">require</span>( <span class="st">'https://cdn.jsdelivr.net/gh/stdlib-js/stats-base-dists@umd/browser.js'</span> )<span class="op">;</span></span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>jstat <span class="op">=</span> <span class="pp">require</span>(<span class="st">'jstat'</span>)<span class="op">;</span></span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>seedrandom <span class="op">=</span> <span class="pp">require</span>(<span class="st">'seedrandom@3.0.5'</span>)<span class="op">;</span></span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>math <span class="op">=</span> <span class="pp">require</span>(<span class="st">"mathjs"</span>)<span class="op">;</span></span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a><span class="co">// see source here: https://github.com/stdlib-js/stats-base-dists/tree/umd</span></span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a><span class="co">// continuous case</span></span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>viewof inputs <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">form</span>([</span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a>  Inputs<span class="op">.</span><span class="fu">range</span>([<span class="op">-</span><span class="dv">10</span><span class="op">,</span> <span class="dv">10</span>]<span class="op">,</span> {<span class="dt">label</span><span class="op">:</span> <span class="fu">tex</span><span class="vs">`x`</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="dv">1</span>}<span class="op">,</span> {<span class="dt">value</span><span class="op">:</span> <span class="dv">3</span>})<span class="op">,</span></span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a>  Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">1</span><span class="op">,</span> <span class="dv">100</span>]<span class="op">,</span> {<span class="dt">label</span><span class="op">:</span> <span class="fu">tex</span><span class="vs">`n`</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="dv">1</span>})<span class="op">,</span></span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a>  Inputs<span class="op">.</span><span class="fu">button</span>(<span class="st">"Re-Tirage"</span>)</span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a>])</span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a>mu <span class="op">=</span> inputs[<span class="dv">0</span>]<span class="op">;</span></span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a>n_samples <span class="op">=</span> inputs[<span class="dv">1</span>]<span class="op">;</span></span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a>seed <span class="op">=</span> <span class="dv">44</span> <span class="op">+</span> inputs[<span class="dv">2</span>]<span class="op">;</span></span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> rng <span class="op">=</span> <span class="fu">seedrandom</span>(seed)</span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">random_walk</span>(n<span class="op">=</span><span class="dv">100</span>){</span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> samples <span class="op">=</span> <span class="bu">Array</span><span class="op">.</span><span class="fu">from</span>({<span class="dt">length</span><span class="op">:</span> n}<span class="op">,</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a>         <span class="cf">if</span> (rng<span class="op">.</span><span class="fu">double</span>() <span class="op">&gt;</span> <span class="fl">0.5</span>) {</span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> {</span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="op">-</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> samples<span class="op">;</span></span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> samples <span class="op">=</span> <span class="fu">random_walk</span>(<span class="dv">100</span>)<span class="op">;</span></span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-97"><a href="#cb1-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-98"><a href="#cb1-98" aria-hidden="true" tabindex="-1"></a><span class="co">// create a cumsum function:</span></span>
<span id="cb1-99"><a href="#cb1-99" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">cumsum</span>(array) {</span>
<span id="cb1-100"><a href="#cb1-100" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> result <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb1-101"><a href="#cb1-101" aria-hidden="true" tabindex="-1"></a>  array<span class="op">.</span><span class="fu">reduce</span>(<span class="kw">function</span>(a<span class="op">,</span>b<span class="op">,</span>i) { <span class="cf">return</span> result[i] <span class="op">=</span> a<span class="op">+</span>b<span class="op">;</span> }<span class="op">,</span><span class="dv">0</span>)<span class="op">;</span></span>
<span id="cb1-102"><a href="#cb1-102" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> result<span class="op">;</span></span>
<span id="cb1-103"><a href="#cb1-103" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-104"><a href="#cb1-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-105"><a href="#cb1-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-106"><a href="#cb1-106" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> npoints<span class="op">=</span><span class="dv">100</span><span class="op">,</span> mini <span class="op">=</span> <span class="dv">0</span><span class="op">,</span> maxi<span class="op">=</span><span class="dv">100</span><span class="op">;</span></span>
<span id="cb1-107"><a href="#cb1-107" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> x <span class="op">=</span> <span class="kw">new</span> <span class="bu">Array</span>(npoints)<span class="op">,</span> walk <span class="op">=</span> <span class="kw">new</span> <span class="bu">Array</span>(npoints)<span class="op">,</span> zeros <span class="op">=</span> <span class="kw">new</span> <span class="bu">Array</span>(npoints)<span class="op">,</span> z <span class="op">=</span> <span class="kw">new</span> <span class="bu">Array</span>(npoints)<span class="op">,</span> i<span class="op">,</span> j<span class="op">;</span></span>
<span id="cb1-108"><a href="#cb1-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-109"><a href="#cb1-109" aria-hidden="true" tabindex="-1"></a><span class="co">//  Densité:s</span></span>
<span id="cb1-110"><a href="#cb1-110" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(<span class="kw">var</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> npoints<span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb1-111"><a href="#cb1-111" aria-hidden="true" tabindex="-1"></a>    x[i] <span class="op">=</span> i <span class="op">;</span></span>
<span id="cb1-112"><a href="#cb1-112" aria-hidden="true" tabindex="-1"></a>    zeros[i] <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb1-113"><a href="#cb1-113" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-114"><a href="#cb1-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-115"><a href="#cb1-115" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb1-116"><a href="#cb1-116" aria-hidden="true" tabindex="-1"></a>    <span class="co">// points lower</span></span>
<span id="cb1-117"><a href="#cb1-117" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> trace1 <span class="op">=</span> {</span>
<span id="cb1-118"><a href="#cb1-118" aria-hidden="true" tabindex="-1"></a>        <span class="dt">x</span><span class="op">:</span> x<span class="op">.</span><span class="fu">slice</span>(<span class="dv">1</span><span class="op">,</span> n_samples<span class="op">+</span><span class="dv">1</span>)<span class="op">,</span></span>
<span id="cb1-119"><a href="#cb1-119" aria-hidden="true" tabindex="-1"></a>        <span class="dt">y</span><span class="op">:</span> zeros<span class="op">.</span><span class="fu">slice</span>(<span class="dv">1</span><span class="op">,</span> n_samples<span class="op">+</span><span class="dv">1</span>)<span class="op">,</span></span>
<span id="cb1-120"><a href="#cb1-120" aria-hidden="true" tabindex="-1"></a>        <span class="dt">z</span><span class="op">:</span> samples<span class="op">.</span><span class="fu">slice</span>(<span class="dv">0</span><span class="op">,</span> n_samples)<span class="op">,</span></span>
<span id="cb1-121"><a href="#cb1-121" aria-hidden="true" tabindex="-1"></a>        <span class="co">// mode: 'markers',</span></span>
<span id="cb1-122"><a href="#cb1-122" aria-hidden="true" tabindex="-1"></a>        <span class="dt">type</span><span class="op">:</span> <span class="st">'heatmap'</span><span class="op">,</span></span>
<span id="cb1-123"><a href="#cb1-123" aria-hidden="true" tabindex="-1"></a>            <span class="dt">xaxis</span><span class="op">:</span> <span class="st">'x2'</span><span class="op">,</span></span>
<span id="cb1-124"><a href="#cb1-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-125"><a href="#cb1-125" aria-hidden="true" tabindex="-1"></a>        <span class="co">// marker: {</span></span>
<span id="cb1-126"><a href="#cb1-126" aria-hidden="true" tabindex="-1"></a>        <span class="co">//     color: samples2.slice(0, n_samples2).map((x) =&gt; x &gt; 0 ? 'blue' : 'red'),</span></span>
<span id="cb1-127"><a href="#cb1-127" aria-hidden="true" tabindex="-1"></a>        <span class="co">//     size: 5,</span></span>
<span id="cb1-128"><a href="#cb1-128" aria-hidden="true" tabindex="-1"></a>        <span class="co">// },</span></span>
<span id="cb1-129"><a href="#cb1-129" aria-hidden="true" tabindex="-1"></a>        <span class="dt">showscale</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span></span>
<span id="cb1-130"><a href="#cb1-130" aria-hidden="true" tabindex="-1"></a>        <span class="dt">colorscale</span><span class="op">:</span> [[<span class="dv">0</span><span class="op">,</span> <span class="st">"rgb(66, 139, 202)"</span>]<span class="op">,</span> [<span class="dv">1</span><span class="op">,</span> <span class="st">"rgb(255,0,0)"</span>]]<span class="op">,</span></span>
<span id="cb1-131"><a href="#cb1-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-132"><a href="#cb1-132" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-133"><a href="#cb1-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-134"><a href="#cb1-134" aria-hidden="true" tabindex="-1"></a>walk <span class="op">=</span> <span class="fu">cumsum</span>(samples)<span class="op">;</span></span>
<span id="cb1-135"><a href="#cb1-135" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(<span class="kw">var</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> npoints<span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb1-136"><a href="#cb1-136" aria-hidden="true" tabindex="-1"></a>    walk[i] <span class="op">=</span> walk[i] <span class="op">+</span> mu <span class="op">;</span></span>
<span id="cb1-137"><a href="#cb1-137" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-138"><a href="#cb1-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-139"><a href="#cb1-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-140"><a href="#cb1-140" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> trace22 <span class="op">=</span> {</span>
<span id="cb1-141"><a href="#cb1-141" aria-hidden="true" tabindex="-1"></a>        <span class="dt">x</span><span class="op">:</span> x<span class="op">.</span><span class="fu">slice</span>(<span class="dv">0</span><span class="op">,</span> n_samples)<span class="op">,</span></span>
<span id="cb1-142"><a href="#cb1-142" aria-hidden="true" tabindex="-1"></a>        <span class="dt">y</span><span class="op">:</span> walk<span class="op">.</span><span class="fu">slice</span>(<span class="dv">0</span><span class="op">,</span> n_samples)<span class="op">,</span></span>
<span id="cb1-143"><a href="#cb1-143" aria-hidden="true" tabindex="-1"></a>        <span class="dt">type</span><span class="op">:</span> <span class="st">"scatter"</span><span class="op">,</span></span>
<span id="cb1-144"><a href="#cb1-144" aria-hidden="true" tabindex="-1"></a>        <span class="dt">mode</span><span class="op">:</span> <span class="st">"lines"</span><span class="op">,</span></span>
<span id="cb1-145"><a href="#cb1-145" aria-hidden="true" tabindex="-1"></a>        <span class="dt">name</span><span class="op">:</span> <span class="st">'Marche aléatoire'</span><span class="op">,</span></span>
<span id="cb1-146"><a href="#cb1-146" aria-hidden="true" tabindex="-1"></a>        <span class="dt">line</span><span class="op">:</span> {<span class="dt">color</span><span class="op">:</span> <span class="st">'black'</span>}<span class="op">,</span></span>
<span id="cb1-147"><a href="#cb1-147" aria-hidden="true" tabindex="-1"></a>        <span class="dt">yaxis</span><span class="op">:</span> <span class="st">'y2'</span><span class="op">,</span></span>
<span id="cb1-148"><a href="#cb1-148" aria-hidden="true" tabindex="-1"></a>        <span class="dt">xaxis</span><span class="op">:</span> <span class="st">'x2'</span><span class="op">,</span></span>
<span id="cb1-149"><a href="#cb1-149" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb1-150"><a href="#cb1-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-151"><a href="#cb1-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-152"><a href="#cb1-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-153"><a href="#cb1-153" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> data <span class="op">=</span> [</span>
<span id="cb1-154"><a href="#cb1-154" aria-hidden="true" tabindex="-1"></a>  trace1<span class="op">,</span></span>
<span id="cb1-155"><a href="#cb1-155" aria-hidden="true" tabindex="-1"></a>  trace22<span class="op">,</span></span>
<span id="cb1-156"><a href="#cb1-156" aria-hidden="true" tabindex="-1"></a>  ]<span class="op">;</span></span>
<span id="cb1-157"><a href="#cb1-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-158"><a href="#cb1-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-159"><a href="#cb1-159" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> layout <span class="op">=</span> {</span>
<span id="cb1-160"><a href="#cb1-160" aria-hidden="true" tabindex="-1"></a>    <span class="dt">width</span><span class="op">:</span> <span class="dv">600</span><span class="op">,</span></span>
<span id="cb1-161"><a href="#cb1-161" aria-hidden="true" tabindex="-1"></a>  <span class="dt">xaxis</span><span class="op">:</span> {<span class="dt">range</span><span class="op">:</span> [<span class="dv">0</span><span class="op">,</span> n_samples<span class="op">+</span><span class="dv">1</span>]<span class="op">,</span></span>
<span id="cb1-162"><a href="#cb1-162" aria-hidden="true" tabindex="-1"></a>          <span class="dt">showticklabels</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span></span>
<span id="cb1-163"><a href="#cb1-163" aria-hidden="true" tabindex="-1"></a>          <span class="dt">autorange</span><span class="op">:</span> <span class="kw">false</span>}<span class="op">,</span></span>
<span id="cb1-164"><a href="#cb1-164" aria-hidden="true" tabindex="-1"></a>    <span class="dt">yaxis</span><span class="op">:</span> {<span class="dt">domain</span><span class="op">:</span> [<span class="dv">0</span><span class="op">,</span> <span class="fl">0.08</span>]<span class="op">,</span></span>
<span id="cb1-165"><a href="#cb1-165" aria-hidden="true" tabindex="-1"></a>            <span class="dt">showticklabels</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span></span>
<span id="cb1-166"><a href="#cb1-166" aria-hidden="true" tabindex="-1"></a>      <span class="dt">ticks</span><span class="op">:</span><span class="st">""</span><span class="op">,</span></span>
<span id="cb1-167"><a href="#cb1-167" aria-hidden="true" tabindex="-1"></a>            <span class="dt">range</span><span class="op">:</span> [<span class="op">-</span><span class="fl">0.5</span><span class="op">,</span> <span class="fl">0.5</span>]<span class="op">,</span></span>
<span id="cb1-168"><a href="#cb1-168" aria-hidden="true" tabindex="-1"></a>            <span class="dt">autorange</span><span class="op">:</span> <span class="kw">false</span>}<span class="op">,</span></span>
<span id="cb1-169"><a href="#cb1-169" aria-hidden="true" tabindex="-1"></a>    <span class="dt">xaxis2</span><span class="op">:</span> {<span class="dt">matches</span><span class="op">:</span> <span class="st">'x'</span><span class="op">,</span></span>
<span id="cb1-170"><a href="#cb1-170" aria-hidden="true" tabindex="-1"></a>              <span class="dt">range</span><span class="op">:</span> [<span class="dv">0</span><span class="op">,</span> n_samples<span class="op">+</span><span class="dv">1</span>]<span class="op">,</span></span>
<span id="cb1-171"><a href="#cb1-171" aria-hidden="true" tabindex="-1"></a>          <span class="dt">autorange</span><span class="op">:</span> <span class="kw">true</span>}<span class="op">,</span></span>
<span id="cb1-172"><a href="#cb1-172" aria-hidden="true" tabindex="-1"></a>    <span class="dt">yaxis2</span><span class="op">:</span> {<span class="dt">domain</span><span class="op">:</span> [<span class="fl">0.29</span><span class="op">,</span> <span class="fl">0.99</span>]<span class="op">,</span></span>
<span id="cb1-173"><a href="#cb1-173" aria-hidden="true" tabindex="-1"></a>              <span class="dt">range</span><span class="op">:</span> [<span class="op">-</span><span class="dv">20</span><span class="op">,</span> <span class="dv">20</span>]}<span class="op">,</span></span>
<span id="cb1-174"><a href="#cb1-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-175"><a href="#cb1-175" aria-hidden="true" tabindex="-1"></a>  <span class="dt">showlegend</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span></span>
<span id="cb1-176"><a href="#cb1-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-177"><a href="#cb1-177" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span>
<span id="cb1-178"><a href="#cb1-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-179"><a href="#cb1-179" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> config <span class="op">=</span> {<span class="dt">responsive</span><span class="op">:</span> <span class="kw">true</span>}</span>
<span id="cb1-180"><a href="#cb1-180" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> div <span class="op">=</span> DOM<span class="op">.</span><span class="fu">element</span>(<span class="st">'div'</span>)<span class="op">;</span></span>
<span id="cb1-181"><a href="#cb1-181" aria-hidden="true" tabindex="-1"></a>    Plotly<span class="op">.</span><span class="fu">react</span>(div<span class="op">,</span> data<span class="op">,</span> layout<span class="op">,</span> config)<span class="op">;</span></span>
<span id="cb1-182"><a href="#cb1-182" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> div<span class="op">;</span></span>
<span id="cb1-183"><a href="#cb1-183" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-184"><a href="#cb1-184" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell quarto-layout-panel" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="ojs-cell-1-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="ojs-cell-1-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="ojs-cell-1-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="ojs-cell-1-4" data-nodetype="declaration">

</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="ojs-cell-1-5" data-nodetype="declaration">

</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="ojs-cell-1-6" data-nodetype="declaration">

</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="ojs-cell-1-7" data-nodetype="declaration">

</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="ojs-cell-1-8" data-nodetype="declaration">

</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="ojs-cell-1-9" data-nodetype="declaration">

</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="ojs-cell-1-10" data-nodetype="expression">

</div>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-marche-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Marche aléatoire simple symétrique et son chemin, initialisée en <span class="math inline">(0,x)</span>.
</figcaption>
</figure>
</div>
<p>À partir de la définition, on obtient très facilement le comportement moyen de la marche.</p>
<div id="prp-ma" class="theorem proposition">
<p><span class="theorem-title"><strong>Proposition 1</strong></span> Pour tout <span class="math inline">n\in\mathbb{N}</span>, on a <span class="math display">
\mathbb{E}[S_n]=S_0,\quad \mathop{\mathrm{Var}}(S_n)=n.
</span></p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Preuve</em>. </span>Remarquons d’abord que <span class="math display">\begin{align*}
\mathbb{E}[X_1]&amp;=(-1)\times \frac{1}{2}+1\times  \frac{1}{2}=0,\\
\mathop{\mathrm{Var}}(X_1)&amp;=\mathbb{E}[X_1^2]=(-1)^2\times \frac{1}{2}+1^2\times  \frac{1}{2}=1,
\end{align*}</span> les incréments sont donc centrés et réduits. Par linéarité de l’espérance, on obtient <span class="math display">
\mathbb{E}[S_n]=\mathbb{E}[S_0+\sum_{k=1}^n X_k]=S_0+\sum_{k=1}^n \mathbb{E}[X_k]=S_0,
</span> puisque <span class="math inline">S_0</span> est déterministe. Enfin, en utilisant l’indépendance des <span class="math inline">X_k</span>, on obtient <span class="math display">
\mathop{\mathrm{Var}}(S_n)=\mathop{\mathrm{Var}}(S_0+\sum_{k=1}^n X_k)=\sum_{k=1}^n \mathop{\mathrm{Var}}(X_k)=n,
</span> d’où le résultat.</p>
</div>
<p>Ainsi, en moyenne la marche reste constante, mais sa variance devient de plus en plus grande au cours du temps.</p>
</section>
<section id="sec-chap03-graphe" class="level3">
<h3 class="anchored" data-anchor-id="sec-chap03-graphe">Représentation graphique</h3>
<p>Les marches aléatoires, comme tous les processus à valeurs discrètes, ont une représentation graphique naturelle. On représente graphiquement un tirage de la marche <span class="math inline">(S_n)_{n\in\mathbb{N}}</span> sur l’intervalle de temps <span class="math inline">\llbracket 0,N \rrbracket</span> par une ligne brisée joignant les points <span class="math inline">(0,S_0)</span>, <span class="math inline">(1,S_1)</span>, ,<span class="math inline">(N,S_N)</span>. On a donc en abscisse le temps, et en ordonnée la valeur de la marche, cf. <a href="#fig-marche" class="quarto-xref">Figure&nbsp;1</a>.</p>
<!-- ::: {#exm-traj}
La trajectoire correspondant au tirage $S_0=0$, $X_1=1$, $X_2=1$, $X_3=-1$, $X_4=1$, $X_5=-1$ est donnée ... .

::: -->
<p>La marche aléatoire est un processus à temps discret, donc rigoureusement sa représentation graphique devrait être constituée des points <span class="math inline">(n,S_n)</span> non reliés. Par exemple, <span class="math inline">S_{1/2}</span> n’est pas défini. Cependant, on relie les points pour une meilleure lecture des graphiques.</p>
<p>On s’intéresse maintenant aux représentations graphiques qui peuvent correspondre à des tirages de la marche aléatoire.</p>
<div id="def-chemin" class="theorem definition">
<p><span class="theorem-title"><strong>Définition 2</strong></span> Soit <span class="math inline">n&gt;m</span> deux entiers naturels et <span class="math inline">(a,b)\in\mathbb{Z}^2</span> deux entiers relatifs. On appelle <em>chemin</em> de <span class="math inline">(m,a)</span> à <span class="math inline">(n,b)</span> la représentation graphique d’un tirage de la marche aléatoire telle que <span class="math inline">S_m=a</span> et <span class="math inline">S_n=b</span>.</p>
</div>
<div id="fig-traj_rw" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-traj_rw-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../srcimages/deux_chemins.svg" class="img-fluid figure-img" style="width:50.0%"></p>
<figcaption>Deux trajectoires</figcaption>
</figure>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-traj_rw-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Voici deux chemins de <span class="math inline">(1,1)</span> à <span class="math inline">(5,3)</span>.
</figcaption>
</figure>
</div>
<p>On peut maintenant se poser la question de savoir s’il existe toujours un chemin qui relie deux points quelconques, et s’il en existe, combien on peut construire de chemins différents reliant ces deux points. On peut facilement montrer que certains chemins sont impossibles en regardant la parité de la marche aléatoire et son amplitude maximale.</p>
<div id="prp-parite" class="theorem proposition">
<p><span class="theorem-title"><strong>Proposition 2 (Parité)</strong></span> Pour tout <span class="math inline">n\in\mathbb{N}</span>, <span class="math inline">S_{2n}</span> a la même parité que <span class="math inline">S_0</span> et <span class="math inline">S_{2n+1}</span> a la parité opposée à celle de <span class="math inline">S_0</span>.</p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Preuve</em>. </span>Pour tout <span class="math inline">n</span>, <span class="math inline">X_{n+1}</span> prend les valeurs <span class="math inline">-1</span> ou <span class="math inline">1</span> donc est impair. Comme <span class="math inline">S_{n+1}=S_n+X_{n+1}</span>, la marche change de parité à chaque pas de temps.</p>
</div>
<p>On en déduit immédiatement que les chemins doivent respecter cette alternance de parité.</p>
<div id="cor-nparite" class="theorem corollary">
<p><span class="theorem-title"><strong>Corollaire 1</strong></span> Si <span class="math inline">n-m</span> et <span class="math inline">b-a</span> n’ont pas la même parité, alors il n’existe pas de chemin de <span class="math inline">(m,a)</span> à <span class="math inline">(n,b)</span>.</p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Preuve</em>. </span>Supposons sans perte de généralité que <span class="math inline">n-m</span> est pair, et qu’il existe un chemin de <span class="math inline">(m,a)</span> à <span class="math inline">(n,b)</span>. Alors <span class="math inline">S_m=a</span> et <span class="math inline">S_n=b</span> ont nécessairement la même parité, donc <span class="math inline">S_n-S_m=b-a</span> est pair.</p>
</div>
<div id="exm-nnchemin" class="theorem example">
<p><span class="theorem-title"><strong>Exemple 1</strong></span> Il n’existe pas de chemin de <span class="math inline">(0,0)</span> à <span class="math inline">(2,1)</span>.</p>
</div>
<div id="prp-amplitude" class="theorem proposition">
<p><span class="theorem-title"><strong>Proposition 3 (Amplitude)</strong></span> Pour tout <span class="math inline">n\in\mathbb{N}</span>, on a <span class="math inline">S_0-n\leq S_n\leq S_0+n</span>.</p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Preuve</em>. </span>Pour tout <span class="math inline">n</span>, <span class="math inline">X_{n}</span> prend les valeurs <span class="math inline">-1</span> ou <span class="math inline">1</span> donc en particulier <span class="math display">
-1\leq X_n\leq 1.
</span> Comme <span class="math inline">S_{n}=S_0+\sum_{k=1}^n X_k</span>, en sommant les inégalités on obtient bien <span class="math display">
S_0-n\leq S_n\leq S_0+n,
</span> d’où le résultat.</p>
</div>
<div id="cor-nnchemin" class="theorem corollary">
<p><span class="theorem-title"><strong>Corollaire 2</strong></span> Si <span class="math inline">n-m&lt;|b-a|</span>, alors il n’existe pas de chemin de <span class="math inline">(m,a)</span> à <span class="math inline">(n,b)</span>.</p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Preuve</em>. </span>Supposons qu’il existe un chemin de <span class="math inline">(m,a)</span> à <span class="math inline">(n,b)</span>. Alors <span class="math inline">S_m=a</span> et <span class="math inline">S_n=b</span>. En particulier, <span class="math inline">S_n=S_m+\sum_{k=m+1}^nX_k</span>, d’où <span class="math display">\begin{align*}
&amp;S_m-(n-m)\leq S_n\leq S_m+(n-m)\\
\Rightarrow &amp; \; a-(n-m)\leq b\leq a+(n-m)\\
\Rightarrow &amp; \; -(n-m)\leq b-a\leq n-m.
\end{align*}</span> On a donc nécessairement <span class="math inline">|b-a|\leq n-m</span>.</p>
</div>
<div id="exm-nnchemin" class="theorem example">
<p><span class="theorem-title"><strong>Exemple 2</strong></span> Il n’existe pas de chemin de <span class="math inline">(0,0)</span> à <span class="math inline">(2,4)</span>.</p>
</div>
<div id="fig-pont" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-pont-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="sourceCode cell-code hidden" id="cb2" data-startfrom="325" data-source-offset="-161"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 324;"><span id="cb2-325"><a href="#cb2-325" aria-hidden="true" tabindex="-1"></a>viewof inputs2 <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">form</span>([</span>
<span id="cb2-326"><a href="#cb2-326" aria-hidden="true" tabindex="-1"></a>  Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">2</span><span class="op">,</span> <span class="dv">100</span>]<span class="op">,</span> {<span class="dt">label</span><span class="op">:</span> <span class="fu">tex</span><span class="vs">`n`</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="dv">2</span>})<span class="op">,</span></span>
<span id="cb2-327"><a href="#cb2-327" aria-hidden="true" tabindex="-1"></a>  Inputs<span class="op">.</span><span class="fu">button</span>(<span class="st">"Re-Tirage"</span>)</span>
<span id="cb2-328"><a href="#cb2-328" aria-hidden="true" tabindex="-1"></a>])</span>
<span id="cb2-329"><a href="#cb2-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-330"><a href="#cb2-330" aria-hidden="true" tabindex="-1"></a>n_samples2 <span class="op">=</span> inputs2[<span class="dv">0</span>]<span class="op">;</span></span>
<span id="cb2-331"><a href="#cb2-331" aria-hidden="true" tabindex="-1"></a>seed2 <span class="op">=</span> <span class="dv">44</span> <span class="op">+</span> inputs2[<span class="dv">1</span>]<span class="op">;</span></span>
<span id="cb2-332"><a href="#cb2-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-333"><a href="#cb2-333" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb2-334"><a href="#cb2-334" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> npoints2<span class="op">=</span>n_samples2</span>
<span id="cb2-335"><a href="#cb2-335" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> rng <span class="op">=</span> <span class="fu">seedrandom</span>(seed2)</span>
<span id="cb2-336"><a href="#cb2-336" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> samples2 <span class="op">=</span> <span class="kw">new</span> <span class="bu">Array</span>(npoints2)</span>
<span id="cb2-337"><a href="#cb2-337" aria-hidden="true" tabindex="-1"></a><span class="co">// create a vector of size 100 whose first half is 1 and second half is -1</span></span>
<span id="cb2-338"><a href="#cb2-338" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (<span class="kw">var</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> npoints2 <span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb2-339"><a href="#cb2-339" aria-hidden="true" tabindex="-1"></a>  samples2[i] <span class="op">=</span> i <span class="op">&gt;=</span> npoints2<span class="op">/</span><span class="dv">2</span>  <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> <span class="op">-</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb2-340"><a href="#cb2-340" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-341"><a href="#cb2-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-342"><a href="#cb2-342" aria-hidden="true" tabindex="-1"></a><span class="co">// https://www.codemzy.com/blog/shuffle-array-javascript</span></span>
<span id="cb2-343"><a href="#cb2-343" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">shuffleArray</span>(array) {</span>
<span id="cb2-344"><a href="#cb2-344" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> length <span class="op">=</span> array<span class="op">.</span><span class="at">length</span><span class="op">;</span></span>
<span id="cb2-345"><a href="#cb2-345" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> shuffle <span class="op">=</span> array<span class="op">.</span><span class="fu">slice</span>()<span class="op">;</span> <span class="co">// copy of array</span></span>
<span id="cb2-346"><a href="#cb2-346" aria-hidden="true" tabindex="-1"></a>  <span class="co">// loop over the array</span></span>
<span id="cb2-347"><a href="#cb2-347" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (<span class="kw">let</span> i <span class="op">=</span> length <span class="op">-</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&gt;</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">-=</span> <span class="dv">1</span>) {</span>
<span id="cb2-348"><a href="#cb2-348" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> random <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(rng<span class="op">.</span><span class="fu">double</span>() <span class="op">*</span> (i <span class="op">+</span> <span class="dv">1</span>))<span class="op">;</span> <span class="co">// random card position</span></span>
<span id="cb2-349"><a href="#cb2-349" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> current <span class="op">=</span> shuffle[i]<span class="op">;</span> <span class="co">// current card</span></span>
<span id="cb2-350"><a href="#cb2-350" aria-hidden="true" tabindex="-1"></a>    <span class="co">// swap the random card and the current card</span></span>
<span id="cb2-351"><a href="#cb2-351" aria-hidden="true" tabindex="-1"></a>    shuffle[i] <span class="op">=</span> shuffle[random]<span class="op">;</span> <span class="co">// move the random card to the current position</span></span>
<span id="cb2-352"><a href="#cb2-352" aria-hidden="true" tabindex="-1"></a>    shuffle[random] <span class="op">=</span> current<span class="op">;</span> <span class="co">// put the current card in the random position</span></span>
<span id="cb2-353"><a href="#cb2-353" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb2-354"><a href="#cb2-354" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> shuffle<span class="op">;</span> <span class="co">// return shuffled array</span></span>
<span id="cb2-355"><a href="#cb2-355" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span>
<span id="cb2-356"><a href="#cb2-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-357"><a href="#cb2-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-358"><a href="#cb2-358" aria-hidden="true" tabindex="-1"></a>samples2<span class="op">=</span><span class="fu">shuffleArray</span>(samples2)<span class="op">;</span></span>
<span id="cb2-359"><a href="#cb2-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-360"><a href="#cb2-360" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> x2 <span class="op">=</span> <span class="kw">new</span> <span class="bu">Array</span>(npoints2)<span class="op">,</span> walk2 <span class="op">=</span> <span class="kw">new</span> <span class="bu">Array</span>(npoints2)<span class="op">,</span> zeros2 <span class="op">=</span> <span class="kw">new</span> <span class="bu">Array</span>(npoints2)<span class="op">,</span> z <span class="op">=</span> <span class="kw">new</span> <span class="bu">Array</span>(npoints2)<span class="op">,</span> i<span class="op">,</span> j<span class="op">;</span></span>
<span id="cb2-361"><a href="#cb2-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-362"><a href="#cb2-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-363"><a href="#cb2-363" aria-hidden="true" tabindex="-1"></a><span class="co">// create a cumsum function:</span></span>
<span id="cb2-364"><a href="#cb2-364" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">cumsum</span>(array) {</span>
<span id="cb2-365"><a href="#cb2-365" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> result <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb2-366"><a href="#cb2-366" aria-hidden="true" tabindex="-1"></a>  array<span class="op">.</span><span class="fu">reduce</span>(<span class="kw">function</span>(a<span class="op">,</span>b<span class="op">,</span>i) { <span class="cf">return</span> result[i] <span class="op">=</span> a<span class="op">+</span>b<span class="op">;</span> }<span class="op">,</span><span class="dv">0</span>)<span class="op">;</span></span>
<span id="cb2-367"><a href="#cb2-367" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> result<span class="op">;</span></span>
<span id="cb2-368"><a href="#cb2-368" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-369"><a href="#cb2-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-370"><a href="#cb2-370" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> walkint <span class="op">=</span> <span class="fu">cumsum</span>(samples2)<span class="op">;</span></span>
<span id="cb2-371"><a href="#cb2-371" aria-hidden="true" tabindex="-1"></a>walk2 <span class="op">=</span> <span class="kw">new</span> <span class="bu">Array</span>(npoints2<span class="op">+</span><span class="dv">1</span>)<span class="op">,</span></span>
<span id="cb2-372"><a href="#cb2-372" aria-hidden="true" tabindex="-1"></a>walk2[<span class="dv">0</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb2-373"><a href="#cb2-373" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> npoints2<span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb2-374"><a href="#cb2-374" aria-hidden="true" tabindex="-1"></a>    walk2[i<span class="op">+</span><span class="dv">1</span>] <span class="op">=</span> walkint[i]<span class="op">;</span></span>
<span id="cb2-375"><a href="#cb2-375" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb2-376"><a href="#cb2-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-377"><a href="#cb2-377" aria-hidden="true" tabindex="-1"></a><span class="co">//  Densité:</span></span>
<span id="cb2-378"><a href="#cb2-378" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(<span class="kw">var</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> npoints2<span class="op">+</span><span class="dv">1</span><span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb2-379"><a href="#cb2-379" aria-hidden="true" tabindex="-1"></a>    x2[i] <span class="op">=</span> i <span class="op">;</span></span>
<span id="cb2-380"><a href="#cb2-380" aria-hidden="true" tabindex="-1"></a>    zeros2[i] <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb2-381"><a href="#cb2-381" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb2-382"><a href="#cb2-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-383"><a href="#cb2-383" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb2-384"><a href="#cb2-384" aria-hidden="true" tabindex="-1"></a>    <span class="co">// points lower</span></span>
<span id="cb2-385"><a href="#cb2-385" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> trace1 <span class="op">=</span> {</span>
<span id="cb2-386"><a href="#cb2-386" aria-hidden="true" tabindex="-1"></a>        <span class="dt">x</span><span class="op">:</span> x2<span class="op">.</span><span class="fu">slice</span>(<span class="dv">1</span><span class="op">,</span> n_samples2<span class="op">+</span><span class="dv">1</span>)<span class="op">,</span></span>
<span id="cb2-387"><a href="#cb2-387" aria-hidden="true" tabindex="-1"></a>        <span class="dt">y</span><span class="op">:</span> zeros2<span class="op">.</span><span class="fu">slice</span>(<span class="dv">1</span><span class="op">,</span> n_samples2<span class="op">+</span><span class="dv">1</span>)<span class="op">,</span></span>
<span id="cb2-388"><a href="#cb2-388" aria-hidden="true" tabindex="-1"></a>        <span class="dt">z</span><span class="op">:</span> samples2<span class="op">.</span><span class="fu">slice</span>(<span class="dv">0</span><span class="op">,</span> n_samples2)<span class="op">,</span></span>
<span id="cb2-389"><a href="#cb2-389" aria-hidden="true" tabindex="-1"></a>        <span class="co">// mode: 'markers',</span></span>
<span id="cb2-390"><a href="#cb2-390" aria-hidden="true" tabindex="-1"></a>        <span class="dt">type</span><span class="op">:</span> <span class="st">'heatmap'</span><span class="op">,</span></span>
<span id="cb2-391"><a href="#cb2-391" aria-hidden="true" tabindex="-1"></a>            <span class="dt">xaxis</span><span class="op">:</span> <span class="st">'x2'</span><span class="op">,</span></span>
<span id="cb2-392"><a href="#cb2-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-393"><a href="#cb2-393" aria-hidden="true" tabindex="-1"></a>        <span class="co">// marker: {</span></span>
<span id="cb2-394"><a href="#cb2-394" aria-hidden="true" tabindex="-1"></a>        <span class="co">//     color: samples2.slice(0, n_samples2).map((x) =&gt; x &gt; 0 ? 'blue' : 'red'),</span></span>
<span id="cb2-395"><a href="#cb2-395" aria-hidden="true" tabindex="-1"></a>        <span class="co">//     size: 5,</span></span>
<span id="cb2-396"><a href="#cb2-396" aria-hidden="true" tabindex="-1"></a>        <span class="co">// },</span></span>
<span id="cb2-397"><a href="#cb2-397" aria-hidden="true" tabindex="-1"></a>        <span class="dt">showscale</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span></span>
<span id="cb2-398"><a href="#cb2-398" aria-hidden="true" tabindex="-1"></a>        <span class="dt">colorscale</span><span class="op">:</span> [[<span class="dv">0</span><span class="op">,</span> <span class="st">"rgb(66, 139, 202)"</span>]<span class="op">,</span> [<span class="dv">1</span><span class="op">,</span> <span class="st">"rgb(255,0,0)"</span>]]<span class="op">,</span></span>
<span id="cb2-399"><a href="#cb2-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-400"><a href="#cb2-400" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb2-401"><a href="#cb2-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-402"><a href="#cb2-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-403"><a href="#cb2-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-404"><a href="#cb2-404" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> trace22 <span class="op">=</span> {</span>
<span id="cb2-405"><a href="#cb2-405" aria-hidden="true" tabindex="-1"></a>        <span class="dt">x</span><span class="op">:</span> x2<span class="op">.</span><span class="fu">slice</span>(<span class="dv">0</span><span class="op">,</span> n_samples2<span class="op">+</span><span class="dv">1</span>)<span class="op">,</span></span>
<span id="cb2-406"><a href="#cb2-406" aria-hidden="true" tabindex="-1"></a>        <span class="dt">y</span><span class="op">:</span> walk2<span class="op">.</span><span class="fu">slice</span>(<span class="dv">0</span><span class="op">,</span> n_samples2<span class="op">+</span><span class="dv">1</span>)<span class="op">,</span></span>
<span id="cb2-407"><a href="#cb2-407" aria-hidden="true" tabindex="-1"></a>        <span class="dt">type</span><span class="op">:</span> <span class="st">"scatter"</span><span class="op">,</span></span>
<span id="cb2-408"><a href="#cb2-408" aria-hidden="true" tabindex="-1"></a>        <span class="dt">mode</span><span class="op">:</span> <span class="st">"lines"</span><span class="op">,</span></span>
<span id="cb2-409"><a href="#cb2-409" aria-hidden="true" tabindex="-1"></a>        <span class="dt">name</span><span class="op">:</span> <span class="st">'Marche aléatoire'</span><span class="op">,</span></span>
<span id="cb2-410"><a href="#cb2-410" aria-hidden="true" tabindex="-1"></a>        <span class="dt">line</span><span class="op">:</span> {<span class="dt">color</span><span class="op">:</span> <span class="st">'black'</span>}<span class="op">,</span></span>
<span id="cb2-411"><a href="#cb2-411" aria-hidden="true" tabindex="-1"></a>        <span class="dt">yaxis</span><span class="op">:</span> <span class="st">'y2'</span><span class="op">,</span></span>
<span id="cb2-412"><a href="#cb2-412" aria-hidden="true" tabindex="-1"></a>        <span class="dt">xaxis</span><span class="op">:</span> <span class="st">'x2'</span><span class="op">,</span></span>
<span id="cb2-413"><a href="#cb2-413" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb2-414"><a href="#cb2-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-415"><a href="#cb2-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-416"><a href="#cb2-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-417"><a href="#cb2-417" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> data <span class="op">=</span> [</span>
<span id="cb2-418"><a href="#cb2-418" aria-hidden="true" tabindex="-1"></a>  trace1<span class="op">,</span></span>
<span id="cb2-419"><a href="#cb2-419" aria-hidden="true" tabindex="-1"></a>  trace22<span class="op">,</span></span>
<span id="cb2-420"><a href="#cb2-420" aria-hidden="true" tabindex="-1"></a>  ]<span class="op">;</span></span>
<span id="cb2-421"><a href="#cb2-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-422"><a href="#cb2-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-423"><a href="#cb2-423" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> layout <span class="op">=</span> {</span>
<span id="cb2-424"><a href="#cb2-424" aria-hidden="true" tabindex="-1"></a>    <span class="dt">width</span><span class="op">:</span> <span class="dv">600</span><span class="op">,</span></span>
<span id="cb2-425"><a href="#cb2-425" aria-hidden="true" tabindex="-1"></a>  <span class="dt">xaxis</span><span class="op">:</span> {<span class="dt">range</span><span class="op">:</span> [<span class="dv">0</span><span class="op">,</span> n_samples2<span class="op">+</span><span class="dv">1</span>]<span class="op">,</span></span>
<span id="cb2-426"><a href="#cb2-426" aria-hidden="true" tabindex="-1"></a>          <span class="dt">showticklabels</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span></span>
<span id="cb2-427"><a href="#cb2-427" aria-hidden="true" tabindex="-1"></a>          <span class="dt">autorange</span><span class="op">:</span> <span class="kw">false</span>}<span class="op">,</span></span>
<span id="cb2-428"><a href="#cb2-428" aria-hidden="true" tabindex="-1"></a>    <span class="dt">yaxis</span><span class="op">:</span> {<span class="dt">domain</span><span class="op">:</span> [<span class="dv">0</span><span class="op">,</span> <span class="fl">0.08</span>]<span class="op">,</span></span>
<span id="cb2-429"><a href="#cb2-429" aria-hidden="true" tabindex="-1"></a>            <span class="dt">showticklabels</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span></span>
<span id="cb2-430"><a href="#cb2-430" aria-hidden="true" tabindex="-1"></a>      <span class="dt">ticks</span><span class="op">:</span><span class="st">""</span><span class="op">,</span></span>
<span id="cb2-431"><a href="#cb2-431" aria-hidden="true" tabindex="-1"></a>            <span class="dt">range</span><span class="op">:</span> [<span class="op">-</span><span class="fl">0.5</span><span class="op">,</span> <span class="fl">0.5</span>]<span class="op">,</span></span>
<span id="cb2-432"><a href="#cb2-432" aria-hidden="true" tabindex="-1"></a>            <span class="dt">autorange</span><span class="op">:</span> <span class="kw">false</span>}<span class="op">,</span></span>
<span id="cb2-433"><a href="#cb2-433" aria-hidden="true" tabindex="-1"></a>    <span class="dt">xaxis2</span><span class="op">:</span> {<span class="dt">matches</span><span class="op">:</span> <span class="st">'x'</span><span class="op">,</span></span>
<span id="cb2-434"><a href="#cb2-434" aria-hidden="true" tabindex="-1"></a>              <span class="dt">range</span><span class="op">:</span> [<span class="dv">0</span><span class="op">,</span> n_samples2<span class="op">+</span><span class="dv">1</span>]<span class="op">,</span></span>
<span id="cb2-435"><a href="#cb2-435" aria-hidden="true" tabindex="-1"></a>          <span class="dt">autorange</span><span class="op">:</span> <span class="kw">true</span>}<span class="op">,</span></span>
<span id="cb2-436"><a href="#cb2-436" aria-hidden="true" tabindex="-1"></a>    <span class="dt">yaxis2</span><span class="op">:</span> {<span class="dt">domain</span><span class="op">:</span> [<span class="fl">0.29</span><span class="op">,</span> <span class="fl">0.99</span>]<span class="op">,</span></span>
<span id="cb2-437"><a href="#cb2-437" aria-hidden="true" tabindex="-1"></a>              <span class="dt">range</span><span class="op">:</span> [<span class="op">-</span><span class="dv">14</span><span class="op">,</span> <span class="dv">14</span>]}<span class="op">,</span></span>
<span id="cb2-438"><a href="#cb2-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-439"><a href="#cb2-439" aria-hidden="true" tabindex="-1"></a>  <span class="dt">showlegend</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span></span>
<span id="cb2-440"><a href="#cb2-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-441"><a href="#cb2-441" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span>
<span id="cb2-442"><a href="#cb2-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-443"><a href="#cb2-443" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> config <span class="op">=</span> {<span class="dt">responsive</span><span class="op">:</span> <span class="kw">true</span>}</span>
<span id="cb2-444"><a href="#cb2-444" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> div <span class="op">=</span> DOM<span class="op">.</span><span class="fu">element</span>(<span class="st">'div'</span>)<span class="op">;</span></span>
<span id="cb2-445"><a href="#cb2-445" aria-hidden="true" tabindex="-1"></a>    Plotly<span class="op">.</span><span class="fu">react</span>(div<span class="op">,</span> data<span class="op">,</span> layout<span class="op">,</span> config)<span class="op">;</span></span>
<span id="cb2-446"><a href="#cb2-446" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> div<span class="op">;</span></span>
<span id="cb2-447"><a href="#cb2-447" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb2-448"><a href="#cb2-448" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell quarto-layout-panel" data-figalign="center" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="ojs-cell-2-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="ojs-cell-2-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="ojs-cell-2-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="ojs-cell-2-4" data-nodetype="expression">

</div>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pont-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Marche aléatoire simple symétrique passant en <span class="math inline">(0,0)</span> et en <span class="math inline">(100,0)</span>.
</figcaption>
</figure>
</div>
<p>Une fois les conditions de parité et d’amplitude satisfaites, il existe toujours des chemins reliant deux points, et on peut les dénombrer explicitement.</p>
<div id="prp-chemins" class="theorem proposition">
<p><span class="theorem-title"><strong>Proposition 4 (Nombre de chemins)</strong></span> Si <span class="math inline">|b-a|\leq n-m</span> et <span class="math inline">n-m</span> et <span class="math inline">b-a</span> ont la même parité, alors le nombre de chemins de <span class="math inline">(m,a)</span> à <span class="math inline">(n,b)</span> est le nombre de combinaisons <span class="math inline">\displaystyle \binom{n-m}{\frac{n-m}{2}+\frac{b-a}{2}}</span>.</p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Preuve</em>. </span>Un chemin de <span class="math inline">(m,a)</span> à <span class="math inline">(n,b)</span> correspond à <span class="math inline">n-m</span> pas de la marche aléatoire en partant de <span class="math inline">a</span> et en arrivant en <span class="math inline">b</span>. Supposons sans perte de généralité que <span class="math inline">b&gt;a</span>. Alors on peut décomposer les pas de la marche entre <span class="math inline">x</span> pas vers le haut (tirages de <span class="math inline">+1</span>) et <span class="math inline">y</span> pas vers le bas (tirages de <span class="math inline">-1</span>). On doit avoir un nombre total de pas de <span class="math inline">x+y=n-m</span>, et une différence des ordonnées de <span class="math inline">x-y=b-a</span>, ce qui donne le système</p>
<p><span class="math display">\begin{align*}
\left\{\begin{array}{rcl}
x+y&amp;=&amp;n-m\\
x-y&amp;=&amp;b-a
\end{array}
\right.
\Leftrightarrow
\left\{\begin{array}{rcl}
x&amp;=&amp;\frac{n-m}{2}+\frac{b-a}{2}\\
y&amp;=&amp;\frac{n-m}{2}-\frac{b-a}{2}
\end{array}
\right. \enspace.
\end{align*}</span></p>
<p>Pour dénombrer le nombre total de chemins de longueur <span class="math inline">x+y</span> avec <span class="math inline">x</span> montées et <span class="math inline">y</span> descentes, il suffit de choisir les emplacements de <span class="math inline">x</span> montées parmi les <span class="math inline">x+y</span> pas. On obtient donc <span class="math inline">\binom{x+y}{x}=\binom{n-m}{\frac{n-m}{2}+\frac{b-a}{2}}</span> chemins.</p>
</div>
<p>Remarquons que pour dénombrer le nombre de chemins d’un point à un autre, nous n’avons pas utilisé le fait que <span class="math inline">\mathbb P(X=1)=\mathbb P(X=-1)</span>, mais uniquement le fait que <span class="math inline">X</span> ne peut prendre que les valeurs <span class="math inline">-1</span> et <span class="math inline">1</span>. Le résultat ci-dessus est donc également valable pour les marches asymétriques où <span class="math inline">p=\mathbb P(X=1)=1-\mathbb P(X=-1)\neq \frac{1}{2}</span>.</p>
</section>
<section id="sec-chap03-reflex" class="level3">
<h3 class="anchored" data-anchor-id="sec-chap03-reflex">Principe de réflexion</h3>
<p>On souhaite maintenant dénombrer les chemins qui ont une propriété particulière supplémentaire, comme passer par un point fixé. Pour cela, on utilise les propriétés de symétrie de la marche.</p>
<div id="prp-reflexion" class="theorem proposition">
<p><span class="theorem-title"><strong>Proposition 5 (Principe de réflexion)</strong></span> Soit <span class="math inline">a</span> et <span class="math inline">b</span> deux entiers naturels non nuls et <span class="math inline">n,m</span> deux entiers naturels tels que <span class="math inline">n&gt;m</span>, <span class="math inline">|b-a|\leq n-m</span> et <span class="math inline">b-a</span> et <span class="math inline">n-m</span> ont la même parité. Alors le nombre de chemins de <span class="math inline">(m,a)</span> à <span class="math inline">(n,b)</span> passant par <span class="math inline">0</span> (<em>i.e.</em> touchant l’axe des abscisses) est égal au nombre de chemins de <span class="math inline">(m,a)</span> à <span class="math inline">(n,-b)</span>.</p>
</div>
<div id="fig-reflex" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-reflex-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../srcimages/reflex.svg" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption>Réflextion</figcaption>
</figure>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-reflex-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Un chemin de <span class="math inline">(0,2)</span> à <span class="math inline">(11,1)</span> passant par 0 (trait bleu) et son image (tirets rouges) par la symétrie de premier passage en 0.
</figcaption>
</figure>
</div>
<div class="proof">
<p><span class="proof-title"><em>Preuve</em>. </span>Le principe est de construire une bijection entre les deux ensembles de chemins pour prouver qu’ils ont le même cardinal. Pour cela, on exploite la symétrie de la marche, comme illustré figure <a href="#fig-reflex" class="quarto-xref">Figure&nbsp;4</a>.</p>
<p>Considérons un chemin <span class="math inline">(S_m,\ldots,S_n)</span> de <span class="math inline">(m,a)</span> à <span class="math inline">(n,b)</span> passant par <span class="math inline">0</span> pour la première fois en <span class="math inline">p</span>. On a alors <span class="math inline">m&lt;p&lt;n</span>. On construit un chemin <span class="math inline">(\widetilde{S}_m,\ldots,\widetilde{S}_n)</span> de <span class="math inline">(m,a)</span> à <span class="math inline">(n,-b)</span> en gardant la première partie du chemin initial de <span class="math inline">(m,a)</span> à <span class="math inline">(p,0)</span>, puis en prenant ensuite le symétrique du chemin initial par rapport à l’axe des abscisses de <span class="math inline">(p,0)</span> à <span class="math inline">(n,-b)</span> : <span class="math display">\begin{align*}
\widetilde{S}_k=\left\{
\begin{array}{lcl}
S_k &amp;\text{ si }&amp; m\leq k\leq p,\\
-S_k&amp;\text{ si }&amp; p\leq k\leq n.
\end{array}
\right.
\end{align*}</span> Cette application définit une bijection entre les deux ensembles de chemins. En effet, si on prend maintenant un chemin <span class="math inline">(\widetilde{S}_m,\ldots,\widetilde{S}_n)</span> de <span class="math inline">(m,a)</span> à <span class="math inline">(n,-b)</span>, comme il fait des pas de <span class="math inline">1</span>, que <span class="math inline">a&gt;0</span> et <span class="math inline">-b&lt;0</span>, ce chemin passe nécessairement par <span class="math inline">0</span>. Soit <span class="math inline">p</span> le premier instant où le chemin est en <span class="math inline">0</span>. On construit alors un chemin <span class="math inline">(S_m,\ldots,S_n)</span> de <span class="math inline">(m,a)</span> à <span class="math inline">(n,b)</span> passant par <span class="math inline">0</span> en posant <span class="math display">\begin{align*}
S_k=\left\{
\begin{array}{lcl}
\widetilde{S}_k &amp;\text{ si }&amp; m\leq k\leq p,\\
-\widetilde{S}_k&amp;\text{ si }&amp; p\leq k\leq n.
\end{array}
\right.
\end{align*}</span> Il y a donc le même nombre de chemins des deux types.</p>
</div>
<p>A nouveau, nous n’avons pas utilisé le fait que <span class="math inline">\mathbb P(X=1)=\mathbb P(X=-1)</span>, mais uniquement le fait que <span class="math inline">X</span> ne peut prendre que les valeurs <span class="math inline">-1</span> et <span class="math inline">1</span> qui sont symétriques l’une de l’autre. Le résultat ci-dessus est donc également valable pour les marches asymétriques où <span class="math inline">p=\mathbb P(X=1)=1-\mathbb P(X=-1)\neq \frac{1}{2}</span>. Une première application de cette propriété est le résultat suivant connu sous le nom de <em>théorème du scrutin</em>.</p>
<div id="thm-election" class="theorem">
<p><span class="theorem-title"><strong>Théorème 1 (du scrutin)</strong></span> Au cours d’une élection opposant deux candidates <span class="math inline">A</span> et <span class="math inline">B</span>, la candidate <span class="math inline">A</span> (resp. <span class="math inline">B</span>) a obtenu <span class="math inline">a</span> (resp. <span class="math inline">b</span>) voix, avec <span class="math inline">a&gt;b</span>. Alors la probabilité que <span class="math inline">A</span> ait été majoritaire (au sens large) tout au long du dépouillement est <span class="math display">
p=1-\frac{b}{a+1}.
</span></p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Preuve</em>. </span>Tous les dépouillement étant équiprobables, <span class="math inline">p</span> s’obtient comme le rapport du nombre de dépouillements avec <span class="math inline">A</span> en tête tout le long par le nombre total de dépouillements. On peut modéliser un dépouillement par une marche aléatoire <span class="math inline">(S_n)</span> (pas nécessairement symétrique) où <span class="math inline">S_n</span> est le nombre de voix d’avance de <span class="math inline">A</span> sur <span class="math inline">B</span> après le dépouillement du <span class="math inline">n</span>-ème bulletin.</p>
<p>Il y a en tout <span class="math inline">a+b</span> bulletins et à la fin <span class="math inline">a-b</span> voix d’avance de <span class="math inline">A</span> sur <span class="math inline">B</span>, donc le nombre total de dépouillements est le nombre de chemins de <span class="math inline">(0,0)</span> à <span class="math inline">(a+b,a-b)</span> et vaut <span class="math inline">\binom{a+b}{a}</span>.</p>
<p>Le nombre de dépouillements avec <span class="math inline">A</span> en tête tout le long correspond</p>
<ul>
<li>au nombre de chemins de <span class="math inline">(0,0)</span> à <span class="math inline">(a+b,a-b)</span> ne prenant aucune valeur strictement négative, autrement dit le nombre de chemins de <span class="math inline">(0,0)</span> à <span class="math inline">(a+b,a-b)</span> ne touchant pas <span class="math inline">-1</span>;</li>
<li>au nombre de chemins de <span class="math inline">(0,1)</span> à <span class="math inline">(a+b,a-b+1)</span> ne touchant pas <span class="math inline">0</span>, en décalant d’un cran les ordonnées;</li>
<li>au nombre total de chemins de <span class="math inline">(0,1)</span> à <span class="math inline">(a+b,a-b+1)</span> moins le nombre de chemins de <span class="math inline">(0,1)</span> à <span class="math inline">(a+b,a-b+1)</span> touchant <span class="math inline">0</span>;</li>
<li>au nombre total de chemins de <span class="math inline">(0,1)</span> à <span class="math inline">(a+b,a-b+1)</span> moins le nombre de chemins de <span class="math inline">(0,1)</span> à <span class="math inline">(a+b,-(a-b+1))</span> par le principe de réflexion.</li>
</ul>
<p>Il vaut donc <span class="math inline">\binom{a+b}{a}-\binom{a+b}{b-1}</span>. Ainsi <span class="math display">
\begin{align*}
p &amp;=\frac{\binom{a+b}{a}-\binom{a+b}{b-1}}{\binom{a+b}{a}}=1-\frac{\binom{a+b}{b-1}}{\binom{a+b}{a}} \\ &amp;=1-\frac{(a+b)!a!b!}{(b-1)!(a+1)!(a+b)!}=1-\frac{b}{a+1},
\end{align*}
</span> d’où le résultat.</p>
</div>
</section>
</section>
<section id="sec-chap03-infini" class="level2">
<h2 class="anchored" data-anchor-id="sec-chap03-infini">Comportement asymptotique</h2>
<p>On s’intéresse maintenant au comportement de la marche sans limite de temps. Parmi les questions d’intérêt, on peut se demander si elle revient à son point de départ <span class="math inline">x</span>, combien de fois et en combien de temps.</p>
<p>Comme les <span class="math inline">(X_n)_{n\geq 1}</span> sont indépendantes et de même loi intégrable, on peut appliquer la loi des grands nombres pour obtenir que <span class="math display">
\frac{S_n}{n}\xrightarrow[n\to\infty]{ps}\mathbb{E}[X_1]=0,
</span> ce qui ne donne aucune information sur le comportement en temps long de <span class="math inline">S_n</span>.</p>
<section id="sec-chap03-markov" class="level3">
<h3 class="anchored" data-anchor-id="sec-chap03-markov">Propriété de Markov et stationnarité</h3>
<p>Les deux propriétés suivantes sont des propriétés du processus et non plus seulement des trajectoires. Elles énoncent une certaine forme d’invariance de la marche au cours du temps. La première est une propriété d’absence de mémoire : la position future de la marche ne dépend que de sa position actuelle et pas de la trajectoire qui l’a amenée à cette position.</p>
<div id="prp-markov" class="theorem proposition">
<p><span class="theorem-title"><strong>Proposition 6 (Markov)</strong></span> Pour tout <span class="math inline">n\in\mathbb{N}</span> et pour tous <span class="math inline">(a_0,a_1,\ldots,a_{n+1})\in\mathbb{Z}^{n+2}</span>, on a <span class="math display">\begin{align*}
\mathbb{P}(S_{n+1}=a_{n+1}&amp; | S_n=a_n, S_{n-1}=a_{n-1},\ldots,S_1=a_1,S_0=a_0)\\
=\mathbb{P}(S_{n+1}=a_{n+1}&amp; | S_n=a_n).
\end{align*}</span></p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Preuve</em>. </span>Par définition des probabilités conditionnelles, on a <span class="math display">\begin{align*}
\mathbb{P}(S_{n+1}=a_{n+1} &amp;| S_n=a_n, S_{n-1}=a_{n-1},\ldots,S_1=a_1,S_0=a_0)\\
&amp;=\frac{\mathbb{P}(S_{n+1}=a_{n+1}, S_n=a_n, S_{n-1}=a_{n-1},\ldots,S_1=a_1,S_0=a_0)}{\mathbb{P}(S_n=a_n, S_{n-1}=a_{n-1},\ldots,S_1=a_1,S_0=a_0)}\\
&amp;=\frac{\mathbb{P}(X_{n+1}=a_{n+1}-a_n, S_n=a_n, S_{n-1}=a_{n-1},\ldots,S_1=a_1,S_0=a_0)}{\mathbb{P}(S_n=a_n, S_{n-1}=a_{n-1},\ldots,S_1=a_1,S_0=a_0)},
\end{align*}</span> puisque <span class="math inline">S_{n+1}=S_n+X_{n+1}</span>. Remarquons maintenant que <span class="math inline">X_{n+1}</span> est indépendante de <span class="math inline">X_1,\ldots, X_n</span>, donc de <span class="math inline">S_0,\ldots,S_n</span>. On obtient alors <span class="math display">\begin{align*}
\mathbb{P}(S_{n+1}=a_{n+1} &amp;| S_n=a_n, S_{n-1}=a_{n-1},\ldots,S_1=a_1,S_0=a_0)\\
&amp;=\frac{\mathbb{P}(X_{n+1}=a_{n+1}-a_n)\mathbb{P}(S_n=a_n, S_{n-1}=a_{n-1},\ldots,S_1=a_1,S_0=a_0)}{\mathbb{P}(S_n=a_n, S_{n-1}=a_{n-1},\ldots,S_1=a_1,S_0=a_0)}\\
&amp;=\mathbb{P}(X_{n+1}=a_{n+1}-a_n).
\end{align*}</span> Par ailleurs, par un raisonnement analogue on a <span class="math display">\begin{align*}
\mathbb{P}(S_{n+1}=a_{n+1} | S_n=a_n)
&amp;=\frac{\mathbb{P}(S_{n+1}=a_{n+1},S_n=a_n)}{\mathbb{P}(S_n=a_n)}\\
&amp;=\frac{\mathbb{P}(X_{n+1}=a_{n+1}-a_n,S_n=a_n)}{\mathbb{P}(S_n=a_n)}\\
&amp;=\frac{\mathbb{P}(X_{n+1}=a_{n+1}-a_n)\mathbb{P}(S_n=a_n)}{\mathbb{P}(S_n=a_n)}\\
&amp;=\mathbb{P}(X_{n+1}=a_{n+1}-a_n),
\end{align*}</span> d’où le résultat.</p>
</div>
<div id="prp-inde" class="theorem proposition">
<p><span class="theorem-title"><strong>Proposition 7</strong></span> Pour tout <span class="math inline">n &gt; m</span> entiers positifs <span class="math inline">S_n-S_m</span> est indépendant de <span class="math inline">(S_0,S_1,\ldots, S_m)</span>.</p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Preuve</em>. </span>Comme les <span class="math inline">(X_n)</span> sont indépendantes, on a directement que <span class="math display">
S_n-S_m=\sum_{k=m+1}^nX_k,
</span> qui est indépendant de <span class="math inline">(S_0=x,S_1=x+X_1,\ldots, S_m=x+\sum_{k=1}^mX_k)</span>.</p>
</div>
<p>On a un résultat analogue à la propriété de Markov lorsqu’on regarde deux pas de temps plus éloignés.</p>
<div id="cor-mark" class="theorem corollary">
<p><span class="theorem-title"><strong>Corollaire 3</strong></span> Pour tout <span class="math inline">n&gt;m</span> entiers positifs et pour tous <span class="math inline">(a_0,a_1,\ldots,a_m,a_{n})\in\mathbb{Z}^{m+2}</span>, on a <span class="math display">\begin{align*}
\mathbb{P}(S_{n}=a_{n}&amp; | S_m=a_m, S_{m-1}=a_{m-1},\ldots,S_1=a_1,S_0=a_0)\\
=\mathbb{P}(S_{n}=a_{n}&amp; | S_m=a_m).
\end{align*}</span></p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Preuve</em>. </span>Par un raisonnement analogue à la preuve de la propriété de Markov, on obtient <span class="math display">\begin{align*}
\mathbb{P}(S_{n}=a_{n}&amp;| S_m=a_m, S_{m-1}=a_{m-1},\ldots,S_1=a_1,S_0=a_0)\\
&amp;=\frac{\mathbb{P}(S_{n}=a_{n},S_m=a_m, S_{m-1}=a_{m-1},\ldots,S_1=a_1,S_0=a_0)}{\mathbb{P}(S_m=a_m, S_{m-1}=a_{m-1},\ldots,S_1=a_1,S_0=a_0)}\\
&amp;=\frac{\mathbb{P}(S_{n}-S_m=a_{n}-a_m,S_m=a_m, S_{m-1}=a_{m-1},\ldots,S_1=a_1,S_0=a_0)}{\mathbb{P}(S_m=a_m, S_{m-1}=a_{m-1},\ldots,S_1=a_1,S_0=a_0)}\\
&amp;=\frac{\mathbb{P}(S_{n}-S_m=a_{n}-a_m)\mathbb{P}(S_m=a_m, S_{m-1}=a_{m-1},\ldots,S_1=a_1,S_0=a_0)}{\mathbb{P}(S_m=a_m, S_{m-1}=a_{m-1},\ldots,S_1=a_1,S_0=a_0)}\\
&amp;=\mathbb{P}(S_{n}-S_m=a_{n}-a_m)\\
&amp;=\mathbb{P}(S_n=a_n|S_m=a_m),
\end{align*}</span> en utilisant la propriété des accroissement indépendants.</p>
</div>
<p>La seconde propriété dite de stationnarité signifie qu’on peut changer l’origine du repère sans influence sur le comportement futur de la marche.</p>
<div id="prp-statio" class="theorem proposition">
<p><span class="theorem-title"><strong>Proposition 8 (Sationnarité)</strong></span> Pour tout <span class="math inline">n&gt;m</span> entiers positifs et <span class="math inline">(a,b)\in\mathbb{Z}^2</span>, on a <span class="math display">
\mathbb{P}(S_n=b|S_m=a)=\mathbb{P}(S_{n-m}= b-a|S_0= 0).
</span></p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Preuve</em>. </span>En utilisant l’indépendance des accroissements, on obtient <span class="math display">\begin{align*}
\mathbb{P}(S_n=b|S_m=a)
&amp;=\frac{\mathbb{P}(S_n=b,S_m=a)}{\mathbb{P}(S_m=a)}\\
&amp;=\frac{\mathbb{P}(S_n-S_m=b-a,S_m=a)}{\mathbb{P}(S_m=a)}\\
&amp;=\frac{\mathbb{P}(S_n-S_m=b-a)\mathbb{P}(S_m=a)}{\mathbb{P}(S_m=a)}\\
&amp;=\mathbb{P}(S_n-S_m=b-a)\\
&amp;=\mathbb{P}(\sum_{k=m+1}^nX_k=b-a)\\
&amp;=\mathbb{P}(\sum_{k=1}^{n-m}X_k=b-a)\\
&amp;=\mathbb{P}(S_{n-m}=b-a|S_0=0),
\end{align*}</span> car les <span class="math inline">(X_n)</span> sont indépendantes et de même loi.</p>
</div>
</section>
<section id="sec-chap03-retour" class="level3">
<h3 class="anchored" data-anchor-id="sec-chap03-retour">Premier retour en <span class="math inline">0</span></h3>
<p>On suppose maintenant que la marche part de <span class="math inline">0</span> : <span class="math inline">S_0=0</span> et on cherche à savoir si la marche reviendra en <span class="math inline">0</span> presque sûrement. Commençons par remarquer que si <span class="math inline">S_n=0</span> alors <span class="math inline">n</span> est nécessairement pair.</p>
<div id="prp-retour" class="theorem proposition">
<p><span class="theorem-title"><strong>Proposition 9</strong></span> Pour tout <span class="math inline">n\in\mathbb{N}</span>, on a <span class="math display">
\mathbb{P}(S_{2n}=0)=\frac{1}{4^n}\binom{2n}{n}.
</span></p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Preuve</em>. </span>Cette probabilité correspond au nombre de chemins de <span class="math inline">(0,0)</span> à <span class="math inline">(2n,0)</span> divisé par le nombre total de chemins de longueur <span class="math inline">2n</span>, puisque tous les chemins sont équiprobables. On a donc directement <span class="math inline">\mathbb{P}(S_{2n}=0)=\frac{\binom{2n}n}{4^n}</span>.</p>
</div>
<p>On s’intéresse maintenant au premier instant de retour en <span class="math inline">0</span>. On le note <span class="math inline">T_0</span>. Il s’agit donc de la variable aléatoire <span class="math display">
T_0=\inf\{n\geq 1; S_n=0\},
</span> avec la convention que <span class="math inline">\inf\emptyset= +\infty</span>. C’est donc une variable aléatoire discrète à valeurs dans <span class="math inline">\mathbb{N}^*\cup\{+\infty\}</span>. On peut calculer explicitement la loi de <span class="math inline">T_0</span>.</p>
<div id="prp-ret2" class="theorem proposition">
<p><span class="theorem-title"><strong>Proposition 10</strong></span> Pour tout <span class="math inline">n\in\mathbb{N}^*</span>, on a <span class="math display">
\mathbb{P}(T_0=2n)=\frac{(2n-2)!}{2^{2n-1}n!(n-1)!}.
</span></p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Preuve</em>. </span>L’événement <span class="math inline">(T_0= 2n)</span> correspond à <span class="math inline">(S_2\neq 0, \ldots,S_{2n-2}\neq 0,S_{2n}=0)</span> puisqu’alors <span class="math inline">2n</span> est le premier temps où la marche retourne en <span class="math inline">0</span>. En particulier, entre l’instant <span class="math inline">0</span> et l’instant <span class="math inline">2n</span> la marche ne change pas de signe, et garde le signe de <span class="math inline">S_1</span>. Ainsi, on a <span class="math display">\begin{align*}
\mathbb{P}(T_0=2n)&amp;=\mathbb{P}(S_1=1,S_2&gt;0,\ldots,S_{2n-2}&gt;0,S_{2n}=0)\\
&amp;\quad+\mathbb{P}(S_1=-1,S_2&lt;0,\ldots,S_{2n-2}&lt;0,S_{2n}=0).
\end{align*}</span> Par symétrie, ces deux probabilités sont égales. De plus, si <span class="math inline">S_{2n-2}&gt;0</span> et <span class="math inline">S_{2n}=0</span> alors nécessairement on a <span class="math inline">S_{2n-1}=1</span>. Ainsi il vient <span class="math display">\begin{align*}
{\mathbb{P}(T_0=2n)}\\
&amp;=2\mathbb{P}(S_1=1,S_2&gt;0,\ldots,S_{2n-2}&gt;0,S_{2n-1}=1,S_{2n}=0)\\
&amp;=2\mathbb{P}(S_{2n}=0|S_1=1,S_2&gt;0,\ldots,S_{2n-2}&gt;0,S_{2n-1}=1)\\
&amp;\quad \times\mathbb{P}(S_1=1,S_2&gt;0,\ldots,S_{2n-2}&gt;0,S_{2n-1}=1)\\
&amp;=2\mathbb{P}(S_{2n}=0|S_{2n-1}=1)\mathbb{P}(S_1=1,S_2&gt;0,\ldots,S_{2n-2}&gt;0,S_{2n-1}=1)\\
&amp;=2\mathbb{P}(S_{1}=-1|S_0=0)\mathbb{P}(S_1=1,S_2&gt;0,\ldots,S_{2n-2}&gt;0,S_{2n-1}=1)\\
&amp;=\mathbb{P}(S_1=1,S_2&gt;0,\ldots,S_{2n-2}&gt;0,S_{2n-1}=1),
\end{align*}</span> en utilisant la propriété de Markov, la propriété de stationnarité puis le fait que <span class="math display">
{\mathbb P}(S_1=-1|S_0=0) = {\mathbb P}(X_1=-1) = \frac{1}{2}.
</span> Cette dernière probabilité correspond au nombre de chemins de <span class="math inline">(1,1)</span> à <span class="math inline">(2n-1,1)</span> ne touchant pas <span class="math inline">0</span> divisée par le nombre total de chemins de longueur <span class="math inline">2n-1</span>. En utilisant le principe de réflexion, on obtient <span class="math display">\begin{align*}
\mathbb{P}(T_0=2n)
&amp;=\frac{\binom{2n-2}{n-1}-\binom{2n-2}{n}}{2^{2n-1}}\\
&amp;=\frac{1}{2^{2n-1}}\left(\frac{(2n-2)!}{(n-1)!(n-1)!}-\frac{(2n-2)!}{n!(n-2)!}\right)\\
&amp;=\frac{1}{2^{2n-1}}\frac{(2n-2)!}{(n-1)!(n-2)!}\left(\frac{1}{n-1}-\frac{1}{n}\right)\\
&amp;=\frac{(2n-2)!}{2^{2n-1}n!(n-1)!},
\end{align*}</span> d’où le résultat.</p>
</div>
<p>Nous pouvons maintenant énoncer le résultat principal de cette partie.</p>
<div id="thm-retour-ma" class="theorem">
<p><span class="theorem-title"><strong>Théorème 2</strong></span> La marche aléatoire partant de <span class="math inline">0</span> revient en <span class="math inline">0</span> en temps fini avec probabilité <span class="math inline">1</span>, <span class="math inline">i.e.</span> <span class="math display">
\mathbb{P}(T_0 &lt; +\infty)=1.
</span></p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Preuve</em>. </span>On a <span class="math inline">\mathbb{P}(T_0&lt;+\infty)=\sum_{n=1}^\infty\mathbb{P}(T_0=2n)</span>, il s’agit donc d’identifier la somme de cette série. Pour cela, on exprime différemment le probabilité de l’événement <span class="math inline">(T_0=2n)</span>, en repartant de l’expression du nombre de chemins de <span class="math inline">(1,1)</span> à <span class="math inline">(2n-1,1)</span> ne touchant pas <span class="math inline">0</span> divisée par le nombre total de chemins de longueur <span class="math inline">2n-1</span>. Ce nombre de chemins est égal à la différence entre le nombre de chemins de <span class="math inline">(1,1)</span> à <span class="math inline">(2n-1,1)</span> et le nombre de chemins de <span class="math inline">(1,1)</span> à <span class="math inline">(2n-1,-1)</span> d’après le principe de réflexion. On obtient ainsi : <span class="math display">\begin{align*}
{\mathbb{P}(T_0=2n)}\\
&amp;=\mathbb{P}(S_1=1, S_{2n-1}=1)-\mathbb{P}(S_1=1, S_{2n-1}=-1)\\
&amp;=\mathbb{P}(S_{2n-1}=1|S_1=1)\mathbb{P}(S_1=1)-\mathbb{P}(S_{2n-1}=-1|S_1=1)\mathbb{P}(S_1=1)\\
&amp;=\frac{1}{2}\mathbb{P}(S_{2n-2}=0|S_0=0)-\frac{1}{2}\mathbb{P}(S_{2n-2}=-2|S_0=0)\\
&amp;=\frac{1}{2}\mathbb{P}(S_{2n-2}=0)-\frac{1}{2}\mathbb{P}(S_{2n-2}=-2),
\end{align*}</span> par la propriété de stationnarité et puisque <span class="math inline">S_0=0</span>. Par ailleurs, on a <span class="math display">\begin{align*}
{\mathbb{P}(S_{2n}=0)}  \\
&amp;=\mathbb{P}(S_{2n}=0, S_{2n-2} =-2)+\mathbb{P}(S_{2n}=0, S_{2n-2}=0) +\mathbb{P}(S_{2n}=0, S_{2n-2}=2)\\
&amp;=2\mathbb{P}(S_{2n}=0, S_{2n-2}=-2)+\mathbb{P}(S_{2n}=0, S_{2n-2}=0),
\end{align*}</span> par symétrie. Il vient <span class="math display">\begin{align*}
{\mathbb{P}(S_{2n}=0)}\\
&amp;=2\mathbb{P}(S_{2n}=0|S_{2n-2}=-2)\mathbb{P}(S_{2n-2}=-2)+\mathbb{P}(S_{2n}=0|S_{2n-2}=0)\mathbb{P}(S_{2n-2}=0)\\
&amp;=2\mathbb{P}(S_2=2|S_0=0)\mathbb{P}(S_{2n-2}=-2)+\mathbb{P}(S_2=0|S_0=0)\mathbb{P}(S_{2n-2}=0)\\
&amp;=2\frac{1}{4}\mathbb{P}(S_{2n-2}=-2)+\frac{1}{2}\mathbb{P}(S_{2n-2}=0)\\
&amp;=\frac{1}{2}\mathbb{P}(S_{2n-2}=-2)+\frac{1}{2}\mathbb{P}(S_{2n-2}=0),
\end{align*}</span> où on a utilisé le fait que <span class="math display">\begin{align*}
\mathbb{P}(S_2=2|S_0=0)&amp; =   \mathbb{P}(X_1 + X_2 = 0) \\
&amp;= \mathbb{P}(X_1 = -1; X_2= 1)+ \mathbb{P}(X_1 = 1; X_2= -1)\\
&amp;=\mathbb{P}(X_1 = -1) \mathbb{P}( X_2= 1)+ \mathbb{P}(X_1 = 1)\mathbb{P}( X_2= -1) \\
&amp;=\frac{1}{2}.
\end{align*}</span> Donc on a <span class="math inline">\mathbb{P}(S_{2n-2}=-2)=2\mathbb{P}(S_{2n}=0)-\mathbb{P}(S_{2n-2}=0)</span>.</p>
<p>Revenons maintenant à <span class="math inline">T_0</span>. On obtient <span class="math display">\begin{align*}
\mathbb{P}(T_0=2n)
&amp;=\frac{1}{2}\mathbb{P}(S_{2n-2}=0)-\frac{1}{2}\mathbb{P}(S_{2n-2}=-2)\\
&amp;=\frac{1}{2}\mathbb{P}(S_{2n-2}=0)-\mathbb{P}(S_{2n}=0)+\frac{1}{2}\mathbb{P}(S_{2n-2}=0)\\
&amp;=\mathbb{P}(S_{2n-2}=0)-\mathbb{P}(S_{2n}=0).
\end{align*}</span> Ainsi, la probabilité de l’événement <span class="math inline">(T_0= +\infty)</span> peut s’écrire à l’aide d’une somme télescopique : <span class="math display">\begin{align*}
\mathbb{P}(T_0=+\infty)
&amp;=1-\sum_{n=1}^\infty\mathbb{P}(T_0=2n)\\
&amp;=1-\lim_{N\to\infty}\sum_{n=1}^N\mathbb{P}(T_0=2n)\\
&amp;=1-\lim_{N\to\infty}\sum_{n=1}^N\left(\mathbb{P}(S_{2n-2}=0)-\mathbb{P}(S_{2n}=0)\right)\\
&amp;=1-\lim_{N\to\infty}\left(\mathbb{P}(S_0=0)-\mathbb{P}(S_{2N}=0)\right)\\
&amp;=\lim_{N\to\infty}\mathbb{P}(S_{2N}=0)\\
&amp;=\lim_{N\to\infty}\frac{1}{4^N}\binom{2N}{N}.
\end{align*}</span> En utilisant la formule de Stirling, on obtient l’équivalence <span class="math display">\begin{align*}
\frac{1}{4^N}\binom{2N}{N} &amp;= \frac{1}{4^N}\frac{(2N)!}{N!N!}
\sim  \frac{1}{4^N}\frac{(2N)^{2N}\sqrt{4\pi N}e^{-2N}}{(N^{N}\sqrt{2\pi N}e^{-N})^2}
= \frac{1}{\sqrt{\pi N}},
\end{align*}</span> donc on a bien <span class="math inline">\mathbb{P}(T_0=+\infty)=0</span>.</p>
</div>
</section>
<section id="sec-chap03-passage" class="level3">
<h3 class="anchored" data-anchor-id="sec-chap03-passage">Premier passage en <span class="math inline">a\neq 0</span></h3>
<p>On peut obtenir par une méthode similaire la loi du temps d’atteinte de n’importe quel autre point. Soit <span class="math inline">a\in\mathbb{Z}^*</span>. Le temps d’atteinte de <span class="math inline">a</span> est la variable aléatoire <span class="math display">
T_a=\inf\{n\geq 1; S_n=a\}.
</span></p>
<div id="thm-pass" class="theorem">
<p><span class="theorem-title"><strong>Théorème 3</strong></span> La marche aléatoire partant de <span class="math inline">0</span> atteint tout état <span class="math inline">a\in\mathbb{Z}</span> en temps fini avec probabilité <span class="math inline">1</span>. Plus précisément, si <span class="math inline">a\neq 0</span>, on a <span class="math inline">\mathbb{P}(T_a=n)=0</span> si <span class="math inline">n</span> et <span class="math inline">a</span> n’ont pas la même parité ou si <span class="math inline">|a|&gt;n</span>, et sinon <span class="math display">
\mathbb{P}(T_a=n)=\frac{|a|}{n2^n}\binom{n}{\frac{n+a}{2}}.
</span></p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Preuve</em>. </span>On suit les mêmes étapes que ce qu’on a fait pour <span class="math inline">T_0</span>. Les contraintes de parité et de longueur de chemin ont déjà été vues. Si <span class="math inline">n</span> et <span class="math inline">a</span> ont la même parité et que <span class="math inline">|a|&gt;n</span>, alors l’événement <span class="math inline">(T_a= n)</span> correspond à <span class="math inline">(S_1\neq a, \ldots,S_{n-1}\neq a,S_{n}=a)</span> puisqu’alors <span class="math inline">n</span> est le premier temps où la marche atteint <span class="math inline">a</span>. Supposons sans perte de généralité que <span class="math inline">a&gt;0</span>. Donc la probabilité <span class="math inline">\mathbb{P}(T_a= n)</span> est égale au nombre de chemins de <span class="math inline">(0,0)</span> à <span class="math inline">(n,a)</span> ne touchant pas <span class="math inline">a</span> avant <span class="math inline">n</span> divisée par le nombre total de chemins de longueur <span class="math inline">n</span>. 0r, ce nombre de chemin est égal</p>
<ul>
<li>au nombre de chemins de <span class="math inline">(0,0)</span> à <span class="math inline">(n-1,a-1)</span> ne touchant pas <span class="math inline">a</span></li>
<li>au nombre de chemins de <span class="math inline">(0,0)</span> à <span class="math inline">(n-1,a-1)</span> - le nombre de chemins de <span class="math inline">(0,0)</span> à <span class="math inline">(n-1,a-1)</span> touchant <span class="math inline">a</span></li>
<li>au nombre de chemins de <span class="math inline">(0,0)</span> à <span class="math inline">(n-1,a-1)</span> - le nombre de chemins de <span class="math inline">(0,-a)</span> à <span class="math inline">(n-1,-1)</span> touchant <span class="math inline">0</span></li>
<li>au nombre de chemins de <span class="math inline">(0,0)</span> à <span class="math inline">(n-1,a-1)</span> - le nombre de chemins de <span class="math inline">(0,-a)</span> à <span class="math inline">(n-1,1)</span></li>
<li>au nombre de chemins de <span class="math inline">(0,0)</span> à <span class="math inline">(n-1,a-1)</span> - le nombre de chemins de <span class="math inline">(0,0)</span> à <span class="math inline">(n-1,a+1)</span></li>
</ul>
<p>Ainsi, on a <span class="math display">\begin{align*}
\mathbb{P}(T_a=n)
&amp;=\frac{\binom{n-1}{\frac{n-1}{2}+\frac{a-1}{2}}-\binom{n-1}{\frac{n-1}{2}+\frac{1+a}{2}}}{2^{n}}\\
&amp;=\frac{1}{2^{n}}\left(\frac{(n-1)!}{(\frac{n+a-2}{2})!(\frac{n-a}{2})!}-\frac{(n-1)!}{(\frac{n+a}{2})!(\frac{n-a-2}{2})!}\right)\\
&amp;=\frac{1}{2^n}\frac{(n-1)!}{(\frac{n+a-2}{2})!(\frac{n-a-2}{2})!}\left(\frac{1}{\frac{n-a}{2}}-\frac{1}{\frac{n+a}{2}}\right)\\
&amp;=\frac{a}{2^n}\frac{(n-1)!}{(\frac{n+a}{2})!(\frac{n-a}{2})!}\\
&amp;=\frac{a}{n2^n}\binom{n}{\frac{n+a}{2}}
\end{align*}</span> d’où le résultat.</p>
<p>Nous démontrerons dans la partie suivante que <span class="math inline">\mathbb{P}(T_a&lt;+\infty)=1</span>.</p>
</div>
<p>En particulier, la marche partant de <span class="math inline">0</span> va atteindre tout point de <span class="math inline">\mathbb{Z}</span> avec probabilité <span class="math inline">1</span>, donc elle est presque sûrement non bornée.</p>
</section>
</section>
<section id="sec-chap03-ruine" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="sec-chap03-ruine">La ruine de la joueuse</h2>
<p>On s’intéresse maintenant à un problème de ruine. Une joueuse dispose d’un capital initial <span class="math inline">x</span>. Elle joue à pile ou face avec une pièce équilibrée, et gagne <span class="math inline">1</span> si elle obtient pile, perd <span class="math inline">1</span> si elle obtient face. La joueuse s’est fixé un objectif de gain <span class="math inline">a\geq x</span> et un plancher de perte <span class="math inline">b\leq x</span>. Elle joue jusqu’à ce que sa richesse atteigne <span class="math inline">a</span> ou <span class="math inline">b</span>.</p>
<p>On modélise la fortune de la joueuse par une marche aléatoire <span class="math inline">(S_n)_{n\in\mathbb{N}}</span>, avec <span class="math inline">S_0=x</span> et <span class="math inline">S_n=S_0+\sum_{k=1}^n X_k</span>, où <span class="math inline">X_k</span> représente le gain du <span class="math inline">k</span>-ème tirage.</p>
<p>On sait qu’atteindre <span class="math inline">a</span> ou <span class="math inline">b</span> partant de <span class="math inline">x</span> est équivalent à atteindre <span class="math inline">a-x</span> ou <span class="math inline">b-x</span> partant de <span class="math inline">0</span>. Le jeu s’arrête donc presque sûrement au bout d’un temps fini.</p>
<p>On note <span class="math inline">p_x</span> la probabilité de ruine partant d’un capital initial <span class="math inline">x</span>, et <span class="math inline">R_x</span> l’événement <em>être ruinée en partant de <span class="math inline">x</span></em>, c’est-à-dire <span class="math display">
p_x=\mathbb{P}(T_b &lt; T_a)= \mathbb{P}(R_x).
</span> On peut remarquer directement que <span class="math inline">p_a=0</span> et <span class="math inline">p_b=1</span> puisque dans ces deux situations, le jeu ne démarre pas, la ruine est impossible dans le premier cas, et certaine dans le second.</p>
<p>Nous allons obtenir une formule de récurrence sur les <span class="math inline">p_x</span>. Si <span class="math inline">b&lt;x&lt;a</span>, on a par la formule des probabilités totales <span class="math display">\begin{align*}
p_x&amp;=\mathbb{P}(R_x)\\
&amp;=\mathbb{P}(R_x|S_1=x+1)\mathbb{P}(S_1=x+1)+\mathbb{P}(R_x|S_1=x-1)\mathbb{P}(S_1=x-1)\\
&amp;=\mathbb{P}(R_{x+1})\frac{1}{2}+\mathbb{P}(R_{x-1})\frac{1}{2},
\end{align*}</span> en utilisant la stationnarité. On obtient ainsi que <span class="math inline">(p_x)_{a&lt;x&lt; b}</span> est une suite récurrente linéaire<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> d’ordre <span class="math inline">2</span>, de polynôme caractéristique <span class="math inline">X^2-2X+1=(X-1)^2</span>. Ainsi <span class="math inline">p_x=\alpha +\beta x</span>. On identifie <span class="math inline">\alpha</span> et <span class="math inline">\beta</span> avec les conditions extrémales <span class="math inline">p_a=0</span> et <span class="math inline">p_b=1</span> <span class="math display">\begin{align*}
\left\{\begin{array}{rcl}
p_a=0&amp;=&amp;\alpha+\beta a\\
p_b=1&amp;=&amp;\alpha+\beta b
\end{array}
\right.
\Leftrightarrow
\left\{\begin{array}{rcl}
\alpha&amp;=&amp;\frac{a}{a-b},\\
\beta&amp;=&amp;-\frac{1}{a-b}.
\end{array}
\right.
\end{align*}</span></p>
<div class="no-row-height column-margin column-container"><p><sup>1</sup>&nbsp;Une suite <span class="math inline">(u_n)_{n \in {\mathbb N}}</span> est dite <strong>récurrente linéaire d’ordre <span class="math inline">2</span></strong> s’il existe <span class="math inline">(a,b)\in\mathbb{R}\times\mathbb{R}^*</span> tel que, pour entier <span class="math inline">n</span>, on a <span class="math display">
u_{n+2} = a u_{n+1} + b u_n .
</span> Le polynôme <span class="math inline">X^2 - a X + b</span> est appelé le <strong>polynôme caractéristique</strong> de la suite. Si le polynôme caractéristique admet deux racines simples <span class="math inline">r_1</span> et <span class="math inline">r_2</span>, alors il existe deux réels <span class="math inline">\alpha</span> et <span class="math inline">\beta</span> tels que pour tout entier <span class="math inline">n</span>, <span class="math display">
u_n = \alpha r_1^n  + \beta  r_2^n.
</span> Si le polynôme caractéristique admet une racine double <span class="math inline">r</span>, alors il existe deux réels <span class="math inline">\alpha</span> et <span class="math inline">\beta</span> tels que pour tout entier <span class="math inline">n</span>, <span class="math display">
u_n = (\alpha  + \beta n) r^n.
</span></p></div><p>Ainsi la probabilité de ruine partant de <span class="math inline">x</span> vaut <span class="math display">
p_x=\frac{a-x}{a-b}.
</span></p>
<p>Un calcul analogue en cherchant la probabilité <span class="math inline">q_x</span> de faire fortune partant d’une richesse <span class="math inline">x</span> conduit à <span class="math inline">q_x=\frac{x-b}{a-b}=1-p_x</span>, autrement dit il n’y a pas d’autre issue possible : le jeu va s’arrêter avec probabilité <span class="math inline">1</span>. Si on fait tendre <span class="math inline">b</span> vers <span class="math inline">-\infty</span>, on trouve que <span class="math inline">\mathbb{P}(T_a&lt;\infty |x_0=a)=1</span>. Donc partant de n’importe quel point, la marche atteindra n’importe quel autre point avec probabilité <span class="math inline">1</span>.</p>
<p>On peut montrer avec un raisonnement analogue que la durée du jeu <span class="math inline">d_x</span> partant de <span class="math inline">x</span> est solution de l’équation récurrente linéaire avec second membre<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> <span class="math display">
d_x=\frac{1}{2}(d_{x+1}+d_{x-1})+1,
</span> avec <span class="math inline">d_a=d_b=0</span>.</p>
<div class="no-row-height column-margin column-container"><p><sup>2</sup>&nbsp;Une suite <span class="math inline">(u_n)_{n \in {\mathbb N}}</span> est dite <strong>récurrente linéaire d’ordre <span class="math inline">2</span> avec second membre</strong> s’il existe <span class="math inline">(a,b) \in {\mathbb R} \times {\mathbb R}^*</span> et une fonction <span class="math inline">f</span> à valeurs dans <span class="math inline">{\mathbb R}</span> tels que, pour entier <span class="math inline">n</span>, on a <span class="math display">
u_{n+2} = a u_{n+1} + b u_n  + f(n).
</span> L’équation <span class="math inline">\displaystyle u_{n+2} = a u_{n+1} + b u_n</span> s’appelle alors l’équation homogène associée. Les solutions de l’équation avec second membre sont la somme de la solution générique de l’équation homogène et d’une solution particulière de l’équation avec second membre.</p></div><p>En effet, il est clair que <span class="math inline">d_a=d_b=0</span>, et si <span class="math inline">a&lt;x&lt;b</span>, alors on a <span class="math inline">d_x=\mathbb{E}(T_a\wedge T_b)</span>. Attention, la variable aléatoire <span class="math inline">T_a\wedge T_b</span> est à valeurs dans <span class="math inline">\mathbb{N}\cup\{+\infty\}</span>. Si <span class="math inline">\mathbb{P}(T_a\wedge T_b=+\infty|S_0=x)&gt;0</span>, alors <span class="math inline">\mathbb{E}(T_a\wedge T_b)=+\infty</span>. Par ailleurs, partant de <span class="math inline">x+1</span>, on a <span class="math display">\begin{align*}
\mathbb{P}(T_a\wedge T_b=+\infty|S_0=x+1)&amp;\geq \mathbb{P}(T_a\wedge T_b=+\infty, S_1=x|S_0=x+1)\\
&amp;= \mathbb{P}(T_a\wedge T_b=+\infty|S_1=x,S_0=x+1)\mathbb{P}(S_1=x|S_0=x+1)\\
&amp;=\frac{1}{2}\mathbb{P}(T_a\wedge T_b=+\infty|S_0=x)
\end{align*}</span> par les propriétés de Markov et de stationnarité. Donc <span class="math inline">\mathbb{P}(T_a\wedge T_b=+\infty|S_0=x+1)&gt;0</span>. Ainsi, les membres de gauche et de droite de l’équation <span class="math inline">d_x=\frac{1}{2}(d_{x+1}+d_{x-1})+1</span> valent tous les deux <span class="math inline">+\infty</span>, et l’égalité est vraie. On montrerait de même que <span class="math inline">\mathbb{P}(T_a\wedge T_b=+\infty|S_0=x)&gt;0</span> implique <span class="math inline">\mathbb{P}(T_a\wedge T_b=+\infty|S_0=x-1)&gt;0</span>, et par contraposée et décalage d’indices que <span class="math inline">\mathbb{P}(T_a\wedge T_b=+\infty|S_0=x)=0</span> implique <span class="math inline">\mathbb{P}(T_a\wedge T_b=+\infty|S_0=x+1)=\mathbb{P}(T_a\wedge T_b=+\infty|S_0=x-1)=0</span>. Plaçons nous dans ce dernier cas. On a donc <span class="math display">\begin{align*}
d_x&amp;=\mathbb{E}(T_a\wedge T_b)\\
&amp;=\sum_{k=1}^\infty k \mathbb{P}(T_a\wedge T_b=k|S_0=x)\\
&amp;=\sum_{k=1}^\infty k \big(\mathbb{P}(T_a\wedge T_b=k|S_1=x+1)\mathbb{P}(S_1=x+1)+\mathbb{P}(T_a\wedge T_b=k|S_1=x-1)\mathbb{P}(S_1=x-1)\big)\\
&amp;=\frac{1}{2}\sum_{k=1}^\infty k \mathbb{P}(T_a\wedge T_b=k-1|S_0=x+1)+\frac{1}{2}\sum_{k=1}^\infty k\mathbb{P}(T_a\wedge T_b=k-1|S_0=x-1)\\
&amp;=\frac{1}{2}\sum_{j=0}^\infty (j+1) \mathbb{P}(T_a\wedge T_b=j|S_0=x+1)+\frac{1}{2}\sum_{j=0}^\infty (j+1)\mathbb{P}(T_a\wedge T_b=j|S_0=x-1)\\
&amp;=\frac{1}{2}\sum_{j=0}^\infty j \mathbb{P}(T_a\wedge T_b=j|S_0=x+1)+\frac{1}{2}\sum_{j=0}^\infty j\mathbb{P}(T_a\wedge T_b=j|S_0=x-1)+1\\
&amp;=1+\frac{1}{2}\mathbb{E}(T_a\wedge T_b|S_0=x+1)+\frac{1}{2}\mathbb{E}(T_a\wedge T_b|S_0=x-1)\\
&amp;=1+\frac{1}{2}(d_{x+1}+d_{x-1}).
\end{align*}</span> % Cherchons une solution particulière sous la forme <span class="math inline">cn^2</span> (puisque les constantes et les multiples de <span class="math inline">n</span> sont solutions de l’équation homogène) : <span class="math display">\begin{align*}
cn^2=\frac{1}{2}(c(n+1)^2+c(n-1)^2)+1
&amp;\Leftrightarrow
cn^2=\frac{1}{2}(cn^2+c+2cn+cn^2+c-2cn)+1\\
&amp;\Leftrightarrow
cn^2=cn^2+c+1\\
&amp;\Leftrightarrow
c=-1.
\end{align*}</span> % Ansi, <span class="math inline">d</span> est la somme d’une solution homogène et d’une solution particulière, donc <span class="math display">d_x=\alpha +\beta x-x^2.</span> En utilisant <span class="math inline">d_a=d_b=0</span>, on trouve <span class="math inline">\alpha</span> et <span class="math inline">\beta</span> <span class="math display">\begin{align*}
\left\{\begin{array}{rcl}
d_a=0&amp;=&amp;\alpha+\beta a-a^2\\
d_b=0&amp;=&amp;\alpha+\beta b-b^2
\end{array}
\right.
\Leftrightarrow
\left\{\begin{array}{rcl}
\alpha&amp;=-ab,\\
\beta&amp;=a+b.
\end{array}
\right.
\end{align*}</span> Finalement, on obtient que <span class="math inline">d_x=-ab+x(a+b)-x^2</span>.</p>
<p>En particulier, si <span class="math inline">x=0</span> et <span class="math inline">b</span> tend vers <span class="math inline">-\infty</span>, on obtient que <span class="math inline">\mathbb{E}[T_a]=+\infty</span>. On sait que la marche partant de <span class="math inline">0</span> atteindra <span class="math inline">a</span> presque sûrement en temps fini, cependant ce temps est en moyenne infini.</p>
</section>
<section id="sec-chap03-MB" class="level2">
<h2 class="anchored" data-anchor-id="sec-chap03-MB">De la marche aléatoire vers le mouvement brownien</h2>
<p>On s’intéresse maintenant à une autre forme de comportement asymptotique de la marche aléatoire. Nous allons la renormaliser pour la contraindre à rester dans l’intervalle de temps <span class="math inline">[0,1]</span>. Pour cela, pour tout <span class="math inline">N\in\mathbb{N}^*</span>, on pose <span class="math display">
B^N_t  =\frac{1}{\sqrt{N}} S_{\lfloor Nt \rfloor} = \frac{1}{\sqrt{N}} \sum_{k=1}^{\lfloor Nt \rfloor} X_k.
</span></p>
<p>Alors la suite <span class="math inline">(B^N_t)</span> converge en loi lorsque <span class="math inline">N</span> tend vers l’infini, et c’est également le cas lorsqu’on prend plusieurs temps <span class="math inline">t_i</span>.</p>
<div id="prp-donsk" class="theorem proposition">
<p><span class="theorem-title"><strong>Proposition 11</strong></span> Pour tous <span class="math inline">t_0=0&lt;t_1 &lt;\dots&lt; t_p</span>, le vecteur <span class="math inline">(B^N_{t_1},\dots,B^N_{t_p})</span> converge en loi vers un vecteur <span class="math inline">(B_{t_1},\dots,B_{t_p})</span> tel que pour tout <span class="math inline">i \in\{1,\dots,p\}</span>, <span class="math inline">B_{t_{i}}-B_{t_{i-1}}</span> est indépendant de <span class="math inline">B_{t_{i-1}}</span> et suit une loi normale <span class="math inline">\mathcal{N}(0, t_i - t_{i-1} )</span></p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Preuve</em>. </span>On a <span class="math display">
B^N_{t_i} - B^N_{t_{i-1}}  =\frac{1}{\sqrt{N}} S_{\lfloor Nt \rfloor} = \frac{1}{\sqrt{N}} \sum_{k=\lfloor N t_{i-1} \rfloor + 1}^{\lfloor N t_i \rfloor} X_k
</span> donc les accroissements du vecteur <span class="math inline">(B^N_{t_1},\dots,B^N_{t_p})</span> sont indépendant. Il suffit maintenant de montrer qu’ils convergent vers la loi normale. On a <span class="math display">
B^N_{t_i} - B^N_{t_{i-1}}  = \sqrt{\frac{\lfloor N t_i \rfloor - \lfloor N t_{i-1} \rfloor }{N}}  \frac{1}{\sqrt{\lfloor N t_i \rfloor - \lfloor N t_{i-1} \rfloor }} \sum_{k=\lfloor N t_{i-1} \rfloor + 1}^{\lfloor N t_i \rfloor}   X_k \to \sqrt{t_i - t_{i-1}} \mathcal{N}(0,1),
</span> par le théorème central limite appliqué à la suite <span class="math inline">(X_k)</span>.</p>
</div>
<p>Ce résultat permet de poser la définition suivante.</p>
<div id="def-mvb" class="theorem definition">
<p><span class="theorem-title"><strong>Définition 3 (Mouvement Brownien)</strong></span> On appelle mouvement Brownien standard, tout processus <span class="math inline">(B_t)_{t\geq 0}</span> satisfaisant les trois points suivants</p>
<ol type="1">
<li><span class="math inline">B_0=0</span>,</li>
<li><span class="math inline">\forall t\geq s</span>, <span class="math inline">B_{t} - B_s</span> indepandant de <span class="math inline">(B_r)_{r \leq s}</span>,</li>
<li><span class="math inline">\forall t\geq s</span>, <span class="math inline">B_{t} - B_s \sim \mathcal{N}(0, t-s)</span>.</li>
</ol>
</div>
<p>Le théorème précédent ne donne pas l’existence d’un tel processus, mais si un tel processus existe, il donne la convergence des lois marginales fini-dimensionnelles de la marche aléatoire renormalisée vers les lois marginales fini-dimensionnelles du mouvement Brownien. On admettra qu’il existe bien un mouvement Brownien. On peut montrer que la marche aléatoire converge pour la norme infinie vers le mouvement Brownien dans l’espace des variables aléatoires à valeurs dans les fonctions continues de <span class="math inline">[0,1]</span> dans <span class="math inline">\mathbb{R}</span>. Ce résultat est connu sous le nom de théorème de Donsker. Pour simuler un mouvement Brownien, on simule en fait une marche aléatoire et on la renormalise comme ci-dessus avec <span class="math inline">N</span> assez grand.</p>


</section>


<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Retour au sommet</a></main> <!-- /main -->
<script type="ojs-module-contents">
eyJjb250ZW50cyI6W3sibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6Ii8vIFBsb3RseSA9IHJlcXVpcmUoXCJodHRwczovL2Nkbi5wbG90Lmx5L3Bsb3RseS1sYXRlc3QubWluLmpzXCIpXG5QbG90bHkgPSByZXF1aXJlKCdwbG90bHkuanMtZGlzdCcpO1xuZGlzdHMgPSByZXF1aXJlKCAnaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL3N0ZGxpYi1qcy9zdGF0cy1iYXNlLWRpc3RzQHVtZC9icm93c2VyLmpzJyApO1xuanN0YXQgPSByZXF1aXJlKCdqc3RhdCcpO1xuc2VlZHJhbmRvbSA9IHJlcXVpcmUoJ3NlZWRyYW5kb21AMy4wLjUnKTtcbm1hdGggPSByZXF1aXJlKFwibWF0aGpzXCIpO1xuLy8gc2VlIHNvdXJjZSBoZXJlOiBodHRwczovL2dpdGh1Yi5jb20vc3RkbGliLWpzL3N0YXRzLWJhc2UtZGlzdHMvdHJlZS91bWRcbi8vIGNvbnRpbnVvdXMgY2FzZVxuXG52aWV3b2YgaW5wdXRzID0gSW5wdXRzLmZvcm0oW1xuICBJbnB1dHMucmFuZ2UoWy0xMCwgMTBdLCB7bGFiZWw6IHRleGB4YCwgc3RlcDogMX0sIHt2YWx1ZTogM30pLFxuICBJbnB1dHMucmFuZ2UoWzEsIDEwMF0sIHtsYWJlbDogdGV4YG5gLCBzdGVwOiAxfSksXG4gIElucHV0cy5idXR0b24oXCJSZS1UaXJhZ2VcIilcbl0pXG5cbm11ID0gaW5wdXRzWzBdO1xubl9zYW1wbGVzID0gaW5wdXRzWzFdO1xuc2VlZCA9IDQ0ICsgaW5wdXRzWzJdO1xuXG57XG5cbmNvbnN0IHJuZyA9IHNlZWRyYW5kb20oc2VlZClcblxuZnVuY3Rpb24gcmFuZG9tX3dhbGsobj0xMDApe1xuICAgIHZhciBzYW1wbGVzID0gQXJyYXkuZnJvbSh7bGVuZ3RoOiBufSwgKCkgPT4ge1xuICAgICAgICAgaWYgKHJuZy5kb3VibGUoKSA+IDAuNSkge1xuICAgICAgICAgICAgcmV0dXJuIDE7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gLTE7XG4gICAgICAgICAgICB9XG4gICAgfSk7XG5cbiAgICByZXR1cm4gc2FtcGxlcztcbn1cbnZhciBzYW1wbGVzID0gcmFuZG9tX3dhbGsoMTAwKTtcblxuXG4vLyBjcmVhdGUgYSBjdW1zdW0gZnVuY3Rpb246XG5mdW5jdGlvbiBjdW1zdW0oYXJyYXkpIHtcbiAgdmFyIHJlc3VsdCA9IFtdO1xuICBhcnJheS5yZWR1Y2UoZnVuY3Rpb24oYSxiLGkpIHsgcmV0dXJuIHJlc3VsdFtpXSA9IGErYjsgfSwwKTtcbiAgcmV0dXJuIHJlc3VsdDtcbn1cblxuXG52YXIgbnBvaW50cz0xMDAsIG1pbmkgPSAwLCBtYXhpPTEwMDtcbnZhciB4ID0gbmV3IEFycmF5KG5wb2ludHMpLCB3YWxrID0gbmV3IEFycmF5KG5wb2ludHMpLCB6ZXJvcyA9IG5ldyBBcnJheShucG9pbnRzKSwgeiA9IG5ldyBBcnJheShucG9pbnRzKSwgaSwgajtcblxuLy8gIERlbnNpdMOpOnNcbmZvcih2YXIgaSA9IDA7IGkgPCBucG9pbnRzOyBpKyspIHtcbiAgICB4W2ldID0gaSA7XG4gICAgemVyb3NbaV0gPSAwO1xuICAgIH1cblxue1xuICAgIC8vIHBvaW50cyBsb3dlclxudmFyIHRyYWNlMSA9IHtcbiAgICAgICAgeDogeC5zbGljZSgxLCBuX3NhbXBsZXMrMSksXG4gICAgICAgIHk6IHplcm9zLnNsaWNlKDEsIG5fc2FtcGxlcysxKSxcbiAgICAgICAgejogc2FtcGxlcy5zbGljZSgwLCBuX3NhbXBsZXMpLFxuICAgICAgICAvLyBtb2RlOiAnbWFya2VycycsXG4gICAgICAgIHR5cGU6ICdoZWF0bWFwJyxcbiAgICBcdFx0eGF4aXM6ICd4MicsXG5cbiAgICAgICAgLy8gbWFya2VyOiB7XG4gICAgICAgIC8vICAgICBjb2xvcjogc2FtcGxlczIuc2xpY2UoMCwgbl9zYW1wbGVzMikubWFwKCh4KSA9PiB4ID4gMCA/ICdibHVlJyA6ICdyZWQnKSxcbiAgICAgICAgLy8gICAgIHNpemU6IDUsXG4gICAgICAgIC8vIH0sXG4gICAgICAgIHNob3dzY2FsZTogZmFsc2UsXG4gICAgICAgIGNvbG9yc2NhbGU6IFtbMCwgXCJyZ2IoNjYsIDEzOSwgMjAyKVwiXSwgWzEsIFwicmdiKDI1NSwwLDApXCJdXSxcblxuICB9XG5cbndhbGsgPSBjdW1zdW0oc2FtcGxlcyk7XG5mb3IodmFyIGkgPSAwOyBpIDwgbnBvaW50czsgaSsrKSB7XG4gICAgd2Fsa1tpXSA9IHdhbGtbaV0gKyBtdSA7XG4gICAgfVxuXG5cbnZhciB0cmFjZTIyID0ge1xuICAgICAgICB4OiB4LnNsaWNlKDAsIG5fc2FtcGxlcyksXG4gICAgICAgIHk6IHdhbGsuc2xpY2UoMCwgbl9zYW1wbGVzKSxcblx0XHR0eXBlOiBcInNjYXR0ZXJcIixcblx0XHRtb2RlOiBcImxpbmVzXCIsXG5cdFx0bmFtZTogJ01hcmNoZSBhbMOpYXRvaXJlJyxcblx0XHRsaW5lOiB7Y29sb3I6ICdibGFjayd9LFxuXHRcdHlheGlzOiAneTInLFxuXHRcdHhheGlzOiAneDInLFxuICAgICAgICB9XG5cblxuXG52YXIgZGF0YSA9IFtcbiAgdHJhY2UxLFxuICB0cmFjZTIyLFxuICBdO1xuXG5cbnZhciBsYXlvdXQgPSB7XG5cdHdpZHRoOiA2MDAsXG4gIHhheGlzOiB7cmFuZ2U6IFswLCBuX3NhbXBsZXMrMV0sXG4gICAgICAgICAgc2hvd3RpY2tsYWJlbHM6IGZhbHNlLFxuICAgICAgICAgIGF1dG9yYW5nZTogZmFsc2V9LFxuXHR5YXhpczoge2RvbWFpbjogWzAsIDAuMDhdLFxuXHRcdFx0c2hvd3RpY2tsYWJlbHM6IGZhbHNlLFxuICAgICAgdGlja3M6XCJcIixcblx0XHRcdHJhbmdlOiBbLTAuNSwgMC41XSxcbiAgICAgICAgICAgIGF1dG9yYW5nZTogZmFsc2V9LFxuXHR4YXhpczI6IHttYXRjaGVzOiAneCcsXG5cdCAgICAgICAgICByYW5nZTogWzAsIG5fc2FtcGxlcysxXSxcbiAgICAgICAgICBhdXRvcmFuZ2U6IHRydWV9LFxuXHR5YXhpczI6IHtkb21haW46IFswLjI5LCAwLjk5XSxcbiAgICAgICAgICAgICAgcmFuZ2U6IFstMjAsIDIwXX0sXG5cbiAgc2hvd2xlZ2VuZDogZmFsc2UsXG5cbn07XG5cbiAgICB2YXIgY29uZmlnID0ge3Jlc3BvbnNpdmU6IHRydWV9XG4gICAgY29uc3QgZGl2ID0gRE9NLmVsZW1lbnQoJ2RpdicpO1xuICAgIFBsb3RseS5yZWFjdChkaXYsIGRhdGEsIGxheW91dCwgY29uZmlnKTtcbiAgICByZXR1cm4gZGl2O1xuXHR9XG59XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTIiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJcblxuLy8gUGxvdGx5ID0gcmVxdWlyZShcImh0dHBzOi8vY2RuLnBsb3QubHkvcGxvdGx5LWxhdGVzdC5taW4uanNcIilcbi8vIHNlZSBzb3VyY2UgaGVyZTogaHR0cHM6Ly9naXRodWIuY29tL3N0ZGxpYi1qcy9zdGF0cy1iYXNlLWRpc3RzL3RyZWUvdW1kXG4vLyBjb250aW51b3VzIGNhc2Vcblxudmlld29mIGlucHV0czIgPSBJbnB1dHMuZm9ybShbXG4gIElucHV0cy5yYW5nZShbMiwgMTAwXSwge2xhYmVsOiB0ZXhgbmAsIHN0ZXA6IDJ9KSxcbiAgSW5wdXRzLmJ1dHRvbihcIlJlLVRpcmFnZVwiKVxuXSlcblxubl9zYW1wbGVzMiA9IGlucHV0czJbMF07XG5zZWVkMiA9IDQ0ICsgaW5wdXRzMlsxXTtcblxue1xudmFyIG5wb2ludHMyPW5fc2FtcGxlczJcbmNvbnN0IHJuZyA9IHNlZWRyYW5kb20oc2VlZDIpXG52YXIgc2FtcGxlczIgPSBuZXcgQXJyYXkobnBvaW50czIpXG4vLyBjcmVhdGUgYSB2ZWN0b3Igb2Ygc2l6ZSAxMDAgd2hvc2UgZmlyc3QgaGFsZiBpcyAxIGFuZCBzZWNvbmQgaGFsZiBpcyAtMVxuZm9yICh2YXIgaSA9IDA7IGkgPCBucG9pbnRzMiA7IGkrKykge1xuICBzYW1wbGVzMltpXSA9IGkgPj0gbnBvaW50czIvMiAgPyAxIDogLTE7XG59XG5cbi8vIGh0dHBzOi8vd3d3LmNvZGVtenkuY29tL2Jsb2cvc2h1ZmZsZS1hcnJheS1qYXZhc2NyaXB0XG5mdW5jdGlvbiBzaHVmZmxlQXJyYXkoYXJyYXkpIHtcbiAgbGV0IGxlbmd0aCA9IGFycmF5Lmxlbmd0aDtcbiAgbGV0IHNodWZmbGUgPSBhcnJheS5zbGljZSgpOyAvLyBjb3B5IG9mIGFycmF5XG4gIC8vIGxvb3Agb3ZlciB0aGUgYXJyYXlcbiAgZm9yIChsZXQgaSA9IGxlbmd0aCAtIDE7IGkgPiAwOyBpIC09IDEpIHtcbiAgICBsZXQgcmFuZG9tID0gTWF0aC5mbG9vcihybmcuZG91YmxlKCkgKiAoaSArIDEpKTsgLy8gcmFuZG9tIGNhcmQgcG9zaXRpb25cbiAgICBsZXQgY3VycmVudCA9IHNodWZmbGVbaV07IC8vIGN1cnJlbnQgY2FyZFxuICAgIC8vIHN3YXAgdGhlIHJhbmRvbSBjYXJkIGFuZCB0aGUgY3VycmVudCBjYXJkXG4gICAgc2h1ZmZsZVtpXSA9IHNodWZmbGVbcmFuZG9tXTsgLy8gbW92ZSB0aGUgcmFuZG9tIGNhcmQgdG8gdGhlIGN1cnJlbnQgcG9zaXRpb25cbiAgICBzaHVmZmxlW3JhbmRvbV0gPSBjdXJyZW50OyAvLyBwdXQgdGhlIGN1cnJlbnQgY2FyZCBpbiB0aGUgcmFuZG9tIHBvc2l0aW9uXG4gIH1cbiAgcmV0dXJuIHNodWZmbGU7IC8vIHJldHVybiBzaHVmZmxlZCBhcnJheVxufTtcblxuXG5zYW1wbGVzMj1zaHVmZmxlQXJyYXkoc2FtcGxlczIpO1xuXG52YXIgeDIgPSBuZXcgQXJyYXkobnBvaW50czIpLCB3YWxrMiA9IG5ldyBBcnJheShucG9pbnRzMiksIHplcm9zMiA9IG5ldyBBcnJheShucG9pbnRzMiksIHogPSBuZXcgQXJyYXkobnBvaW50czIpLCBpLCBqO1xuXG5cbi8vIGNyZWF0ZSBhIGN1bXN1bSBmdW5jdGlvbjpcbmZ1bmN0aW9uIGN1bXN1bShhcnJheSkge1xuICB2YXIgcmVzdWx0ID0gW107XG4gIGFycmF5LnJlZHVjZShmdW5jdGlvbihhLGIsaSkgeyByZXR1cm4gcmVzdWx0W2ldID0gYStiOyB9LDApO1xuICByZXR1cm4gcmVzdWx0O1xufVxuXG52YXIgd2Fsa2ludCA9IGN1bXN1bShzYW1wbGVzMik7XG53YWxrMiA9IG5ldyBBcnJheShucG9pbnRzMisxKSxcbndhbGsyWzBdID0gMFxuZm9yKGkgPSAwOyBpIDwgbnBvaW50czI7IGkrKykge1xuICAgIHdhbGsyW2krMV0gPSB3YWxraW50W2ldO1xuICAgIH1cblxuLy8gIERlbnNpdMOpOlxuZm9yKHZhciBpID0gMDsgaSA8IG5wb2ludHMyKzE7IGkrKykge1xuICAgIHgyW2ldID0gaSA7XG4gICAgemVyb3MyW2ldID0gMDtcbiAgICB9XG5cbntcbiAgICAvLyBwb2ludHMgbG93ZXJcbnZhciB0cmFjZTEgPSB7XG4gICAgICAgIHg6IHgyLnNsaWNlKDEsIG5fc2FtcGxlczIrMSksXG4gICAgICAgIHk6IHplcm9zMi5zbGljZSgxLCBuX3NhbXBsZXMyKzEpLFxuICAgICAgICB6OiBzYW1wbGVzMi5zbGljZSgwLCBuX3NhbXBsZXMyKSxcbiAgICAgICAgLy8gbW9kZTogJ21hcmtlcnMnLFxuICAgICAgICB0eXBlOiAnaGVhdG1hcCcsXG4gICAgXHRcdHhheGlzOiAneDInLFxuXG4gICAgICAgIC8vIG1hcmtlcjoge1xuICAgICAgICAvLyAgICAgY29sb3I6IHNhbXBsZXMyLnNsaWNlKDAsIG5fc2FtcGxlczIpLm1hcCgoeCkgPT4geCA+IDAgPyAnYmx1ZScgOiAncmVkJyksXG4gICAgICAgIC8vICAgICBzaXplOiA1LFxuICAgICAgICAvLyB9LFxuICAgICAgICBzaG93c2NhbGU6IGZhbHNlLFxuICAgICAgICBjb2xvcnNjYWxlOiBbWzAsIFwicmdiKDY2LCAxMzksIDIwMilcIl0sIFsxLCBcInJnYigyNTUsMCwwKVwiXV0sXG5cbiAgfVxuXG5cblxudmFyIHRyYWNlMjIgPSB7XG4gICAgICAgIHg6IHgyLnNsaWNlKDAsIG5fc2FtcGxlczIrMSksXG4gICAgICAgIHk6IHdhbGsyLnNsaWNlKDAsIG5fc2FtcGxlczIrMSksXG5cdFx0dHlwZTogXCJzY2F0dGVyXCIsXG5cdFx0bW9kZTogXCJsaW5lc1wiLFxuXHRcdG5hbWU6ICdNYXJjaGUgYWzDqWF0b2lyZScsXG5cdFx0bGluZToge2NvbG9yOiAnYmxhY2snfSxcblx0XHR5YXhpczogJ3kyJyxcblx0XHR4YXhpczogJ3gyJyxcbiAgICAgICAgfVxuXG5cblxudmFyIGRhdGEgPSBbXG4gIHRyYWNlMSxcbiAgdHJhY2UyMixcbiAgXTtcblxuXG52YXIgbGF5b3V0ID0ge1xuXHR3aWR0aDogNjAwLFxuICB4YXhpczoge3JhbmdlOiBbMCwgbl9zYW1wbGVzMisxXSxcbiAgICAgICAgICBzaG93dGlja2xhYmVsczogZmFsc2UsXG4gICAgICAgICAgYXV0b3JhbmdlOiBmYWxzZX0sXG5cdHlheGlzOiB7ZG9tYWluOiBbMCwgMC4wOF0sXG5cdFx0XHRzaG93dGlja2xhYmVsczogZmFsc2UsXG4gICAgICB0aWNrczpcIlwiLFxuXHRcdFx0cmFuZ2U6IFstMC41LCAwLjVdLFxuICAgICAgICAgICAgYXV0b3JhbmdlOiBmYWxzZX0sXG5cdHhheGlzMjoge21hdGNoZXM6ICd4Jyxcblx0ICAgICAgICAgIHJhbmdlOiBbMCwgbl9zYW1wbGVzMisxXSxcbiAgICAgICAgICBhdXRvcmFuZ2U6IHRydWV9LFxuXHR5YXhpczI6IHtkb21haW46IFswLjI5LCAwLjk5XSxcbiAgICAgICAgICAgICAgcmFuZ2U6IFstMTQsIDE0XX0sXG5cbiAgc2hvd2xlZ2VuZDogZmFsc2UsXG5cbn07XG5cbiAgICB2YXIgY29uZmlnID0ge3Jlc3BvbnNpdmU6IHRydWV9XG4gICAgY29uc3QgZGl2ID0gRE9NLmVsZW1lbnQoJ2RpdicpO1xuICAgIFBsb3RseS5yZWFjdChkaXYsIGRhdGEsIGxheW91dCwgY29uZmlnKTtcbiAgICByZXR1cm4gZGl2O1xuXHR9XG59XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6InNoaW55SW5wdXQoJ2lucHV0cycpIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdpbnB1dHMyJykifV19
</script>
<script type="module">
if (window.location.protocol === "file:") { alert("The OJS runtime does not work with file:// URLs. Please use a web server to view this document."); }
window._ojs.paths.runtimeToDoc = "../../Courses";
window._ojs.paths.runtimeToRoot = "../..";
window._ojs.paths.docToRoot = "..";
window._ojs.selfContained = false;
window._ojs.runtime.interpretFromScriptTags();
</script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copié");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copié");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../Courses/monte_carlo.html" class="pagination-link  aria-label=" méthode="" de="" monte="" carlo"="">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Méthode de Monte Carlo</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/josephsalmon/HAX603X/blob/main/Courses/marche_aleatoire.qmd" class="toc-action"><i class="bi bi-github"></i>Voir la source</a></li><li><a href="https://github.com/josephsalmon/HAX603X/issues/new" class="toc-action"><i class="bi empty"></i>Faire part d'un problème</a></li></ul></div></div></div></footer></body></html>