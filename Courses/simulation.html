<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="fr" xml:lang="fr"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Joseph Salmon, Benjamin Charlier, Nicolas Meyer, Benoîte de Saporta">

<title>HAX603X: Modélisation stochastique - 3&nbsp; Simulation</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../Courses/th_asymptotique.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "Pas de résultats",
    "search-matching-documents-text": "documents trouvés",
    "search-copy-link-title": "Copier le lien vers la recherche",
    "search-hide-matches-text": "Cacher les correspondances additionnelles",
    "search-more-match-text": "correspondance de plus dans ce document",
    "search-more-matches-text": "correspondances de plus dans ce document",
    "search-clear-button-title": "Effacer",
    "search-detached-cancel-button-title": "Annuler",
    "search-submit-button-title": "Envoyer",
    "search-label": "Recherche"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<script type="text/javascript">
window.PlotlyConfig = {MathJaxConfig: 'local'};
if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}
if (typeof require !== 'undefined') {
require.undef("plotly");
requirejs.config({
    paths: {
        'plotly': ['https://cdn.plot.ly/plotly-2.20.0.min']
    }
});
require(['plotly'], function(Plotly) {
    window._Plotly = Plotly;
});
}
</script>


  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css">

<link rel="stylesheet" href="../custom.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Basculer la barre latérale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../Courses/notations.html">Cours</a></li><li class="breadcrumb-item"><a href="../Courses/simulation.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Simulation</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Basculer la barre latérale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">HAX603X: Modélisation stochastique</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/josephsalmon/HAX603X" rel="" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Recherche"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Cours</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Basculer la section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Courses/notations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Notations et rappels</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Courses/th_asymptotique.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Théorèmes asymptotiques</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Courses/simulation.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Simulation</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">TP</span></span>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">TD</span></span>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table des matières</h2>
   
  <ul>
  <li><a href="#variables-aléatoires-uniformes" id="toc-variables-aléatoires-uniformes" class="nav-link active" data-scroll-target="#variables-aléatoires-uniformes"><span class="header-section-number">3.1</span> Variables aléatoires uniformes</a>
  <ul class="collapse">
  <li><a href="#générateur-congruentiel-linéaire" id="toc-générateur-congruentiel-linéaire" class="nav-link" data-scroll-target="#générateur-congruentiel-linéaire"><span class="header-section-number">3.1.1</span> Générateur congruentiel linéaire</a></li>
  <li><a href="#générateurs-alternatifs" id="toc-générateurs-alternatifs" class="nav-link" data-scroll-target="#générateurs-alternatifs"><span class="header-section-number">3.1.2</span> Générateurs alternatifs</a></li>
  <li><a href="#usage-en-numpy" id="toc-usage-en-numpy" class="nav-link" data-scroll-target="#usage-en-numpy"><span class="header-section-number">3.1.3</span> Usage en <code>numpy</code></a></li>
  <li><a href="#propriété-de-la-loi-uniforme" id="toc-propriété-de-la-loi-uniforme" class="nav-link" data-scroll-target="#propriété-de-la-loi-uniforme"><span class="header-section-number">3.1.4</span> Propriété de la loi uniforme</a></li>
  </ul></li>
  <li><a href="#méthode-dinversion" id="toc-méthode-dinversion" class="nav-link" data-scroll-target="#méthode-dinversion"><span class="header-section-number">3.2</span> Méthode d’inversion</a>
  <ul class="collapse">
  <li><a href="#bibliographie-et-pour-aller-plus-loin" id="toc-bibliographie-et-pour-aller-plus-loin" class="nav-link" data-scroll-target="#bibliographie-et-pour-aller-plus-loin"><span class="header-section-number">3.2.1</span> Bibliographie et pour aller plus loin</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/josephsalmon/HAX603X/blob/main/Courses/simulation.qmd" class="toc-action">Voir la source</a></p><p><a href="https://github.com/josephsalmon/HAX603X/issues/new" class="toc-action">Faire part d'un problème</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Simulation</span></h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Auteur·rice</div>
    <div class="quarto-title-meta-contents">
             <p>Joseph Salmon, Benjamin Charlier, Nicolas Meyer, Benoîte de Saporta </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<p>Dans ce chapitre on se demande comment simuler en pratique des variables aléatoires i.i.d. L’idée est de commencer par le cas de variables aléatoires de loi uniforme et d’en déduire les autres lois.</p>
<section id="variables-aléatoires-uniformes" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="variables-aléatoires-uniformes"><span class="header-section-number">3.1</span> Variables aléatoires uniformes</h2>
<p>On rappelle qu’une variable aléatoire <span class="math inline">U</span> suit une loi uniforme sur <span class="math inline">[0,1]</span>, noté <span class="math inline">\mathcal{U}([0,1])</span> si sa fonction de répartition <span class="math inline">F_U</span> est donnée par <span class="math display">
F_U(x)
=
\begin{cases}
    0, &amp; \text{si }x &lt; 0\,,        \\
    x, &amp; \text{si }x \in [0,1]\,,  \\
    1, &amp; \text{si }x &gt; 1\,.        \\
\end{cases}
</span></p>
<div class="cell" data-execution_count="1">
<div class="cell-output cell-output-display">

<div>                            <div id="c79448c2-2748-48cf-b2f4-ad9340d658e6" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("c79448c2-2748-48cf-b2f4-ad9340d658e6")) {                    Plotly.newPlot(                        "c79448c2-2748-48cf-b2f4-ad9340d658e6",                        [{"line":{"color":"rgb(66, 139, 202)","width":3},"mode":"lines","name":"$F_U$","x":[-3.0,-2.9765886287625416,-2.9531772575250836,-2.9297658862876252,-2.9063545150501673,-2.882943143812709,-2.859531772575251,-2.8361204013377925,-2.8127090301003346,-2.789297658862876,-2.765886287625418,-2.74247491638796,-2.719063545150502,-2.6956521739130435,-2.672240802675585,-2.648829431438127,-2.625418060200669,-2.6020066889632107,-2.5785953177257523,-2.5551839464882944,-2.531772575250836,-2.508361204013378,-2.4849498327759196,-2.4615384615384617,-2.4381270903010033,-2.4147157190635453,-2.391304347826087,-2.367892976588629,-2.3444816053511706,-2.321070234113712,-2.297658862876254,-2.2742474916387962,-2.250836120401338,-2.2274247491638794,-2.2040133779264215,-2.1806020066889635,-2.157190635451505,-2.1337792642140467,-2.1103678929765888,-2.0869565217391304,-2.0635451505016724,-2.040133779264214,-2.016722408026756,-1.9933110367892977,-1.9698996655518395,-1.9464882943143813,-1.9230769230769231,-1.899665551839465,-1.8762541806020068,-1.8528428093645486,-1.8294314381270904,-1.8060200668896322,-1.782608695652174,-1.7591973244147159,-1.7357859531772577,-1.7123745819397995,-1.6889632107023411,-1.665551839464883,-1.6421404682274248,-1.6187290969899666,-1.5953177257525084,-1.5719063545150502,-1.548494983277592,-1.5250836120401339,-1.5016722408026757,-1.4782608695652175,-1.4548494983277593,-1.4314381270903012,-1.408026755852843,-1.3846153846153848,-1.3612040133779266,-1.3377926421404684,-1.3143812709030103,-1.2909698996655519,-1.2675585284280937,-1.2441471571906355,-1.2207357859531773,-1.1973244147157192,-1.173913043478261,-1.1505016722408028,-1.1270903010033446,-1.1036789297658864,-1.0802675585284283,-1.05685618729097,-1.033444816053512,-1.0100334448160537,-0.9866220735785953,-0.9632107023411374,-0.939799331103679,-0.916387959866221,-0.8929765886287626,-0.8695652173913047,-0.8461538461538463,-0.8227424749163883,-0.7993311036789299,-0.7759197324414719,-0.7525083612040135,-0.7290969899665551,-0.7056856187290972,-0.6822742474916388,-0.6588628762541808,-0.6354515050167224,-0.6120401337792645,-0.5886287625418061,-0.5652173913043481,-0.5418060200668897,-0.5183946488294318,-0.49498327759197336,-0.4715719063545154,-0.448160535117057,-0.42474916387959905,-0.40133779264214064,-0.37792642140468224,-0.3545150501672243,-0.3311036789297659,-0.30769230769230793,-0.28428093645484953,-0.2608695652173916,-0.23745819397993317,-0.21404682274247522,-0.19063545150501682,-0.16722408026755886,-0.14381270903010046,-0.1204013377926425,-0.0969899665551841,-0.07357859531772615,-0.05016722408026775,-0.02675585284280979,-0.0033444816053513904,0.02006688963210701,0.043478260869564966,0.06688963210702337,0.09030100334448132,0.11371237458193972,0.13712374581939768,0.16053511705685608,0.18394648829431404,0.20735785953177244,0.2307692307692304,0.2541806020066888,0.27759197324414675,0.30100334448160515,0.3244147157190631,0.3478260869565215,0.37123745819397946,0.39464882943143786,0.41806020066889626,0.4414715719063542,0.4648829431438126,0.4882943143812706,0.511705685618729,0.5351170568561869,0.5585284280936453,0.5819397993311033,0.6053511705685617,0.6287625418060196,0.652173913043478,0.675585284280936,0.6989966555183944,0.7224080267558524,0.7458193979933108,0.7692307692307692,0.7926421404682271,0.8160535117056855,0.8394648829431435,0.8628762541806019,0.8862876254180598,0.9096989966555182,0.9331103678929762,0.9565217391304346,0.9799331103678925,1.0033444816053505,1.0267558528428093,1.0501672240802673,1.0735785953177253,1.0969899665551832,1.120401337792642,1.1438127090301,1.167224080267558,1.1906354515050168,1.2140468227424748,1.2374581939799327,1.2608695652173907,1.2842809364548495,1.3076923076923075,1.3311036789297654,1.3545150501672234,1.3779264214046822,1.4013377926421402,1.4247491638795982,1.4481605351170561,1.471571906354515,1.494983277591973,1.5183946488294309,1.5418060200668897,1.5652173913043477,1.5886287625418056,1.6120401337792636,1.6354515050167224,1.6588628762541804,1.6822742474916383,1.7056856187290963,1.7290969899665551,1.752508361204013,1.775919732441471,1.799331103678929,1.8227424749163879,1.8461538461538458,1.8695652173913038,1.8929765886287626,1.9163879598662206,1.9397993311036785,1.9632107023411365,1.9866220735785953,2.0100334448160533,2.0334448160535112,2.056856187290969,2.080267558528428,2.103678929765886,2.127090301003344,2.150501672240802,2.1739130434782608,2.1973244147157187,2.2207357859531767,2.2441471571906355,2.2675585284280935,2.2909698996655514,2.3143812709030094,2.3377926421404682,2.361204013377926,2.384615384615384,2.408026755852842,2.431438127090301,2.454849498327759,2.478260869565217,2.501672240802675,2.5250836120401337,2.5484949832775916,2.5719063545150496,2.5953177257525075,2.6187290969899664,2.6421404682274243,2.6655518394648823,2.688963210702341,2.712374581939799,2.735785953177257,2.759197324414715,2.782608695652174,2.806020066889632,2.8294314381270897,2.8528428093645477,2.8762541806020065,2.8996655518394645,2.9230769230769225,2.9464882943143804,2.9698996655518393,2.993311036789297,3.016722408026755,3.040133779264214,3.063545150501672,3.08695652173913,3.110367892976588,3.1337792642140467,3.1571906354515047,3.1806020066889626,3.2040133779264206,3.2274247491638794,3.2508361204013374,3.2742474916387954,3.2976588628762533,3.321070234113712,3.34448160535117,3.367892976588628,3.391304347826087,3.414715719063545,3.438127090301003,3.461538461538461,3.4849498327759196,3.5083612040133776,3.5317725752508355,3.5551839464882935,3.5785953177257523,3.6020066889632103,3.6254180602006683,3.648829431438126,3.672240802675585,3.695652173913043,3.719063545150501,3.742474916387959,3.7658862876254178,3.7892976588628757,3.8127090301003337,3.8361204013377925,3.8595317725752505,3.8829431438127084,3.9063545150501664,3.9297658862876252,3.953177257525083,3.976588628762541,4.0],"y":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.02006688963210701,0.043478260869564966,0.06688963210702337,0.09030100334448132,0.11371237458193972,0.13712374581939768,0.16053511705685608,0.18394648829431404,0.20735785953177244,0.2307692307692304,0.2541806020066888,0.27759197324414675,0.30100334448160515,0.3244147157190631,0.3478260869565215,0.37123745819397946,0.39464882943143786,0.41806020066889626,0.4414715719063542,0.4648829431438126,0.4882943143812706,0.511705685618729,0.5351170568561869,0.5585284280936453,0.5819397993311033,0.6053511705685617,0.6287625418060196,0.652173913043478,0.675585284280936,0.6989966555183944,0.7224080267558524,0.7458193979933108,0.7692307692307692,0.7926421404682271,0.8160535117056855,0.8394648829431435,0.8628762541806019,0.8862876254180598,0.9096989966555182,0.9331103678929762,0.9565217391304346,0.9799331103678925,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"rgb(36,36,36)"},"error_y":{"color":"rgb(36,36,36)"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"rgb(36,36,36)","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"rgb(36,36,36)"},"baxis":{"endlinecolor":"rgb(36,36,36)","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"rgb(36,36,36)"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"histogram2d"}],"histogram":[{"marker":{"line":{"color":"white","width":0.6}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"rgb(237,237,237)"},"line":{"color":"white"}},"header":{"fill":{"color":"rgb(217,217,217)"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"colorscale":{"diverging":[[0.0,"rgb(103,0,31)"],[0.1,"rgb(178,24,43)"],[0.2,"rgb(214,96,77)"],[0.3,"rgb(244,165,130)"],[0.4,"rgb(253,219,199)"],[0.5,"rgb(247,247,247)"],[0.6,"rgb(209,229,240)"],[0.7,"rgb(146,197,222)"],[0.8,"rgb(67,147,195)"],[0.9,"rgb(33,102,172)"],[1.0,"rgb(5,48,97)"]],"sequential":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"sequentialminus":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]]},"colorway":["#1F77B4","#FF7F0E","#2CA02C","#D62728","#9467BD","#8C564B","#E377C2","#7F7F7F","#BCBD22","#17BECF"],"font":{"color":"rgb(36,36,36)"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"white"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"},"bgcolor":"white","radialaxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"rgb(232,232,232)","gridwidth":2,"linecolor":"rgb(36,36,36)","showbackground":true,"showgrid":false,"showline":true,"ticks":"outside","zeroline":false,"zerolinecolor":"rgb(36,36,36)"},"yaxis":{"backgroundcolor":"white","gridcolor":"rgb(232,232,232)","gridwidth":2,"linecolor":"rgb(36,36,36)","showbackground":true,"showgrid":false,"showline":true,"ticks":"outside","zeroline":false,"zerolinecolor":"rgb(36,36,36)"},"zaxis":{"backgroundcolor":"white","gridcolor":"rgb(232,232,232)","gridwidth":2,"linecolor":"rgb(36,36,36)","showbackground":true,"showgrid":false,"showline":true,"ticks":"outside","zeroline":false,"zerolinecolor":"rgb(36,36,36)"}},"shapedefaults":{"fillcolor":"black","line":{"width":0},"opacity":0.3},"ternary":{"aaxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"},"baxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"},"bgcolor":"white","caxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside","title":{"standoff":15},"zeroline":false,"zerolinecolor":"rgb(36,36,36)"},"yaxis":{"automargin":true,"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside","title":{"standoff":15},"zeroline":false,"zerolinecolor":"rgb(36,36,36)"}}},"showlegend":true},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('c79448c2-2748-48cf-b2f4-ad9340d658e6');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
<p>L’objectif est de simuler sur machine une suite <span class="math inline">U_1, \ldots, U_n</span> de variables aléatoires i.i.d. de loi <span class="math inline">\mathcal{U}([0,1])</span>. Plusieurs problèmes apparaissent alors :</p>
<ul>
<li>Une machine est déterministe.</li>
<li>Les nombres entre <span class="math inline">0</span> et <span class="math inline">1</span> donnés par la machine sont de la forme <span class="math inline">k/2^p</span>, pour <span class="math inline">k \in \{0, \ldots, 2^{p-1}\}</span>. On ne pourra donc jamais générer des nombres qui ne sont pas de cette forme.</li>
<li>Vérifier qu’une suite est bien i.i.d. est un problème difficile.</li>
</ul>
<div id="def-PRNG" class="theorem definition">
<p><span class="theorem-title"><strong>Définition 3.1 (Générateur de nombres pseudo-aléatoires) </strong></span><br></p>
<p>Un <strong>générateur de nombres pseudo-aléatoires</strong> (🇬🇧: <em>Pseudo Random Number Generator</em>, PRNG), est un algorithme déterministe récursif qui renvoie une suite <span class="math inline">U_1, \ldots, U_n</span> dans <span class="math inline">[0,1]</span> qui a un “comportement similaire” à une suite i.i.d. de loi <span class="math inline">\mathcal{U}([0,1])</span>. Pour être plus rigoureux, ces nombres sont en fait des nombres entiers générés uniformément sur un certain interval. Dans un second une transformation simple permet d’obtenir des nombres flottants (🇬🇧: <em>floats</em>) entre 0 et 1.</p>
</div>
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Pour aller plus loin
</div>
</div>
<div class="callout-body-container callout-body">
<p>Parfois il est utile d’aller chercher dans le code source certaines information pour savoir comment les fonctions sont codées dans les packages que l’on utiliser. Par exemple, pour <code>numpy</code> que l’on utilise fréquement, on peut voir l’opération choisie ici: <a href="https://github.com/numpy/numpy/blob/d50fc570a9e15ea4d8ec35add245d5d791fa4596/numpy/random/src/mt19937/randomkit.c#L479">Random: int -&gt; float en <code>numpy</code></a>.</p>
</div>
</div>
<p>Un tel algorithme se construit de la manière suivante :</p>
<ol type="1">
<li>On part d’une graine (🇬🇧: <em>seed</em>) <span class="math inline">U_0</span> qui détermine la première valeur de manière la plus arbitraire possible.</li>
<li>La procédure récursive s’écrit <span class="math inline">U_{n+1} = f(U_n)</span>, où <span class="math inline">f</span> est une transformation déterministe, de sorte que <span class="math inline">U_{n+1}</span> est le plus indépendant possible de <span class="math inline">U_1, \dots·, U_n</span>.</li>
</ol>
<ul>
<li><p>La fonction <span class="math inline">f</span> est déterministe et prend ses valeurs dans un ensemble fini, donc l’algorithme est périodique. Le but est donc d’avoir la plus grande période possible.</p></li>
<li><p>Notons qu’une fois que la graine est fixée, alors l’algorithme donne toujours les mêmes valeurs. Fixer la graine peut donc être très utile pour répéter des simulations dans des conditions identiques et ainsi repérer des erreurs.</p></li>
</ul>
<div class="callout callout-style-default callout-important no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercice: bug ou feature?
</div>
</div>
<div class="callout-body-container callout-body">
<p>Reprendre les widgets du chapitre <a href="../Courses/th_asymptotique.html">Théorèmes asymptotiques</a> et faites varier doucement le paramètre <span class="math inline">p</span> (de Bernoulli). Que constatez-vous? Proposer une explication potentielle.</p>
</div>
</div>
<section id="générateur-congruentiel-linéaire" class="level3" data-number="3.1.1">
<h3 data-number="3.1.1" class="anchored" data-anchor-id="générateur-congruentiel-linéaire"><span class="header-section-number">3.1.1</span> Générateur congruentiel linéaire</h3>
<p>La plupart des PRNG s’appuient sur des résultats arithmétiques. Un des plus connus est celui appelé Générateur congruentiel linéaire (🇬🇧 Linear congruential generator, LCG). Il est défini comme suit: on construit récursivement une suite d’entiers <span class="math inline">X_i</span> via la congruence <span class="math display">
  X_{n+1} = a X_n + b \quad \text{mod } m \enspace,
</span> où <span class="math inline">a,b,m</span> sont des entiers bien choisis pour que la suite obtenue ait de bonnes propriétés. Il suffit alors de considérer <span class="math inline">X_n/m</span>. Par exemple, la fonction <code>rand</code> sur <code>scilab</code> utilise cette congruence avec <span class="math inline">m=2^{31}</span>, <span class="math inline">a=843\; 314\; 861</span>, et <span class="math inline">b=453\; 816\; 693</span>.</p>
</section>
<section id="générateurs-alternatifs" class="level3" data-number="3.1.2">
<h3 data-number="3.1.2" class="anchored" data-anchor-id="générateurs-alternatifs"><span class="header-section-number">3.1.2</span> Générateurs alternatifs</h3>
<p>Les langages <code>Python</code> et <code>R</code> utilisent par défaut le générateur Mersenne-Twister qui s’appuie sur la multiplication vectorielle, mais d’autres générateurs sont aussi disponibles. Ce générateur a pour période <span class="math inline">m =2^{19937}-1</span>, nombre qu’on peut raisonnablement considérer comme grand.</p>
<p>Pour <code>numpy</code> la méthode par défaut est PCG64 (cf.&nbsp;<a href="https://numpy.org/doc/stable/reference/random/bit_generators/pcg64.html">documentation de <code>numpy</code></a>), qui dispose de meilleures garanties statistiques (Voir le site <a href="https://www.pcg-random.org/statistical-tests.html#id4">https://www.pcg-random.org</a> pour cela).</p>
</section>
<section id="usage-en-numpy" class="level3" data-number="3.1.3">
<h3 data-number="3.1.3" class="anchored" data-anchor-id="usage-en-numpy"><span class="header-section-number">3.1.3</span> Usage en <code>numpy</code></h3>
<p>On suppose désormais disposer d’un générateur pseudo-aléatoire sur <span class="math inline">[0,1]</span>. En <code>numpy</code> depuis la version 1.17, une bonne manière d’utiliser des éléments aléatoires est d’utiliser un générateur que l’on définit soi-même:</p>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>seed <span class="op">=</span> <span class="dv">12345</span>  <span class="co"># Toujours être conscient qu'une graine existe</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>rng <span class="op">=</span> np.random.default_rng(seed)  <span class="co">#</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(rng.random())  <span class="co">##  un tirage uniforme sur [0,1]</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(rng.random(size<span class="op">=</span><span class="dv">5</span>))  <span class="co">## cinq tirages uniformes sur [0,1]</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(rng.random(size<span class="op">=</span>(<span class="dv">3</span>, <span class="dv">2</span>)))  <span class="co">## matrice 3x2, à entrées unif. sur [0,1]</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.22733602246716966
[0.31675834 0.79736546 0.67625467 0.39110955 0.33281393]
[[0.59830875 0.18673419]
 [0.67275604 0.94180287]
 [0.24824571 0.94888115]]</code></pre>
</div>
</div>
<p>Dans la suite on va voir comment générer d’autres lois à partir de la loi uniforme, mais il est clair que les logiciels modernes propose un large éventail de distribution classique (gaussienne, exponentielle, etc.). Une liste exhaustive est donnée <a href="https://numpy.org/doc/stable/reference/random/generator.html#distributions">ici</a> pour <code>numpy</code>.</p>
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Pour aller plus loin
</div>
</div>
<div class="callout-body-container callout-body">
<p>Une excellent discussion sur les bonnes pratiques aléatoires en <code>numpy</code>, et l’usage de <code>np.random.default_rng</code> est donnée dans ce <a href="https://albertcthomas.github.io/good-practices-random-number-generators/">blog post d’Albert Thomas</a>.</p>
</div>
</div>
</section>
<section id="propriété-de-la-loi-uniforme" class="level3" data-number="3.1.4">
<h3 data-number="3.1.4" class="anchored" data-anchor-id="propriété-de-la-loi-uniforme"><span class="header-section-number">3.1.4</span> Propriété de la loi uniforme</h3>
<p>On verra souvent apparaître la variable aléatoire <span class="math inline">1-U</span> où <span class="math inline">U \sim \mathcal{U}([0,1])</span>. Il se trouve que <span class="math inline">1-U</span> suit aussi une loi uniforme sur <span class="math inline">[0,1]</span> comme le montre le calcul de sa fonction de répartition. Ainsi pour tout <span class="math inline">x \in [0,1]</span> on obtien <span class="math display">
\begin{align*}
\mathbb{P}(1-U \leq x) &amp; = \mathbb{P}(U \geq 1-x),\\
                       &amp; = 1-(1-x), \\
                       &amp; = x\,.
\end{align*}
</span> On peut démontrer facilement la même relation pour <span class="math inline">x&lt;0</span> et <span class="math inline">x&gt;1</span>, d’où le résultat.</p>
</section>
</section>
<section id="méthode-dinversion" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="méthode-dinversion"><span class="header-section-number">3.2</span> Méthode d’inversion</h2>
<p>L’idée de la méthode d’inversion repose sur le résultat suivant : si <span class="math inline">F</span> est une fonction de répartition bijective et <span class="math inline">U \sim\mathcal{U}([0,1])</span>, alors la variable aléatoire <span class="math inline">F^{-1}(U)</span> a pour fonction de répartition <span class="math inline">F</span>. C’est une conséquence de la suite d’égalités : <span id="eq-methode_inversion"><span class="math display">
\begin{align}
  \mathbb{P}( F^{-1}(U) \leq x ) &amp; = \mathbb{P}( U \leq F(x) ) \\
                                 &amp; = F(x)\,,
\end{align}
\tag{3.1}</span></span></p>
<p>où la deuxième égalité résulte de la bijectivité de <span class="math inline">F</span>. Ainsi, si <span class="math inline">F</span> est facilement inversible, on peut simuler une variable aléatoire <span class="math inline">X</span> de loi <span class="math inline">F</span> en simulant une variable aléatoire uniforme <span class="math inline">U</span> et en posant <span class="math inline">X = F^{-1}(U)</span>.</p>
<p>Malheureusement, la fonction <span class="math inline">F</span> n’est pas toujours inversible (penser aux lois discrètes) c’est donc pourquoi on utilise l’inverse l’inverse généralisée ou fonction quantile introduite en <a href="notations.html#def-quantile">Définition&nbsp;<span>1.4</span></a>:</p>
<p><span class="math display">
  F^\leftarrow(p)=  \inf\{ x \in \mathbb{R} \colon F(x)\geq p\} \enspace.
</span></p>
<p><strong>Interprétation:</strong> Définir l’inverse d’une fonction de répartition <span class="math inline">F</span> revient à résoudre l’équation <span class="math inline">F(x) = u</span> d’inconnue <span class="math inline">x</span> pour un <span class="math inline">u</span> fixé. Si <span class="math inline">F</span> n’est pas bijective, deux problèmes apparaissent :</p>
<ul>
<li>l’équation n’a aucune solution ce qui revient à dire que <span class="math inline">F</span> n’est pas surjectif (graphiquement, <span class="math inline">F</span> présente des sauts) ;</li>
<li>l’équation a plusieurs solutions ce qui revient à dire que <span class="math inline">F</span> n’est pas injective (graphiquement cela se matérialise par un plateau à la hauteur <span class="math inline">u</span>). Un exemple classique est celui où <span class="math inline">F</span> est la fonction de répartition d’une variable aléatoire discrète.</li>
</ul>
<p>Le passage à l’inéquation <span class="math inline">F(x) \geq u</span> permet de contourner la non-surjectivité : on ne regarde non plus les droites horizontales <span class="math inline">y=u</span> mais la région <span class="math inline">\{y \geq u\}</span>. Le choix de l’<span class="math inline">\inf</span> dans la définition de <span class="math inline">F^{\leftarrow}</span> permet de contourner la non-injectivité : vu qu’il y a possiblement plusieurs <span class="math inline">x</span> tels que <span class="math inline">F(x) \geq u</span>, on choisit le “premier”. Ces considérations sont illustrées en Figure XXX TODO.</p>
<p><strong>Remarques additionnelles</strong>:</p>
<ul>
<li>La fonction <span class="math inline">F</span> étant croissante, la quantité <span class="math inline">F^\leftarrow(u)</span> correspond au premier instant où <span class="math inline">F</span> dépasse <span class="math inline">u</span>. Si <span class="math inline">F</span> est bijective (ce qui équivaut dans ce cas à strictement croissante et injective), alors <span class="math inline">F^\leftarrow = F^{-1}</span>.</li>
<li>La fonction <span class="math inline">F^\leftarrow</span> n’est rien d’autre que la fonction quantile : si <span class="math inline">0 &lt; \alpha &lt; 1</span>, <span class="math inline">q_{1-\alpha} = F^\leftarrow(1-\alpha)</span> est le quantile d’ordre <span class="math inline">(1-\alpha)</span> de <span class="math inline">F</span>. Par exemple, <span class="math inline">F^\leftarrow(1/2)</span> correspond à la médiane.</li>
<li>Notons que si <span class="math inline">u=0</span>, on peut alors naturellement poser <span class="math inline">F^{\leftarrow}(0) = -\infty</span>. De même, avec la convention la convention <span class="math inline">\inf \emptyset = +\infty</span>, on peut alors étendre la définition de <span class="math inline">F^\leftarrow</span> à <span class="math inline">u=1</span> (mais <span class="math inline">F^\leftarrow(1)</span> n’est pas toujours égal à <span class="math inline">\infty</span>, voir les exemples ci-dessous).</li>
</ul>
<div id="def-inversion_discrete" class="theorem definition">
<p><span class="theorem-title"><strong>Définition 3.2 (Loi à support fini) </strong></span><br></p>
<p>Soit <span class="math inline">X</span> une variable aléatoire discrète prenant uniquement les valeurs <span class="math inline">x_1 &lt; \dots &lt; x_r</span> avec probabilité <span class="math inline">p_1, \dots, p_r</span>, et tel que <span class="math inline">p_1 + \dots + p_r=1</span>. On vérifie que pour tout <span class="math inline">u \in ]0,1[</span>, <span class="math display">
        F^\leftarrow(u) =
        \begin{cases}
            x_1 &amp; \text{si } 0 &lt; u \leq p_1\,,                  \\
            x_2 &amp; \text{si } p_1 &lt; u \leq p_1+p_2\,,            \\
                &amp; \vdots                                        \\
            x_r &amp; \text{si }  p_1 + \dots + p_{r-1} &lt; u &lt; 1\,.
        \end{cases}
</span></p>
<p>Sur cet exemple, on peut prolonger la définition de <span class="math inline">F^\leftarrow</span> à <span class="math inline">u=1</span> en posant <span class="math inline">F^\leftarrow(1) = x_r</span>. L’inverse généralisée se réécrit alors sous la forme <span class="math display">
        F^\leftarrow(u) = \sum_{k=1}^r x_k {1\hspace{-3.8pt} 1}_{p_1 + \dots + p_{k-1} &lt; u \leq p_1 + \dots + p_k}\enspace,
</span> où on a posé <span class="math inline">p_0=0</span>. Cette expression s’étend directement au cas où <span class="math inline">X</span> prend un nombre infini dénombrable de valeurs (la somme devient alors une série).</p>
</div>
<p>XXX TODO: donner un example discret et montrer <span class="math inline">F^\leftarrow</span></p>
<p>XXX TODO: show inverse usage using widget from first course and sampling randomly uniformly points in <span class="math inline">[0,1]</span> to get the one from the distributions at hand.</p>
<section id="bibliographie-et-pour-aller-plus-loin" class="level3" data-number="3.2.1">
<h3 data-number="3.2.1" class="anchored" data-anchor-id="bibliographie-et-pour-aller-plus-loin"><span class="header-section-number">3.2.1</span> Bibliographie et pour aller plus loin</h3>
<ul>
<li><a href="https://hal.science/hal-02427338/document">Generating Random Floating-Point Numbers by Dividing Integers: a Case Study</a> par Frédéric Goualard</li>
<li><a href="https://allendowney.com/research/rand/downey07randfloat.pdf">Generating Pseudo-random Floating-Point Values</a> par Allen Downey.</li>
</ul>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copié");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copié");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../Courses/th_asymptotique.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Théorèmes asymptotiques</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->



</body></html>